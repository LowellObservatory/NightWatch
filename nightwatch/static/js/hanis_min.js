var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(h){var I=0;return function(){return I<h.length?{done:!1,value:h[I++]}:{done:!0}}};$jscomp.arrayIterator=function(h){return{next:$jscomp.arrayIteratorImpl(h)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,I,J){h!=Array.prototype&&h!=Object.prototype&&(h[I]=J.value)};$jscomp.getGlobal=function(h){h=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,h];for(var I=0;I<h.length;++I){var J=h[I];if(J&&J.Math==Math)return J}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(h,I){this.$jscomp$symbol$id_=h;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:I})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function h(J){if(this instanceof h)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(J||"")+"_"+I++,J)}var I=0;return h}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.asyncIterator;h||(h=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};
$jscomp.iteratorFromArray=function(h,I){$jscomp.initSymbolIterator();h instanceof String&&(h+="");var J=0,Q={next:function(){if(J<h.length){var Ab=J++;return{value:I(Ab,h[Ab]),done:!1}}Q.next=function(){return{done:!0,value:void 0}};return Q.next()}};Q[Symbol.iterator]=function(){return Q};return Q};
$jscomp.polyfill=function(h,I,J,Q){if(I){J=$jscomp.global;h=h.split(".");for(Q=0;Q<h.length-1;Q++){var Ab=h[Q];Ab in J||(J[Ab]={});J=J[Ab]}h=h[h.length-1];Q=J[h];I=I(Q);I!=Q&&null!=I&&$jscomp.defineProperty(J,h,{configurable:!0,writable:!0,value:I})}};$jscomp.polyfill("Array.prototype.fill",function(h){return h?h:function(h,J,Q){var I=this.length||0;0>J&&(J=Math.max(0,I+J));if(null==Q||Q>I)Q=I;Q=Number(Q);0>Q&&(Q=Math.max(0,I+Q));for(J=Number(J||0);J<Q;J++)this[J]=h;return this}},"es6","es3");
function PEvs(h,I,J,Q,Ab,mg,ff){var va,nc,Wa,Dd,gf,Ed,La,oc,da,pe,Ma,Pb=0,Fc=0,gd,Na=!1,pc=!1,Bb=0,Xa=0,Qb=0,Rb=0,Fd,Gd,Sb=function(n){La=n.target;for(da=oc=0;La;)oc+=La.offsetLeft-La.scrollLeft,da+=La.offsetTop-La.scrollTop,La=La.offsetParent;Pb=(Na?Fd:n.pageX)-oc-document.body.scrollLeft;Fc=(Na?Gd:n.pageY)-da-document.body.scrollTop};this.getX=function(){return Pb};this.getY=function(){return Fc};var G=function(n){n.preventDefault();n.stopImmediatePropagation?n.stopImmediatePropagation():n.stopPropagation()},
Hd=function(n){Sb(n);gd=Pb;xa=Fc;Y=!0;null!=Z&&(Dd=(new Date).getTime());null!=wa&&wa(n)},H=function(n){Y&&(Sb(n),Y=!1,null!=Cb&&Cb(n),null!=Z&&(gf=(new Date).getTime(),Ed=gf-Dd,300>Ed&&Z(n)))},hb=function(n){Sb(n);3>Math.abs(Pb-gd)&&3>Math.abs(Fc-xa)||(xa=gd=-9999,Y?null!=Oa&&Oa(n):null!=gb&&gb(n),null!=Id&&qe())};this.touchDown=function(n){Wa=!0;if(1<n.targetTouches.length)return Na=!0,Ma&&(Xa=-1,G(n)),!1;va=n.changedTouches;nc=va[0];Hd(nc)};this.touchUp=function(n){0==n.targetTouches.length&&(Na=
Wa=!1);G(n);if(Na||pc)return Na||(pc=!1),!1;va=n.changedTouches;nc=va[0];H(nc)};this.touchMove=function(n){Wa=!0;G(n);if(Na)return Ma&&(va=n.targetTouches,Fd=(va[0].pageX+va[1].pageX)/2,Gd=(va[0].pageY+va[1].pageY)/2,pc=!0,Qb=va[0].pageX-va[1].pageX,Rb=va[0].pageY-va[1].pageY,Bb=Qb*Qb+Rb*Rb,Sb(n),Ma&&0<Xa&&30<Math.abs(Bb-Xa)&&Ma(0<Bb-Xa?1:-1),Xa=Bb),!1;va=n.changedTouches;nc=va[0];hb(nc)};this.pointUp=function(n){G(n);for(var h=0;h<sa.length;h++)if(sa[h].pointerId==n.pointerId){sa.splice(h,1);break}0==
sa.length&&(Wa=Na=!1);if(Na||pc)return Na||(pc=!1),!1;H(n);return!1};this.pointDown=function(n){G(n);sa.push(n);Xa=-1;Wa=!0;1<sa.length?Na=!0:Hd(n);return!1};this.pointMove=function(n){G(n);for(var h=0;h<sa.length;h++)sa[h].pointerId==n.pointerId&&(sa[h]=n);if(Na||!pc){if(Na)return Fd=(sa[0].pageX+sa[1].pageX)/2,Gd=(sa[0].pageY+sa[1].pageY)/2,Sb(n),Ma&&(pc=!0,Qb=sa[0].pageX-sa[1].pageX,Rb=sa[0].pageY-sa[1].pageY,Bb=Qb*Qb+Rb*Rb,Ma&&0<Xa&&30<Math.abs(Bb-Xa)&&Ma(0<Bb-Xa?1:-1),Xa=Bb),!1;hb(n);return!1}};
this.mouseDown=function(n){Wa||(G(n),Hd(n))};this.clearDown=function(){Y=!1};this.mouseUp=function(n){Wa||(G(n),H(n))};this.useWheel=function(n){h.addEventListener("wheel",this.mouseWheel,!0);Ma=n};this.mouseWheel=function(n){Sb(n);var h=Math.max(-1,Math.min(1,-n.deltaY||-n.detail));G(n);Ma&&Ma(h)};this.mouseClick=function(h){G(h);Y=!1};this.mouseMove=function(h){Wa||(G(h),hb(h))};this.mouseDragged=function(h){Wa||(G(h),Sb(h),null!=Oa&&Oa(h),null!=Id&&qe())};var qe=function(){clearTimeout(pe);pe=
setTimeout(function(){Id()},600)};var xa=gd=Fc=Pb=0;var wa=I;var Cb=J;var gb=Q;var Oa=Ab;var Z=mg;var Id=ff;var Y=Wa=!1;var sa=[];h.addEventListener("mousedown",this.mouseDown,!1);h.addEventListener("mouseup",this.mouseUp,!1);h.addEventListener("mousemove",this.mouseMove,!1);h.addEventListener("click",this.mouseClick,!1);h.addEventListener("touchstart",this.touchDown,!1);h.addEventListener("touchend",this.touchUp,!1);h.addEventListener("touchmove",this.touchMove,!1);h.addEventListener("touchleave",
this.touchUp,!1);h.addEventListener("touchcancel",this.touchUp,!1);h.addEventListener("contextmenu",function(h){h.preventDefault()},!1);h.style["touch-action"]="none";h.addEventListener("mouseout",function(h){Y||(Fc=Pb=-1,null!=gb&&gb(h));Y=!1})};var HAniS=new function(){function h(b){var a,d;hd=!0;if(b instanceof Array)for(e={},null!=ng&&(b=b.concat(ng)),a=0;a<b.length;a++){if(!(2>b[a].length)){var c=b[a].trim();if(0!=c.indexOf("#")){var g=c.indexOf("=");if(!(1>g)){var k=c.substr(0,g).trim().toLowerCase();e[k]=c.substr(g+1).trim()}}}}else e=b;re=!1;a=e.debug;null!=a&&("true"==a?(hf=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),re=!0,ha("HAniS Version 4.30")):re=!1);ib=!0;D(e.set_className,"f")&&(ib=!1);ha("Is type of param an array = "+
(b instanceof Array));a=e.divalign;null!=a&&(Jd=a.trim(),z.align=Jd);D(e.prevent_shortcuts,"t")&&(se=!0);a=e.initial_message;null!=a&&(b=e.initial_message_style,null==b&&(b="background-color:red;top:10px;left:10px;height:100px;width:200px"),b="z-index:99;position:absolute;"+b,qc=t("div"),qc.setAttribute("style",b),qc.innerHTML=a,qc.addEventListener("click",function(){qc.style.visibility="hidden"},!1),qc.style.visibility="visible",Pa.appendChild(qc),b=e.initial_message_timeout,null!=b&&("auto"==b?
jf=!0:(jf=!1,b=parseInt(e.initial_message_timeout,10),2>b&&(b=2),setTimeout(function(){qc.style.visibility="hidden"},1E3*b))));a=e.coordinates;null!=a&&Ab(a);c="green";g="white";k="12px Arial";var m=null,l=d=10,f=10;kf=2;og="Lat = ";pg=" Lon = ";a=e.coordinates_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(og=b[3],pg=b[4],kf=parseInt(b[5],10),6<b.length&&(m=b[6].trim(),d=parseInt(b[7],10),l=parseInt(b[8],10),f=parseInt(b[9],10))));qg=new gb(c,g,k,m,
d,l,f);te=Gc=null;null!=e.map_scale&&(ue=rc=!0,b=e.map_scale.split(","),Gc=parseFloat(b[0]),te=1<b.length?parseFloat(b[1]):Gc);rg=" ";a=e.distance_unit;null!=a&&(rg=a.trim());a=e.divcan_style;null!=a&&a.trim();lf="default";a=e.distance_cursor;null!=a&&(lf=a.trim());ve="default";a=e.location_cursor;null!=a&&(ve=a.trim());we="default";a=e.probe_cursor;null!=a&&(we=a.trim());mf="default";a=e.mark_cursor;null!=a&&(mf=a.trim());a=e.imagecan_style;null!=a&&(b=a.trim()+";position:absolute;top:0;left:0;",
ob.setAttribute("style",b+"z-index:1;"),sc.setAttribute("style",b+"z-index:6;"));c="blue";g="white";k="12px Arial";m=null;f=l=d=10;sg=1;tg="white";a=e.distance_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),tg=5<=b.length?b[4].trim():g,k=b[2].trim(),sg=parseInt(b[3],10),5<b.length&&(m=b[5].trim(),d=parseInt(b[6],10),l=parseInt(b[7],10),f=parseInt(b[8],10)));Th=new gb(c,g,k,m,d,l,f);c="black";g="white";k="12px Arial";m=null;f=l=d=10;a=e.probe_display_style;null!=a&&(b=a.split(","),
c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Uh=new gb(c,g,k,m,d,l,f);ug="Undefined";vg=!1;Kd=0;a=e.probe_undefined;null!=a&&(b=a.split(","),ug=b[0].trim(),1<b.length&&(Kd=parseInt(b[1],10)+1),2<b.length&&(vg=!0));nf=!1;e.probe_base_image&&(nf=!0);a=e.active_probe;null!=a&&(Tb=!0);a=e.pause;null!=a&&(wg=parseInt(a,10));a=e.auto_refresh;null!=a&&(of=6E4*parseInt(a,10),Hc=setInterval("HAniS.reloadFOF();",of),Ld=!0);
Md=!1;D(e.enable_smoothing,"t")&&(Md=!0);xe=!0;D(e.check_image_size,"f")&&(xe=!1);xg=!1;a=e.sprites;if(null!=a){b=a.split(",");pf=new Image;qf=[];rf=[];Ub=[];Vb=[];if("row"==b[1].trim().toLowerCase())for(l=g=c=0,a=2;a<b.length;)for("row"==b[a].trim().toLowerCase()&&(c=0,g+=l,l=0,a+=1),d=parseInt(b[a],10),a+=1,k=parseInt(b[a],10),a+=1,m=parseInt(b[a],10),m>l&&(l=m),a+=1,f=0;f<d;f++)qf.push(c),rf.push(g),Ub.push(k),Vb.push(m),c+=k;else for(g=!1,a=1;a<b.length;)qf.push(parseInt(b[a],10)),a+=1,rf.push(parseInt(b[a],
10)),a+=1,a>=b.length?(c=0,g=!0):c=parseInt(b[a],10),0>c?(g=!0,Ub.push(Math.abs(c)),a+=1,c=parseInt(b[a++],10),Vb.push(Math.abs(c))):g?(Ub.push(Ub[Ub.length-1]),Vb.push(Vb[Vb.length-1])):(Ub.push(parseInt(b[a],10)),a+=1,Vb.push(parseInt(b[a],10)),a+=1);pf.onload=function(){xg=!0};pf.src=b[0]}a=e.overlay_labels;null!=a&&(Wb=a.split(","));sf=null;a=e.auto_enhance_background;null!=a&&(sf=parseInt(a,10)-1);Ic=null;a=e.auto_enhance;if(null!=a)for(c=e.overlay_probe_table,b=a.split(","),Ic=Array(b.length),
a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?Ic[a]=-1:Ic[a]=parseInt(b[a].trim(),10)-1,null==c&&(tc[a]=Ic[a]);Jc=!1;pb=-1;a=e.overlay_enhance;null!=a&&(Jc=!0,pb=parseInt(a,10)-1);uc=null;id=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(b=a.split(","),uc=Array(b.length),a=0;a<b.length;a++)if(uc[a]=!0,D(b[a],"n")||D(b[a],"f"))uc[a]=!1;U=aa=null;tf=yg=!1;a=e.window_size;null!=a&&(b=a.split(","),"div"==b[0]?tf=!0:(U=parseInt(b[0],10),aa=parseInt(b[1],10)),yg=!0);Db=[];a=e.use_for_all_frames;if(null!=
a)for(b=a.split(","),a=0;a<b.length;a+=2)Db[parseInt(b[a],10)]=parseInt(b[a+1],10)-1;Nd=-1;a=e.skip_missing;null!=a&&(Nd=parseInt(a,10));zg="#00000000";a=e.skip_missing_color;null!=a&&(zg=a);ye=null;a=e.overlay_spacer;if(null!=a)for(b=a.split(","),ye=Array(b.length),a=0;a<b.length;a++)ye[a]=parseInt(b[a],10);a=e.overlay_probe_table;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?tc[a]=-1:tc[a]=parseInt(b[a],10)-1;uf=[];a=e.overlay_ontop;if(null!=a)for(b=a.split(","),
a=0;a<b.length;a++)uf[parseInt(b[a],10)-1]=!0;Kc=null;a=e.overlay_order;null==a&&(a=e.overlay_zorder);if(null!=a)for(b=a.split(","),Kc=Array(b.length),a=0;a<b.length;a++)Kc[parseInt(b[a],10)-1]=a;Xb=null;a=e.overlay_links;if(null!=a)for(b=a.split(","),Xb=Array(b.length),a=0;a<b.length;a++)Xb[a]=parseInt(b[a],10);Ag=[];P=null;a=e.overlay_slice;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)Ag[parseInt(b[a],10)-1]=!0;Bg=!0;D(e.slice_smoothing,"f")&&(Bg=!1);jd=null;a=e.overlay_clear;if(null!=a)for(b=
a.split(","),jd=Array(b.length),a=0;a<b.length;a++)jd[a]=b[a].trim().toLowerCase();Cg=!1;a=e.transparency;null!=a&&(b=a.split(","),1==b.length?Dg=Eg=Fg=parseInt(b[0],10):(Dg=parseInt(b[0],10),Eg=parseInt(b[1],10),Fg=parseInt(b[2],10)),Cg=!0);vf=!1;a=e.transparency_list;if(null!=a){b=a.split(",");Gg=[];for(a=0;a<b.length;a++)Gg[parseInt(b[a].trim(),10)-1]=!0;vf=!0}ze=null;a=e.overlay_transparent_amount;if(null!=a)for(b=a.split(","),ze=Array(b.length),a=0;a<b.length;a++)ze[a]=parseFloat(b[a])/100;Lc=
null;a=e.overlay_zoom;if(null!=Wb&&null!=a)for(b=a.split(","),Lc=Array(b.length),a=0;a<b.length;a++)if(Lc[a]=1,D(b[a],"n")||D(b[a],"f"))Lc[a]=0;else if(D(b[a],"d")||D(b[a],"h"))Lc[a]=-1;qb=null;Hg=[];a=e.overlay_preserve_list;if(null!=Wb&&null!=a)for(b=a.split(","),qb=Array(b.length),a=0;a<b.length;a++){qb[a]=!0;if(D(b[a],"n")||D(b[a],"f"))qb[a]=!1;if(D(b[a],"a")||D(b[a],"A"))Hg[a]=!0}ba=null;if(null!=Wb&&null!=qb)for(b=e.overlay_preserve.replace(/&/g,",&,").split(","),c=e.overlay_preserve_position,
null!=c&&(c=c.split(",")),g=0,ba=Array(qb.length),a=k=0;a<qb.length;a++)if(qb[a]){ba[a]=[];m=0;do{ba[a][m]=[];for(d=0;4>d;d++)ba[a][m][d]=parseInt(b[k].trim(),10),k+=1;ba[a][m][2]=ba[a][m][2]-ba[a][m][0]+1;ba[a][m][3]=ba[a][m][3]-ba[a][m][1]+1;null!=c?(ba[a][m][4]=parseInt(c[g],10),ba[a][m][5]=parseInt(c[g+1],10),g+=2):(ba[a][m][4]=ba[a][m][0],ba[a][m][5]=ba[a][m][1]);k<b.length&&"&"==b[k].trim()?(k+=1,m+=1,d=!0):d=!1}while(d)}Ae=0;Ig=" ";vc="white";Od="transparent";Pd="14pt arial";Jg=!1;a=e.times_label_style;
null!=a&&(b=a.split(","),vc=b[0].trim(),1<b.length&&(Ae=Math.floor(60*parseFloat(b[1]))),1<b.length&&(Ae="?"==b[1].trim()||"auto"==b[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(b[1]))),2<b.length&&(Ig=b[2].trim()),3<b.length&&(Od=b[3].trim()),4<b.length&&(Pd=b[4].trim()),5<b.length&&-1!=b[5].trim().indexOf("t")&&(Jg=!0));0==vc.indexOf("0x")&&(vc="#"+vc.substring(2));0==Od.indexOf("0x")&&(Od="#"+Od.substring(2));kd=parseInt(Pd,10);Vh=new gb("black",
"white",Pd,"black",20,5,5);Kg=!1;Kg=D(e.to_from_lock,"t")?!0:!1;a="black";d="white";l="14px arial";c=null;m=k=g=10;Lg=Mg=" ";wf=ld=null;a=e.dirspd_display_style;null!=a&&(b=a.split(","),a=b[0].trim(),d=b[1].trim(),l=b[2].trim(),Lg=b[3],Mg=b[4],5<b.length&&(c=b[5].trim(),g=parseInt(b[6],10),k=parseInt(b[7],10),m=parseInt(b[8],10)),wf=new gb(a,d,l,c,g,k,m));c="black";g="white";k="14px arial";m=null;f=l=d=10;a=e.tipbox_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),
3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Ng=new gb(c,g,k,m,d,l,f);md=null;ea=e.image_base;null!=ea?md=ea=ea.trim():ea=null!=e.image_only_base?e.image_only_base.trim():null;Og=ea;a=e.overlay_base;null!=a&&(Yb=a.trim());Be=!0;D(e.zip_only,"f")&&(Be=!1);Mc=!1;a=e.zip_filename;null!=a&&(Mc=!0,xf=a.trim());hd=!0;a=e.filenames;null==a&&(a=e.background_filenames);null!=a&&Wh(a);a=e.basename;null!=a&&(c=e.base_starting_number,g=0,k=1,null!=c&&(b=c.split(","),
g=parseInt(b[0],10),1<b.length&&(k=parseInt(b[1],10))),u=e.num_frames,null==u&&(u=e.num_images),u=parseInt(u,10),Xh(a,g,k));yf=!0;b=e.zip_static;if(D(b,"f")||D(b,"n"))yf=!1;zf=!0;b=e.background_static;if(D(b,"f")||D(b,"n"))zf=!1;a=e.overlay_filenames;null!=a&&Yh(a);Fa=null;a=e.image_preserve;if(null!=a)for(b=a.split(","),Fa=[],a=0;a<b.length;a++)Fa[a]=parseInt(b[a].trim(),10),1<a%4&&(Fa[a]=Fa[a]-Fa[a-2]+1);Pg=!0;D(e.keep_zoom,"f")&&(Pg=!1);Qd=Qg=0;Rg=!1;a=e.hide_bottom;null!=a&&(b=a.split(","),Qg=
parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Rg=!0));Rd=Sg=0;Tg=!1;a=e.hide_top;null!=a&&(b=a.split(","),Sg=parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Tg=!0));Sd=Ug=0;Vg=!1;a=e.hide_left;null!=a&&(b=a.split(","),Ug=parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Vg=!0));Td=Wg=0;Xg=!1;a=e.hide_right;null!=a&&(b=a.split(","),Wg=parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Xg=!0));Yg=!1;D(e.hide_background,"t")&&(Yg=!0);Zg="<div>";$g=300;ah=500;a=e.popup_style;null!=a&&(Zg='<div style="'+
a+'">');a=e.popup_window_size;null!=a&&(b=a.split(","),ah=b[0],$g=b[1]);bh=!1;a=e.wheel_frames;null!=a&&(bh=!0,la.useWheel(HAniS.wheel));ch=ya=!1;D(e.active_zoom,"t")&&(null==za&&(ya=!0),la.useWheel(HAniS.wheel));Af=!1;D(e.cycle_zoom,"t")&&(Af=!0);a=e.initial_zoom;null!=a&&(b=a.split(","),wc="auto"!=b[0].toLowerCase()?parseFloat(b[0]):"auto",1<b.length?(Ud=parseInt(b[1],10),dh=parseInt(b[2],10)):Ud=-1,eh=!0);nd=1;od=!1;ma=null;a=e.zoom_scale;if(null!=a)if(b=a.split(","),1===b.length)D(a,"hi_res")?
(od=!0,nd=0):nd=parseFloat(a);else{ma=Array(b.length);for(a=0;a<b.length;a++)ma[a]=parseFloat(b[a]);od=!0}Nc=9999999;a=e.maximum_zoom;null!=a&&(Nc=parseFloat(a));Ce=!0;D(e.use_progress_bar,"f")&&(Ce=!1);a=e.dwell;null!=a&&(b=a.split(","),Aa=parseInt(b[0].trim(),10),1<b.length&&(Zb=parseInt(b[1].trim(),10),10>Zb&&(Zb=10),Oc=parseInt(b[2].trim(),10),Bf=parseInt(b[3].trim(),10)));a=e.rate;null!=a&&(b=a.split(","),Aa=Math.round(1E4/parseFloat(b[0].trim())),1<b.length&&(Zb=Math.round(1E4/parseFloat(b[2].trim())),
10>Zb&&(Zb=10),Oc=Math.round(1E4/parseFloat(b[1].trim()))));a=e.frame_times_template;null!=a&&(b=a.split(","));rb=null;a=e.times;if(null!=a){b=a.split(",");rb=Array(b.length);for(a=0;a<b.length;a++)rb[a]=parseInt(b[a].trim(),10);va(rb)}a=e.extrap_times_filename;if(null!=a){rb=[];var h=new XMLHttpRequest;h.open("get",a,!0);h.onload=function(){for(var a=h.responseText.split("\n"),b=0;b<a.length;b++){var c=a[b].split(" ");if(3==c.length){c[2].trim();var d=parseInt(c[0],10)-1;rb[d]=100*parseInt(c[2].substring(0,
2),10)+parseInt(c[2].substring(3,5),10)+parseInt(c[2].substring(6,8),10)/30}}va(rb)};h.send()}Vd=null;a=e.extrap_times_template;null!=a&&(Vd=RegExp(a));fh=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];gh=10;D(e.extrap_prompts_position,"bot")&&(gh=9999);a=e.extrap_prompts;null!=a&&(fh=a.split(","));De=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&(De=a.split(","));Ee=!0;D(e.mark_close,
"f")&&(Ee=!1);Cf="12pt Arial";hh="white";a=e.mark_prompts_style;null!=a&&(b=a.split(","),Cf=b[0].trim(),1<b.length&&(hh=b[1].trim()));ih=e.controls;ha("controls = "+e.controls);ha("bottom_controls = "+e.bottom_controls);Pc=Fe=$b=ac=sb=tb=Eb=null;null!=ih&&pe(ih,!0);jh=e.bottom_controls;null!=jh&&pe(jh,!1);Qc=!1;a=e.probe_table;null!=a&&Q(a);b=e.enhance_filename;null==b&&(b=e.enhance_table);if(null!=b){ha("Reading enhancement table...");Qc=!1;h=new XMLHttpRequest;ub=[];Rc=[];Ge=[];Sc=[];bc=[];var kh,
jb,n;Ya=[];Za=[];$a=[];Wd=[];v=-1;lh=!0;var q=!1,r,x,w,p,L,A,E,y,G,H,mh,B,C;h.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var c=a[b].replace(/\s+/g," ").trim(),d=c.indexOf("#");if(0!=d)if(0<d&&(c=c.substring(0,d)),d=c.split(","),0==d[0].indexOf("*"))v++,ub[v]=Array(256),Sc[v]=Array(256),Rc[v]=Array(256),bc[v]=Array(256),Ya[v]=Array(256),Za[v]=Array(256),$a[v]=Array(256),Wd[v]=Array(256),ub[v]=Array(256),Ge[v]=1<d.length?d[1].trim():"None",kh=" ",
jb="Value =",n=1,c=t("option"),c.innerHTML=d[0].substring(1),c.value=v,null!=Ba&&Ba.add(c);else{var g=c.indexOf("value");0>g&&(g=c.indexOf("probe"));q=!1;H=mh=0;0<g&&(d=c.substring(g+1),c=c.substring(0,g),g=d.indexOf("="),d=d.substring(g+1),d=d.split(","),1==d.length?(jb=d[0].trim(),n=-1,q=!1):(H=parseFloat(d[0].trim()),mh=parseFloat(d[1].trim()),2<d.length&&(n=parseInt(d[2],10)),3<d.length&&(kh=Zh(d[3].trim())),4<d.length&&(jb=d[4].trim()),q=!0));c=c.split(" ");r=parseInt(c[0].trim(),10);x=parseInt(c[1].trim(),
10);w=x-r;p=parseFloat(c[2].trim());L=parseFloat(c[3].trim());A=parseFloat(c[4].trim());E=parseFloat(c[5].trim());y=parseFloat(c[6].trim());G=parseFloat(c[7].trim());B=C=255;9<c.length&&(B=parseFloat(c[8].trim()),C=parseFloat(c[9].trim()));for(c=r;c<=x;c++)0===w?(Ya[v][r]=p,Za[v][r]=A,$a[v][r]=y,Wd[v][r]=B):(Ya[v][c]=Math.round(p+(L-p)*(c-r)/w),Za[v][c]=Math.round(A+(E-A)*(c-r)/w),$a[v][c]=Math.round(y+(G-y)*(c-r)/w),Wd[v][c]=Math.round(B+(C-B)*(c-r)/w)),Sc[v][c]=jb,Rc[v][c]=kh,bc[v][c]=n,q&&(ub[v][c]=
H+(mh-H)*(c-r)/w)}}-1!=pb&&F[pb].checked&&(Ba.disabled=!1);Qc=!0;I()};h.open("get",b,!0);h.send()}else I()}function I(){var b=e.sprite_filenames;if(null!=b){var a=b.split(",");Df=0;ja=[];b=e.sprite_images_offset;Tc=-1;null!=b&&(Tc=parseInt(b,10)-1);for(b=0;b<a.length;b++){ja[b]=new Image;ja[b].gotit=!1;ja[b].inx=b;ja[b].fromfile=!0;var d="/";0<a[b].indexOf("?")&&(d="?");ja[b].zoomme=0<a[b].indexOf(d+"zoom");ja[b].anim=0<a[b].indexOf(d+"animate");d=a[b].indexOf(d);0<d&&(a[b]=a[b].substring(0,d));ja[b].onload=
function(){ja[this.inx].gotit=!0;Df++;Df==a.length&&J()};ja[b].src=a[b].trim()}}else J()}function J(){for(var b=Object.keys(e),a=0;a<b.length;a++)D(b[a],"hotspot")&&Pb("hotspot="+e[b[a]]);hd?HAniS.getFOF():(xc=!0,La())}function Q(b){var a=new XMLHttpRequest;ub=[];Ge=[];Rc=[];var d=" ";Sc=[];var c="Value=";bc=[];var g=1;Uc=[];Ef=[];Ya=[];Za=[];$a=[];var e,m=-1;v=-1;var l=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var k=a[b].replace(/\s+/g,
" ").trim().split(","),f=k[0].split(" ");if(0==f[0].indexOf("*"))v++,ub[v]=[],Sc[v]=[],Rc[v]=[],bc[v]=[],Ya[v]=[],Za[v]=[],$a[v]=[],Ef[v]=[],Uc[v]=[],m=-1,Ge[v]=1<k.length?k[1].trim():"None",l=1;else if(0!=l){m++;var h=Array(3);ub[v][m]=parseFloat(f[0]);Ya[v][m]=parseInt(f[1].trim(),10);Za[v][m]=parseInt(f[2].trim(),10);$a[v][m]=parseInt(f[3].trim(),10);0!=m&&(h[0]=Ya[v][m]-Ya[v][m-1],h[1]=Za[v][m]-Za[v][m-1],h[2]=$a[v][m]-$a[v][m-1],e=0,Math.abs(h[1])>Math.abs(h[e])&&(e=1),Math.abs(h[2])>Math.abs(h[e])&&
(e=2),Ef[v][m-1]=e,Uc[v][m-1]=h,0==Uc[v][m-1][e]&&(Uc[v][m-1][e]=1));1<k.length&&(0==k[1].trim().indexOf('"')?(g=-1,k=k[1].trim(),c=k.substr(1,k.length-2),d=""):(g=parseInt(k[1],10),2<k.length&&(d=Zh(k[2].trim())),3<k.length&&(c=k[3].trim())));Sc[v][m]=c;bc[v][m]=g;Rc[v][m]=d}}Qc=!0};a.open("get",b,!0);a.send()}function Ab(b){b=b.split(",");var a=b[0].trim();"PS"===a?(cc=new ri,cc.init(b)):"CE"==a?(cc=new si,cc.init(b)):"LCC"==a?(cc=new ti,cc.init(b)):(cc=null,Ff=parseFloat(b[0]),nh=parseFloat(b[1]),
$h=parseFloat(b[2]),ai=parseFloat(b[3]))}function mg(b){var a=new XMLHttpRequest;a.onload=function(){h(this.responseText.split("\n"))};a.open("get",b+"?"+Math.round(1E5*Math.random()),!0);a.send()}function ff(b){var a;if(null!=jd){for(a=0;a<jd.length;a++)-1!=jd[a].indexOf(b)&&(F[a].checked=!1);for(a=0;a<jd.length;a++)Ma(a)}}function va(b){Gf=Array(b.length);for(var a=0;a<b.length;a++){var d=60*Math.floor(b[a]/100)+Math.floor(b[a])%100;0===a&&(dc=d);var c=d-dc;0>c&&(c=d+1440-dc);Gf[a]=c;ha("times s="+
d+"  min="+Gf[a])}dc+=Ae;1440<=dc&&(dc-=1440);0>dc&&(dc+=1440);ha("Starting minute = "+dc)}function nc(b,a){if(0!=b&&!Vc)for(var d=0;d<b;d++)0==F[Ga[d].overlay].isGhost&&(F[Ga[d].overlay].parentNode.style.visibility=a)}function Wa(){0!=vb?nc(vb,"visible"):0!=oh&&nc(oh,"hidden");xc=!0;La()}function Dd(b,a){pd||(ob.height=a,ob.width=b,sc.height=a,sc.width=b,Xd.height=a,Xd.width=b,He.height=a,He.width=b,Yd=He.getContext("2d"),U=b,aa=a,Ie=U/2-100,Je=aa/2-10,A=1*na/U,E=1*ia/aa,ph&&(ph=!1,null!=Ke&&Ke()),
Pa.style.height=aa+"px",Pa.style.width=U+"px",yc.style.height=aa+"px",yc.style.width=U+"px",qd.style.height=aa+"px",qd.style.width=U+"px",qe(u,!1))}function gf(){for(var b=0,a={},d=0;d<u;a={$jscomp$loop$prop$ii$2:a.$jscomp$loop$prop$ii$2},d++){a.$jscomp$loop$prop$ii$2=d;var c=null==ea?ta[d]:ta[d].substring(ta[d].lastIndexOf("/")+1);(c=qh.file(c))?c.async("arraybuffer").then(function(a){return function(c){c=new Blob([c]);zc[a.$jscomp$loop$prop$ii$2]=URL.createObjectURL(c);b++;b>=u&&Ed()}}(a),function(a){return function(){zc[a.$jscomp$loop$prop$ii$2]=
null;b++;b>=u&&Ed()}}(a)):(zc[a.$jscomp$loop$prop$ii$2]=null,b++,b>=u&&Ed())}}function Ed(){var b=0;if(0==ca)oc();else for(var a=0;a<u;a++){Ac[a]=[];for(var d={},c=0;c<ca;d={$jscomp$loop$prop$ii$6:d.$jscomp$loop$prop$ii$6,$jscomp$loop$prop$jj$7:d.$jscomp$loop$prop$jj$7},c++){d.$jscomp$loop$prop$ii$6=a;d.$jscomp$loop$prop$jj$7=c;var g=null==Yb&&null==ea?fa[a][c]:fa[a][c].substring(fa[a][c].lastIndexOf("/")+1);(g=qh.file(g))?g.async("arraybuffer").then(function(a){return function(c){c=new Blob([c]);
Ac[a.$jscomp$loop$prop$ii$6][a.$jscomp$loop$prop$jj$7]=URL.createObjectURL(c);b++;b>=u*ca&&oc()}}(d),function(a){return function(){Ac[a.$jscomp$loop$prop$ii$6][a.$jscomp$loop$prop$jj$7]=null;b++;b>=u*ca&&oc()}}(d)):(Ac[a][c]=null,b++,b>=u*ca&&oc())}}}function La(){if(Mc){var b=new XMLHttpRequest,a=null==md?xf:md+xf;yf||(a=a+"?"+Math.round(1E5*Math.random()));b.open("GET",a,!0);b.responseType="arraybuffer";zc=[];Ac=[];b.addEventListener("progress",function(a){a.lengthComputable&&sa("Loading ZIP file",
a.total,a.loaded)});b.onload=function(a){(new JSZip).loadAsync(this.response).then(function(a){qh=a;gf()},function(){ha("Unable to read ZIP file: "+xf)})};b.send()}else oc()}function oc(){var b,a,d;void 0!=Le&&Le(!1);var c="?"+Math.round(1E4*Math.random()),g=[];g[0]=Bc;for(b=1;b<u;b++)g[b]=b<=Bc?b-1:b;Ha=Array(u);Fb=Ca=0;rh=Ce;Hf&&(kb.max=u);pd&&(rd||Jc)&&(ec=[],Qa=[],Wc=[],If=[],Me=[]);null!=Ba&&(Ba.selectedIndex=0);for(var e=0;e<u;e++){b=g[e];pd&&(rd||Jc)&&(ec[b]=t("canvas"),Qa[b]=t("canvas"));
Ha[b]=new Image;Ha[b].gotit=!1;Ha[b].frameNum=b;Ha[b].onerror=function(){Ca++};Ha[b].onload=function(){pd&&(ia=this.height,na=this.width,ab=ia,bb=na,pd=!1,yg?tf?HAniS.setWindowSize(z.offsetWidth,z.offsetHeight):Dd(U,aa):Dd(na,ia),eh&&("auto"==wc&&(wc=(A+E)/2,Ud=-1),ab/=wc,bb/=wc,0>Ud&&(Ud=na/2,dh=ia/2),N=Math.round(Ud-na/2/wc),R=Math.round(dh-ia/2/wc),B=C=wc,1!=wc&&(ya=!1,HAniS.toggleZooming())));Mc&&null!=zc[this.frameNum]&&URL.revokeObjectURL(zc[this.frameNum]);if(0<Ne&&!sd){Jf.height=ia;Jf.width=
na;Zd=Jf.getContext("2d");Zd.clearRect(0,0,U,aa);for(var b=0;b<Ra.length;b++){for(var e=Ra[b].ctx.getImageData(0,0,Ra[b].width,Ra[b].height).data,m=Zd.getImageData(Ra[b].xmin,Ra[b].ymin,Ra[b].width,Ra[b].height),k=3;k<e.length;k+=4)0!=e[k]&&(m.data[k]=b+1);Zd.putImageData(m,Ra[b].xmin,Ra[b].ymin)}ya||(lb=!0);B==Oe&&(lb=!0);sd=!0}if(xc){xc=!1;M=ob.getContext("2d");M.imageSmoothingEnabled=Md;M.fillStyle="blue";M.font="bold 20px Arial";f=sc.getContext("2d");f.imageSmoothingEnabled=Md;Sa=Array(u);qe(u,
!0);Pe&&!Ta?xa(wa(Bc)):xa(wa(q));if(0<ca)for(K=Array(u),k=0;k<u;k++)for(d=g[k],K[d]=Array(ca),a=0;a<ca;a++)if(void 0!=Db[a+1]&&Db[a+1]>=u&&(Db[a+1]=u-1),void 0==Db[a+1]||Db[a+1]==d)K[d][a]=new Image,K[d][a].gotit=!1,K[d][a].frameNum=d,K[d][a].overlayNum=a,K[d][a].onerror=function(){Ca++},K[d][a].onload=function(){this.gotit=!0;var a=this.frameNum;Ca++;n();!xe||this.height==ia&&this.width==na?this.overlayNum==Nd-1&&(Sa[this.frameNum]=0):(this.gotit=!1,ha("Bad image size:"+this.src));if(Jc&&this.gotit&&
this.overlayNum==pb)ec[a].height=this.height,ec[a].width=this.width,$d=ec[a].getContext("2d"),$d.drawImage(this,0,0),If[a]=$d.getImageData(0,0,this.width,this.height).data,Qa[a].height=this.height,Qa[a].width=this.width,Wc[a]=Qa[a].getContext("2d"),Wc[a].drawImage(this,0,0),Me[a]=Wc[a].getImageData(0,0,this.width,this.height),K[a][this.overlayNum]=null,K[a][this.overlayNum]=Qa[a],K[a][this.overlayNum].gotit=!0;else if(this.gotit&&F[this.overlayNum].hotspotIndex){var b=t("canvas");b.height=this.height;
b.width=this.width;var c=b.getContext("2d");c.drawImage(this,0,0);var d=c.getImageData(0,0,this.width,this.height).data,g=d.length;var e=this.overlayNum;var k;for(k=0;k<g;k+=4)if(0!=d[k]){0==mb&&(nb=[]);var m=d[k];var l=Math.floor(k/4/b.width);c=Math.floor(k/4%b.width);nb[mb]=new Bb(c,l,"spritefn",m,"pan",null,null,e,a,null);mb++}}else if(this.gotit&&Cg&&(!vf||vf&&Gg[this.overlayNum])){b=t("canvas");b.height=this.height;b.width=this.width;c=b.getContext("2d");c.drawImage(this,0,0);l=c.getImageData(0,
0,this.width,this.height);d=l.data;g=d.length;for(k=0;k<g;k+=4)d[k]===Dg&&d[k+1]===Eg&&d[k+2]===Fg&&(d[k+3]=0);c.putImageData(l,0,0);K[a][this.overlayNum]=null;K[a][this.overlayNum]=b;K[a][this.overlayNum].gotit=!0}this.gotit&&uf[this.overlayNum]?(Kf.clearRect(0,0,U,aa),Kf.drawImage(K[a][this.overlayNum],0,0,U,aa)):this.gotit&&Ag[this.overlayNum]&&null!=P&&(b=t("canvas"),b.height=ia,b.width=na,8>P.length&&(P[4]=0,P[5]=0,P[6]=na,P[7]=ia),c=b.getContext("2d"),c.imageSmoothingEnabled=Bg,c.drawImage(this,
P[0],P[1],P[2],P[3],P[4],P[5],P[6],P[7]),K[a][this.overlayNum]=null,K[a][this.overlayNum]=b,K[a][this.overlayNum].gotit=!0,null!=qb&&qb[this.overlayNum]&&(K[a][this.overlayNum].origImage=this));Mc&&null!=Ac[a][this.overlayNum]&&URL.revokeObjectURL(Ac[a][this.overlayNum]);if(void 0!=Db[this.overlayNum+1]&&Db[this.overlayNum+1]==a)for(b=0;b<u;b++)b!=a&&(K[b][this.overlayNum]=K[a][this.overlayNum],Ca++)},b=fa[d][a],void 0==ae||ae[a]||(b+=c),K[d][a].src=Mc&&(Be||Ac[d][a])?Ac[d][a]:b,Fb++;if(null!=Xc)for(fc=
[],a=0;a<Xc.length;a++)fc[a]=new Image,fc[a].gotit=!1,fc[a].onerror=function(a){Ca++},fc[a].onload=function(a){a.currentTarget.gotit=!0;Ca++;n()},fc[a].src=Xc[a],Fb++;if(null!=Ia&&0<Ia.length)for(ua=[],a=0;a<Ia.length;a++)if(void 0!=Ia[a])for(ua[a]=[],d=0;d<Ia[a].length;d++)for(ua[a][d]=[],k=0;k<u;k++)bi(Ia[a][d],"/")?(b=fa[k][a].lastIndexOf("/"),b=fa[k][a].substring(0,b+1)+Ia[a][d]+fa[k][a].substring(b+1),ua[a][d][k]=new Image,ua[a][d][k].gotit=!1,ua[a][d][k].onerror=function(a){Ca++;n()},ua[a][d][k].onload=
function(a){a.currentTarget.gotit=!0;Ca++;n()},ua[a][d][k].src=b,Fb++):0===k?(ua[a][d][0]=new Image,ua[a][d][0].gotit=!1,ua[a][d][0].onerror=function(a){Ca++;n()},ua[a][d][0].onload=function(a){a.currentTarget.gotit=!0;Ca++;n()},ua[a][d][0].src=Ia[a][d],Fb++):ua[a][d][k]=ua[a][d][0]}!xe&&0!=this.height&&0!=this.width||this.height==ia&&this.width==na?(this.gotit=!0,0==Nd&&(Sa[this.frameNum]=0)):(this.gotit=!1,ha("Image has invalid size:"+this.src));rd&&this.gotit&&(k=this.frameNum,ec[k].height=this.height,
ec[k].width=this.width,$d=ec[k].getContext("2d"),$d.drawImage(this,0,0),If[k]=$d.getImageData(0,0,this.width,this.height).data,Qa[k].height=this.height,Qa[k].width=this.width,Wc[k]=Qa[k].getContext("2d"),Wc[k].drawImage(this,0,0),Me[k]=Wc[k].getImageData(0,0,this.width,this.height),Ha[k]=null,Ha[k]=Qa[k],Ha[k].gotit=!0);Ca++;n();Pg||HAniS.resetZoom();Yc=!0;ci||(ci=!0,Da=!1,di());G(Ta)};var m=ta[b];void 0!=Db[0]&&(m=Db[0],m>=u&&(m=u-1),m=ta[m]);zf||(m+=c);Ha[b].src=Mc&&(Be||zc[b])?zc[b]:m;Fb++}Zc=
Gb=!1;Z()}function da(b,a,d,c,g,k){b.label_on=d;b.label_off=c;ib&&(b.className=k);d=null;c=e[a+"_labels"];null==c&&(c=e[a+"_label"]);null!=c&&(c=c.split(","),b.label_on=c[0].trim(),1<c.length&&(b.label_off=c[1].trim()),2<c.length&&(d="width:"+c[2].trim()+"px;"));null!=g&&(b.title=g);b.innerHTML=b.label_on;g=a=c=e[a+"_style"];null!=c&&(c=c.split("&"),1<c.length&&(a=c[0],g=c[1]));b.style_on=(null!=d?d:"")+Cc+a;b.style_off=(null!=d?d:"")+Cc+g;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",
b.style_on):(b.style_on=null,b.style_off=null)}function pe(b,a){Cc=e.buttons_style;null==Cc&&(Cc="");var d=null,c=null;d=a?e.controls_tooltip:e.bottom_controls_tooltip;var g=b.split(",");if(null!=d){var k=d.split(",");k.length!=g.length&&(ha("!!! Number of tooltips must equal number of controls!"),k=d=null)}for(b=0;b<g.length;b++){var m=null!=d?k[b]:null;var l=g[b].trim();c=l.indexOf("/");if(0===c||0===b){0===c&&(l=l.substring(1));x=t("div");x.align=Jd;var f=e.controls_style;null!=f?x.setAttribute("style",
f):x.setAttribute("style","position:relative;padding:2px;width:100%;");a?(z.insertBefore(x,Pa),Lf=x):(f=e.bottom_controls_style,null!=f&&x.setAttribute("style",f),z.appendChild(x),Mf=x)}"enhance"==l.trim()&&(Ba=t("select"),c=e.enhance_style,null!=c&&Ba.setAttribute("style",c),null!=m&&(Ba.title=m),c=t("option"),c.innerHTML="Pick Enhancement",c.value=-1,Ba.add(c),Ba.addEventListener("change",HAniS.doEnhance,!1),rd=!Jc,Ba.disabled=rd?!1:!0,x.appendChild(Ba));"startstop"==l&&(Eb=t("button"),da(Eb,"startstop",
"Start","Stop",m,"startstop start"),Eb.addEventListener("click",HAniS.toggleIsLooping,!1),x.appendChild(Eb));"looprock"==l&&(be=t("button"),da(be,"looprock","Rock","Loop",m,"looprock rock"),Nf=1,be.addEventListener("click",HAniS.toggleLoopRock,!1),x.appendChild(be),D(e.start_rocking,"t")&&HAniS.toggleLoopRock());"loophalt"==l&&(ce=t("button"),da(ce,"loophalt","Halt","Loop",m,"loophalt halt"),wb=!1,ce.addEventListener("click",HAniS.toggleLoopHalt,!1),x.appendChild(ce));"extrap"==l&&(gc=t("button"),
da(gc,"extrap","Enable Extrap","Disable Extrap",m,"extrap"),gc.addEventListener("click",HAniS.toggleExtrap,!1),x.appendChild(gc));D(l,"location")&&(td=t("button"),da(td,"location","Show Loc","Hide Loc",m,"location"),0<l.indexOf("/on")?(H(td,!1,"location off"),ud=!0,Ea.push(z.style.cursor),z.style.cursor=ve):(ud=!1,z.style.cursor=Ea.pop()),td.addEventListener("click",function(){(ud=!ud)?(H(td,!1,"location off"),Ea.push(z.style.cursor),z.style.cursor=ve):(H(td,!0,"location on"),z.style.cursor=Ea.pop());
Z()},!1),x.appendChild(td));"distance"==l&&(hc=t("button"),da(hc,"distance","Show dist","Hide dist",m,"distance"),rc=ue=!1,hc.addEventListener("click",function(){(rc=!rc)?(H(hc,!1,"distance off"),Ea.push(z.style.cursor),z.style.cursor=lf):(H(hc,!0,"distance on"),z.style.cursor=Ea.pop())},!1),x.appendChild(hc));D(l,"probe")&&(vd=t("button"),da(vd,"probe","Show probe","Hide probe",m,"probe"),0<l.indexOf("/on")?(H(vd,!1,"probe off"),Tb=!0,Ea.push(z.style.cursor),z.style.cursor=we):(Tb=!1,z.style.cursor=
Ea.pop()),vd.addEventListener("click",function(){(Tb=!Tb)?(H(vd,!1,"probe off"),Ea.push(z.style.cursor),z.style.cursor=we):(H(vd,!0,"probe on"),z.style.cursor=Ea.pop())},!1),x.appendChild(vd));"mark"==l&&($c=t("button"),da($c,"mark","Mark","Stop Mark",m,"mark"),de=!0,$c.addEventListener("click",function(){xb=!xb;oa=[];xb?(wd=0,H($c,!1,"mark off"),null!=za&&(za.disabled=!0),Ea.push(z.style.cursor),z.style.cursor=mf):(H($c,!0,"mark on"),null!=za&&(za.disabled=!1),wd=-1,z.style.cursor=Ea.pop());Z()},
!1),ei=new gb("black","white",Cf,"black",20,5,5),sh=new gb("black","white",Cf,"black",20,5,5),x.appendChild($c));"refresh"==l&&(Fe=t("button"),da(Fe,"refresh","Refresh",null,m,"refresh"),Fe.addEventListener("click",HAniS.reloadFOF,!1),x.appendChild(Fe));"restore"==l&&(Of=t("button"),da(Of,"restore","Restore",null,m,"restore"),Of.addEventListener("click",function(a){for(a=0;a<F.length;a++)F[a].checked=F[a].restorableState;for(a=0;a<F.length;a++)Ma(a)},!1),x.appendChild(Of));"setframe"==l&&(kb=t("input"),
ib&&(kb.className="setframe"),kb.type="range",kb.min=1,kb.max=100,kb.value=1,Qe="Frame #*",null!=m&&(kb.title=m),f=e.setframe_label,null!=f&&(Qe=f),ee=t("span"),ee.innerHTML=Qe.replace("*",1),c="display:block;vertical-align:middle;"+e.setframe_style,kb.setAttribute("style",c),c=t("span"),c.setAttribute("style","display:inline-block;vertical-align:top;"),ee.setAttribute("style","display:block;vertical-align:middle;"+e.setframe_label_style),c.appendChild(ee),c.appendChild(kb),x.appendChild(c),kb.addEventListener("input",
function(a){G(!1);a=parseInt(kb.value,10)-1;0<=Sa[a]&&(xa(a),ee.innerHTML=Qe.replace("*",q+1));Y()},!1),Hf=!0);"framelabel"==l&&(Ja=t("button"),ib&&(Ja.className="framelabel"),Ja.innerHTML="",null!=m&&(Ja.title=m),cb=null,f=e.frame_labels,null!=f&&(cb=f.split(","),Ja.innerHTML=cb[0]),c=Cc+e.framelabel_style,null!=c&&Ja.setAttribute("style",c),c=e.framelabel_position,null!=c&&(c=c.split(","),Ja.style.position="absolute",Ja.style.left=z.offsetLeft+parseInt(c[0],10)+"px",Ja.style.top=z.offsetTop+parseInt(c[1],
10)+"px"),x.appendChild(Ja));if("autorefresh"==l||"autorefresh/off"==l)null!=Hc&&clearInterval(Hc),Pc=t("button"),da(Pc,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",m,"autorefresh"),Pc.addEventListener("click",HAniS.toggleAutoRefresh,!1),Ld=!1,x.appendChild(Pc),"autorefresh"==l?HAniS.toggleAutoRefresh():H(Pc,!1,"autotoggle off");"backward"==l&&(sb=t("button"),da(sb,"backward","<","<",m,"step back"),sb.addEventListener("click",function(){G(!1);Cb(-1);Y()},!1),x.appendChild(sb));"forward"==
l&&(tb=t("button"),da(tb,"forward",">",">",m,"step forward"),tb.addEventListener("click",function(){G(!1);Cb(1);Y()},!1),x.appendChild(tb));if("step"==l){c=e.step_labels;var h=null!=c?c.split(","):["<",">"];sb=t("button");ib&&(sb.className="step back");sb.innerHTML=h[0];sb.addEventListener("click",function(){G(!1);Cb(-1);Y()},!1);c=Cc+e.step_style;null!=c&&sb.setAttribute("style",c);null!=m&&(sb.title=m);x.appendChild(sb);tb=t("button");ib&&(tb.className="step forward");tb.innerHTML=h[1];tb.addEventListener("click",
function(){G(!1);Cb(1);Y()},!1);null!=c&&tb.setAttribute("style",c);null!=m&&(tb.title=m);x.appendChild(tb)}"first"==l&&(Hb=t("button"),da(Hb,"first","|<","|<",m,"firstlast first"),Hb.addEventListener("click",function(){G(!1);xa(wa(0));Y()},!1),x.appendChild(Hb));"last"==l&&(Ib=t("button"),da(Ib,"last",">|",">|",m,"firstlast last"),Ib.addEventListener("click",function(){G(!1);xa(wa(u-1));Y()},!1),x.appendChild(Ib));"firstlast"==l&&(c=e.firstlast_labels,h=null!=c?c.split(","):["<<",">>"],Hb=t("button"),
ib&&(Hb.className="firstlast"),Hb.innerHTML=h[0],Hb.addEventListener("click",function(){G(!1);xa(wa(0));Y()},!1),c=Cc+e.firstlast_style,null!=c&&Hb.setAttribute("style",c),null!=m&&(Hb.title=m),x.appendChild(Hb),Ib=t("button"),ib&&(Ib.className="firstlast"),Ib.innerHTML=h[1],Ib.addEventListener("click",function(){G(!1);xa(wa(u-1));Y()},!1),null!=c&&Ib.setAttribute("style",c),null!=m&&(Ib.title=m),x.appendChild(Ib));"setspeed"==l?(Jb=t("input"),ib&&(Jb.className="setspeed"),Jb.type="range",Jb.min=
Zb,Jb.max=Oc,Jb.value=Oc-Aa,null!=m&&(Jb.title=m),c="vertical-align:middle;"+e.setspeed_style,Jb.setAttribute("style",c),Jb.addEventListener("input",function(a){Aa=Oc-parseInt(Jb.value,10)+30;void 0!=xd&&xd(Aa);G(!0);Y()},!1),x.appendChild(Jb)):"speed"==l&&(c=e.speed_labels,h=null!=c?c.split(","):["-","+"],$b=t("button"),ib&&($b.className="speed slower"),$b.innerHTML=h[0],$b.addEventListener("click",function(){Aa+=Bf;ac.disabled=!1;Aa>Oc&&(Aa=Oc,$b.disabled=!0);void 0!=xd&&xd(Aa)},!1),c=Cc+e.speed_style,
null!=c&&$b.setAttribute("style",c),null!=m&&($b.title=m),x.appendChild($b),ac=t("button"),ib&&(ac.className="speed faster"),ac.innerHTML=h[1],ac.addEventListener("click",function(){Aa-=Bf;$b.disabled=!1;Aa<Zb&&(Aa=Zb,ac.disabled=!0);void 0!=xd&&xd(Aa)},!1),null!=c&&ac.setAttribute("style",c),null!=m&&(ac.title=m),x.appendChild(ac));"zoom"==l&&(za=t("button"),da(za,"zoom","Zoom","Un-zoom",m,"zoom off"),za.addEventListener("click",HAniS.toggleZooming,!1),x.appendChild(za),ya=!1);if("annotate"==l){fe=
t("button");da(fe,"annotate","Annotate","Finished",m,"annotate");ka=t("div");ka.setAttribute("style","position:absolute;box-sizing:content-box;height:120px;width:180px;top:20px;left:20px;z-index:15;visibility:hidden;background-color:lightgray;border-width:6px;border-style:solid;border-color:magenta;border-radius:25px;padding:10px;font:normal normal normal 16px Arial;color:black;");ka.title="Drag this box around.  Select attributes, then go onto the image and click & drag";ad=bd=20;Re=Kb=!1;th=3;uh=
11;cd=ge=0;r=[];ka.style["touch-action"]="none";var n=function(a){bd=a.clientX-cd;ad=a.clientY-ge;ka.style.top=ad+"px";ka.style.left=bd+"px"};ka.addEventListener("mousedown",function(a){if(0!=a.clientX||0!=a.clientY)Re=!0,cd=a.clientX-bd,ge=a.clientY-ad},!1);ka.addEventListener("mouseup",function(a){Re=!1},!1);ka.addEventListener("mouseout",function(a){Re&&n(a)},!1);ka.addEventListener("mousemove",function(a){Re&&n(a)},!1);window.PointerEvent?(ka.addEventListener("pointerdown",function(a){"mouse"!=
a.pointerType&&(cd=a.clientX-bd,ge=a.clientY-ad)},!1),ka.addEventListener("pointermove",function(a){"mouse"!=a.pointerType&&(0==cd&&(cd=a.clientX,ge=a.clientY),n(a))},!1)):ka.addEventListener("touchmove",function(a){a=a.changedTouches[0];0==cd&&(cd=a.clientX,ge=a.clientY);n(a)},!1);fe.addEventListener("click",function(){if(Kb=!Kb){r=[];bd=z.offsetLeft;ad=z.offsetTop;var a=e.annotate_position;null!=a&&(a=a.split(","),bd+=parseInt(a[0],10),ad+=parseInt(a[1],10));ka.style.top=ad+"px";ka.style.left=bd+
"px";ka.style.visibility="visible";H(fe,!1,"annotate off");fi=ya;ya=!1;null!=za&&(za.disabled=!0)}else ka.style.visibility="hidden",H(fe,!0,"annotate on"),ya=fi,null!=za&&(za.disabled=!1);Z()},!0);he=vh("Color Black White Red Green Blue Yellow Orange Cyan Magenta".split(" "),"black black white red green blue yellow orange cyan magenta".split(" "),function(a){});Dc=vh("Width 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==
ie.selectedIndex?uh=Dc.selectedIndex:th=Dc.selectedIndex});Dc.title="Select width or font size";ie=vh("Type Arrow Circle Box Polygon Draw Text".split(" "),[-1,0,1,2,3,4,5],function(a){6==ie.selectedIndex?(Lb.focus(),Lb.select(),Dc.selectedIndex=uh):Dc.selectedIndex=th;0==he.selectedIndex&&(he.selectedIndex=2)});c=t("button");c.style.width="70px";c.style.margin="5px";c.innerHTML="Erase";c.title="Erase last item";c.addEventListener("click",function(){0<r.length&&(r.pop(),Z())},!1);Lb=t("input");Lb.type=
"text";Lb.style.width="150px";Lb.style.margin="5px";Lb.title="Enter your text here, then click where you want it";Lb.value="Text input";h=e.annotate_defaults;null!=h&&(h=h.split(","),ie.selectedIndex=parseInt(h[0],10),1<h.length&&(he.selectedIndex=parseInt(h[1],10)),2<h.length&&(Dc.selectedIndex=parseInt(h[2],10)),3<h.length&&(Lb.value=h[3].trim()));h=t("div");h.innerHTML="Annotation Tools";var jb=t("div");jb.appendChild(ie);jb.appendChild(he);var v=t("div");v.appendChild(Dc);v.appendChild(c);c=t("div");
c.appendChild(Lb);ka.appendChild(h);ka.appendChild(jb);ka.appendChild(v);ka.appendChild(c);x.appendChild(fe);z.appendChild(ka)}"saveall"==l&&(Pf=t("button"),da(Pf,"saveall","SaveAll","SaveAll",m,"saveall"),wh=e.saveall_prompt,ic=e.saveall_filename,c=e.saveall_list,xh=null==c?["0"]:c.split(","),Pf.addEventListener("click",function(){for(var a=0;a<xh.length;a++)for(var b=parseInt(xh[a],10),c=0;c<ta.length;c++){0===c&&null!=wh&&(ic=window.prompt(wh,ic),null!=ic&&1>ic.length&&(ic=null));var d=null==ic?
"":-1!=ic.indexOf("#")?ic.replace("#",c.toString()):ic+c;var g=document.createElement("a");g.href=0==b?ta[c]:fa[c][b-1];g.download=d;d=new MouseEvent("click");g.dispatchEvent(d)}},!1),x.appendChild(Pf));if("capture"==l){Qf=t("button");da(Qf,"capture","Capture","Capture",m,"capture");var p=e.capture_prompt;Rf=e.capture_filename;null==Rf&&(Rf="haimage.png");Qf.addEventListener("click",function(){var a=Rf;if(null!=p&&(a=window.prompt(p,a),null==a))return;var b=t("canvas");b.height=ob.height;b.width=
ob.width;var c=b.getContext("2d");de=!1;Z();c.drawImage(ob,0,0);c.drawImage(sc,0,0);de=!0;b.toBlob(function(b){var c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;d.download=a;c=new MouseEvent("click");d.dispatchEvent(c);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);x.appendChild(Qf)}"show"==l&&(Sf=t("button"),da(Sf,"show","Show","Show",m,"show"),Tf=e.show_prompt,gi=e.show_image_file,null==Tf&&(Tf="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),
Sf.addEventListener("click",function(){if(gi)window.open(ta[q]);else{var a=ob.toDataURL("image/png;base64;");var b=window.open();b.document.write(Tf+"<img src="+a+"></img>")}},!1),x.appendChild(Sf));"toggle"==l&&(Sa=[],c=e.toggle_size,null!=c?(c=c.split(","),yd=parseInt(c[0],10),Se=parseInt(c[1],10),Te=parseInt(c[2],10)):(Se=yd=10,Te=3),yh="red",zh="blue",Ah="orange",Bh=!1,D(e.toggle_layout_width,"t")&&(Bh=!0),c=e.toggle_colors,null!=c&&(c=c.split(","),zh=c[0].trim(),yh=c[1].trim(),Ah=c[2].trim()),
yb=t("div"),yb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),yb.style.backgroundColor=x.style.backgroundColor,yb.align=Jd,Ch=new PEvs(yb,null,null,null,null,HAniS.togclick,null),dd=t("canvas"),dd.height=2*Se,Uf=dd.getContext("2d"),yb.appendChild(dd),a?z.insertBefore(yb,Pa):z.appendChild(yb),c=e.toggle_onoff,Ue=null,null!=c&&(Ue=c.split(",")),
Vf=!0,null!=m&&(yb.title=m));if("overlay"==l||D(l,"menu")){0==Ka&&(F=[]);h=e.overlay_tooltip;c=null;null!=h&&(c=h.split(","));h=e.overlay_radio;jb=null;null!=h&&(jb=h.split(","));var A=e.overlay_menu_links;v=null;null!=A&&(v=A.split(","));var y=e.overlay_labels_color;A=null;null!=y&&(A=y.split(","));y=Vc=!1;D(l,"menu")&&(Vc=!0,0<l.indexOf("/on")&&(y=!0));0==Ka&&(ae=[]);var w=e.overlay_caching;l=null;null==w&&(w=e.overlay_static);null!=w&&(l=w.split(","));var E=!0;null!=e.overlay_nonewdiv&&(E=!1);
Ka++;for(w=0;w<Wb.length;w++){var L=Wb[w].trim();if(0==w||0==L.indexOf("/"))0==L.indexOf("/")&&(L=L.substr(1)),Vc?(Mb[Ka]=t("div"),Mb[Ka].setAttribute("style","text-align:left;display:block;position:absolute;border-style:solid;border-width:2px;background:#ffffff;z-index:999;visibility:"+(y?"visible":"hidden")+";"+e.overlay_labels_style),Wf++):E?(Nb=t("div"),Wf++,Nb.align="center",a?z.insertBefore(Nb,Pa):z.appendChild(Nb)):(Nb=t("span"),x.appendChild(Nb)),f=e.overlay_labels_style,Vc||null==f||Nb.setAttribute("style",
f);if(null==v||null!=v&&v[w]==Ka){var B=!1;f=L.length;0<L.indexOf("/on")&&L.indexOf("/on")==f-3&&(B=!0,L=L.substr(0,f-3));var C=!1;0<L.indexOf("/always")&&L.indexOf("/always")==f-7&&(C=B=!0);var K=!1;0<L.indexOf("/hidden")&&(K=!0);var J=!1;0<L.indexOf("/hotspots")&&(J=!0,L=L.substr(0,L.indexOf("/")));null!=l?D(l[w],"y")||D(l[w],"t")?ae[w]=!0:ae[w]=!1:ae[w]=!0;F[w]=t("input");F[w].type="checkbox";F[w].value=L;F[w].id=L;F[w].showMe=!(C&K)&!J;var M="vertical-align:middle;";f=e.checkbox_style;null!=f&&
(M+=f);F[w].setAttribute("style",M);F[w].checked=B;F[w].restorableState=B;F[w].name=0;F[w].hotspotIndex=J;null!=Ba&&w==pb&&F[w].checked&&(Ba.disabled=!1);null!=uc&&!uc[w]&&B&&(id=!1);F[w].addEventListener("click",HAniS.overClick,!1);null!=h&&(f=jb[w].indexOf("/"),-1!=f&&(F[w].name=jb[w].substr(f+1).trim()),D(jb[w],"t")&&(F[w].type="radio",-1==f&&(F[w].name="all")));F[w].isGhost=!0;C||K||(null!=c&&(F[w].title=c[w]),C=t("label"),C.htmlFor=L,null!=c&&(C.title=c[w]),C.innerHTML=L,C.name=F[w].name,L="vertical-align:middle;",
null!=A&&(L=L+"color:"+A[w]+";"),C.setAttribute("style",L),L=t("span"),L.appendChild(F[w]),L.appendChild(C),Vc?(L.setAttribute("style","display:block;margin-right:5px;"),Mb[Ka].appendChild(L)):(C="10",null!=ye&&(C=10+ye[w]),L.setAttribute("style","margin-left:"+C+"px;"),Nb.appendChild(L)),F[w].isGhost=!1)}}Vc&&(ed[Ka]=t("button"),da(ed[Ka],"menu"+Ka,"Show Overlay Menu","Hide Menu",m,"menu off"),ed[Ka].menuInx=Ka,ed[Ka].addEventListener("click",function(a){if("hidden"===Mb[this.menuInx].style.visibility){for(a=
1;a<Mb.length;a++)"visible"==Mb[a].style.visibility&&(Mb[ed[a].menuInx].style.visibility="hidden",H(ed[a],!0,"menu off"));Mb[this.menuInx].style.visibility="visible";H(this,!1,"menu on")}else Mb[this.menuInx].style.visibility="hidden",H(this,!0,"menu off")},!1),x.appendChild(ed[Ka]),z.insertBefore(Mb[Ka],Pa));if(null==Xb)for(Xb=Array(Wb.length),w=0;w<Wb.length;w++)Xb[w]=0;else for(w=0;w<Wb.length;w++)Ma(w)}}Ta=!0;Pe=null;f=e.start_looping;null!=f&&(c=f.split(","),D(c[0],"f")&&(Ta=!1),1<c.length&&
(Bc=parseInt(c[1],10)-1,isNaN(Bc)&&(Bc=0),q=Bc),2<c.length&&(D(c[2],"t")&&(Pe=!0),D(c[2],"f")&&(Pe=!1)));G(Ta)}function Ma(b){var a;if(0>Xb[b]){var d=!1;for(a=0;a<Wb.length;a++)Xb[a]!=-Xb[b]||d||(d=F[a].checked);F[b].checked=d}}function Pb(b){0==mb&&(nb=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var a=b[4].trim(),d=b[4].indexOf("/"),c=b[4].indexOf("?"),g=-1,k=-1;-1!=d&&(g=parseInt(b[4].substring(d+1),10)-1,a=a.substring(0,d));-1!=c&&(k=parseInt(b[4].substring(c+1),10)-1,c<d||-1==d)&&(a=a.substring(0,
c));nb[mb]=new Bb(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),a.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),g,k,8==b.length?b[7].trim():null);mb+=1}function Fc(b){0==Ne&&(Ra=[],pa=null);var a=b.substr(b.indexOf("=")+1).trim().split("(");b=a[0].split(",");var d=b[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));Ra[Ne]=new Na(d,b[1].trim(),b[2].trim(),b[3].trim(),a[1].trim());Ne+=1}function gd(b){0==vb&&(Ga=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");
Ga[vb]=new pc(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");vb+=1}function Na(b,a,d,c,g){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=a;this.value=d;this.tip=c;this.poly=g;b=g.split(",");this.xy=[];this.ymin=this.xmin=9999;for(a=this.ymax=this.xmax=0;a<b.length;a++)this.xy[a]=parseInt(b[a].trim(),10),0==
a%2?(this.xy[a]<this.xmin&&(this.xmin=this.xy[a]),this.xy[a]>this.xmax&&(this.xmax=this.xy[a])):(this.xy[a]<this.ymin&&(this.ymin=this.xy[a]),this.xy[a]>this.ymax&&(this.ymax=this.xy[a]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=t("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-
this.xmin,this.xy[1]-this.ymin);for(a=2;a<this.xy.length;a+=2)this.ctx.lineTo(this.xy[a]-this.xmin,this.xy[a+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function pc(b,a,d,c,g){this.overlay=b;this.color=a;this.action=d;this.value=c;this.tip=g}function Bb(b,a,d,c,g,k,e,f,h,n){this.x0=b;this.y0=a;this.icon=null;this.isIcon=!1;if("icon"==d)this.icon=new Image,this.icon.hotspot=this,Xf=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+
this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.zoomme=this.fromfile=this.anim=!1,this.icon.gotit=!1,this.icon.src=c.trim();else if("sprite"==d||"spritefn"===d){this.x0=b;this.y0=a;this.inx=parseInt(c,10)-1;je=!1;xg?null!=ja&&(-1!=Tc?this.inx>=Tc&&this.inx<=Tc+ja.length&&(je=!0):"spritefn"===d&&(je=!0)):je=!0;if(je){-1!=Tc&&
(this.inx-=Tc);if(this.inx>=ja.length)return null;this.x1=ja[this.inx].width+b;this.y1=ja[this.inx].height+a;this.width=ja[this.inx].width;this.height=ja[this.inx].height;this.w2=this.width/2;this.h2=this.height/2;this.origY=this.origX=0;this.icon=ja[this.inx].cloneNode();this.anim=ja[this.inx].anim;this.fromfile=ja[this.inx].fromfile;this.zoomme=ja[this.inx].zoomme;this.anim&&(this.icon.setAttribute("style","position:absolute;top:0px;left:0px;visibility:hidden;"),yc.appendChild(this.icon))}else this.x1=
Ub[this.inx]+b,this.y1=Vb[this.inx]+a,this.width=Ub[this.inx],this.height=Vb[this.inx],this.w2=Ub[this.inx]/2,this.h2=Vb[this.inx]/2,this.origX=qf[this.inx],this.origY=rf[this.inx],this.icon=pf,this.zoomme=this.fromfile=this.anim=!1;Xf=this.isIcon=!0;this.icon.gotit=!0}else this.width=parseInt(d,10),this.height=parseInt(c,10),this.x1=this.width+b,this.y1=this.height+a,this.w2=this.width/2,this.h2=this.height/2;this.pan=g;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=k;this.value=e;this.overlay=
f;this.frame=h;this.tip=n}function Xa(){if(zd&&!od){V=-1;for(var b=0;b<ma.length;b++)B>=ma[b]&&(V=b)}}function Qb(){null!=cc?db=cc.toLatLon(qa,ra):null!=Ff?(db[0]=Ff+($h-Ff)*ra/ia,db[1]=nh+(ai-nh)*qa/na):(db[0]=Math.round(qa),db[1]=Math.round(ra))}function Rb(b,a){"popup"==b.action?(null!=Yf&&Yf.close(),Yf=window.open("","HAniSPopup","scrollbars=yes,width="+ah+",height="+$g),Yf.document.write(Zg+b.value+"</div>")):"link"==b.action?(b=b.value,Qb(),b=b.replace("%LATITUDE%",db[0].toFixed(4)),b=b.replace("%LONGITUDE%",
db[1].toFixed(4)),b=b.replace("%FRAMENUMBER%",q+1),window.open(b,"_blank","")):"fof"==b.action&&(ea=Og,HAniS.resetZoom(),HAniS.newFOF(b.value,!0),ff(a))}function Fd(){var b=Vg?Sd/B:0;N+b<Sd&&(N=Sd-b);b=Xg?Td/B:0;N+bb-b>na-Td&&(N=na-bb+b-Td);b=Tg?Rd/C:0;R+b<Rd&&(R=Rd-b);b=Rg?Qd/C:0;R+ab-b>ia-Qd&&(R=ia-ab-Qd+b);R=Math.round(R);N=Math.round(N)}function Gd(b){var a=!1;b?od?(V--,0>V?a=!0:(B=ma[V],C=ma[V])):(B-=.1*nd/A,C-=.1*nd/E):od?(V++,V>=ma.length?(V--,Af&&(a=!0)):(B=ma[V],C=ma[V])):(!Af||B!==Nc&&C!==
Nc||(a=!0),B+=.1*nd/A,C+=.1*nd/E,B>Nc&&(B=Nc),C>Nc&&(C=Nc));a||B<=Oe||C<=Ve?(B=Oe,C=Ve,V=-1,qa=y,ra=p,R=N=0,ab=ia,bb=na,Sd=Td=Rd=Qd=0,sd&&(lb=!0)):(Qd=Qg,Rd=Sg,Td=Wg,Sd=Ug,N=qa-y/B,R=ra-p/C,ab=Math.floor(ia/C),bb=Math.floor(na/B),Fd(),sd&&(lb=!1));Xa()}function Sb(){We=0;Ob=Array(2);zb=Array(2);Ad=Array(2);Ua=0;ld=null;xa(wa(0))}function G(b){Da=!b;HAniS.toggleIsLooping()}function Hd(b,a,d,c,g,k){Yd.clearRect(0,0,U,aa);Yd.imageSmoothingEnabled=Md;M.imageSmoothingEnabled=Md;Yd.drawImage(b,a,d,c,g,
0,0,U,aa);Dh=Yd.getImageData(0,0,U,aa);fd=Dh.data;Zf=Ya[k];$f=Za[k];ag=$a[k];bg=Wd[k];hi=4*U*aa;for(jc=0;jc<hi;jc+=4)eb=fd[jc],eb===fd[jc+1]&&eb===fd[jc+2]&&(fd[jc]=Zf[eb],fd[jc+1]=$f[eb],fd[jc+2]=ag[eb],fd[jc+3]=bg[eb]);Yd.putImageData(Dh,0,0);M.drawImage(He,0,0,U,aa)}function H(b,a,d){null!=b&&(a?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&b.setAttribute("style",b.style_off),b.innerHTML=b.label_off),ib&&(b.className=d))}function hb(b,a){if(!(b>=
u)&&(-2==Sa[b]&&(a=-2),Sa[b]=a,Hf&&1==a&&(kb.value=b+1,ee.innerHTML=Qe.replace("*",b+1)),Vf)){b=Eh+b*(yd+Te);var d=Ah;0==a?d=zh:-1==a?d=yh:-2==a&&(d=zg);Uf.fillStyle=d;Uf.fillRect(b,Se/2,yd,Se)}}function qe(b,a){Vf&&(dd.width=Bh?parseInt(z.style.width,10):U,Uf.clearRect(0,0,dd.width,dd.height),Eh=dd.width/2-b*(yd+Te)/2);for(var d=0;d<b;d++)a?-1!=Nd?hb(d,-2):null!=Ue&&"n"==Ue[d].toLowerCase().trim()?hb(d,-1):hb(d,0):hb(d,Sa[d])}function xa(b){hb(q,0);q=b;hb(q,1);null!=Ja&&null!=cb&&null!=cb[q]&&(Ja.innerHTML=
cb[q]);void 0!=Xe&&Xe(q)}function wa(b){b>=u&&(b=u-1);if(0<=Sa[b])return b;var a=-1,d=b;0==d&&(a=1);for(var c=0;c<u-1;c++)if(d+=a,0<=Sa[d])return d;return b}function Cb(b){hb(q,0);var a=b;do 0<a?(a=wa(u-1),q+=1,q>a&&(ke&&Da?(q=a,b=-b,wb&&G(!1)):wb?(q=a,G(!1)):q=wa(0))):(a=wa(0),--q,q<a&&(ke&&Da?(q=a,b=-b,wb&&G(!1)):wb?(q=a,G(!1)):q=wa(u-1))),a=b;while(0>Sa[q]);wb=Ye;void 0!=Xe&&Xe(q);Nf=a;hb(q,1);null!=Ja&&null!=cb&&null!=cb[q]&&(Ja.innerHTML=cb[q])}function gb(b,a,d,c,g,k,e){this.bg=b;null!=b&&0==
this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=a;null!=a&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=c;null!=c&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=g;this.sxoff=k;this.syoff=e}function Oa(b,a,d,c,g){f.globalAlpha=1;f.font=b.font;var k=b.fontHeight;d=d-k-6;var e=f.measureText(c).width;1==g&&(a-=e);0==g&&(a-=e/2);5>a&&(a=5);5>d&&(d=5);d+k+3>aa&&
(d=aa-k-6);a+3+e>U&&(a=U-e-6);f.save();f.beginPath();f.fillStyle=b.bg;null!=b.scolor&&(f.shadowColor=b.scolor,f.shadowBlur=b.sblur,f.shadowOffsetX=b.sxoff,f.shadowOffsetY=b.syoff);Ze=a-3;cg=d;Fh=e+6;dg=k+6;f.fillRect(Ze,cg,Fh,dg);f.closePath();f.restore();f.textBaseline="bottom";f.fillStyle=b.fg;f.fillText(c,a,d+k+3)}function Z(){f.clearRect(0,0,U,aa);eg=!1;if(fb){f.beginPath();f.lineWidth=2;f.strokeStyle="white";var b=Ua;1<b&&(b=2);for(var a=0;a<b;a++)1<Ua&&(f.moveTo(Ob[0]/A,zb[0]/E),f.lineTo(Ob[1]/
A,zb[1]/E)),f.moveTo(Ob[a]/A-15,zb[a]/E),f.lineTo(Ob[a]/A+15,zb[a]/E),f.moveTo(Ob[a]/A,zb[a]/E-15),f.lineTo(Ob[a]/A,zb[a]/E+15);f.closePath();f.stroke();if(3==Ua){var d=W,c=S;f.moveTo(d,c);f.fillStyle=vc;f.fillRect(d-2,c-2,5,5);b=Bd;a=Math.round(d+$e/A*le*(Bd-Ad[1]));for(var g=Math.round(c+me/E*le*(Bd-Ad[1])),e=0;300>e;e++){f.beginPath();f.lineWidth=1;f.strokeStyle=vc;f.moveTo(d,c);f.lineTo(a,g);f.stroke();f.beginPath();f.lineWidth=3;f.rect(a-2,g-2,5,5);f.stroke();if(3>a||a+3>U||3>g||g+3>aa)break;
c=dc+b;c=100*Math.floor(c/60)+c%60;c%=2400;Jg?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=0;Math.abs(fg)<kd+5&&(c=45*.0174533);var h=g;0>Gh*fg&&0==c&&(h=g+kd);f.font=Pd;d=d+" "+Ig;var l=f.measureText(d).width;f.fillStyle=Od;0===c?(f.fillRect(a+2,h-kd-2+c,l+4,kd+3),f.fillStyle=vc,f.textBaseline="bottom",f.fillText(d,a+5,h)):(f.save(),f.translate(a+
5,g),f.rotate(c),f.fillRect(2,-2,l+4,kd+3),f.fillStyle=vc,f.textBaseline="bottom",f.fillText(d,5,kd),f.restore());d=a;c=g;a=Math.round(d+le*Gh);g=Math.round(c+le*fg);b+=X}}null!=ld&&Oa(wf,ii,ji,ld,0);de&&(Oa(Vh,9999,gh,fh[We],0),Hh=Ze,Ih=cg,Jh=cg+dg)}if(xb){de&&(0==wd?Oa(sh,9999,10,De[0],0):(Oa(ei,10,10,De[1],0),ki=Ze+Fh,Oa(sh,9999,10,De[2],0)),li=Ze,mi=dg);f.beginPath();f.lineWidth=2;f.strokeStyle=hh;for(b=0;b<oa.length;b+=2)0==b?f.moveTo(oa[b]/A,oa[b+1]/E):f.lineTo(oa[b]/A,oa[b+1]/E);Ee&4<oa.length&&
f.lineTo(oa[0]/A,oa[1]/E);f.stroke();for(b=0;b<oa.length;b+=2)f.beginPath(),f.rect(oa[b]/A-2,oa[b+1]/E-2,5,5),f.stroke()}if(Kb)for(b=0;b<r.length;b++){a=r[b].type;f.beginPath();f.strokeStyle=r[b].color;f.lineWidth=r[b].width;if("0"==a)a=Math.atan2(r[b].xe-r[b].x,r[b].ye-r[b].y),g=r[b].x+r[b].width*Math.sin(a),e=r[b].y+r[b].width*Math.cos(a),f.beginPath(),f.moveTo(g,e),f.lineTo(r[b].xe,r[b].ye),d=12+r[b].width/5,f.moveTo(g+d*Math.sin(a-.523599),e+d*Math.cos(a-.523599)),f.lineTo(g,e),f.lineTo(g+d*Math.sin(a+
.523599),e+d*Math.cos(a+.523599));else if("1"==a)f.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==a)f.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);else if("3"==a){f.moveTo(r[b].xp[0],r[b].yp[0]);for(g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],r[b].yp[g]);f.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==a)for(f.moveTo(r[b].xp[0],r[b].yp[0]),g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],r[b].yp[g]);else"5"==a&&(f.fillStyle=r[b].color,f.font=r[b].width+"pt arial",a=f.measureText(r[b].text).width,
f.fillText(r[b].text,r[b].x-a/2,r[b].y+r[b].width/2));f.stroke()}Zc&&(b=Gc*(af-ne)/B,a=te*(bf-oe)/C,b=" "+Math.sqrt(b*b+a*a).toFixed(sg)+" "+rg+" ",Oa(Th,ne/A,oe/E,b,-1),f.beginPath(),f.strokeStyle=tg,f.lineWidth=3,f.moveTo(af/A,bf/E),f.lineTo(ne/A,oe/E),f.stroke(),f.closePath());Gb&&Oa(Ng,Kh,Lh,Mh,-1);if(Tb||ud)if(W=la.getX(),y=W*A,S=la.getY(),p=S*E,0<=y&&0<=p){qa=N+y/B;ra=R+p/C;if(ud){Qb();ni=og+db[0].toFixed(kf)+"  "+pg+db[1].toFixed(kf);b=S;if(Zc||Gb)b=S+qg.fontHeight+6;Oa(qg,W+10,b,ni,-1)}if(Tb&&
Qc&&Yc)if(qa=Math.round(qa),ra=Math.round(ra),nf)Va.clearRect(0,0,1,1),Va.drawImage(Ha[q],qa,ra,1,1,0,0,1,1),T=Va.getImageData(0,0,1,1).data,O=0,Id(!1);else for(b=0;b<ca;b++)if(a=ca-b-1,K[q][a].gotit&&F[a].checked&&(a==pb||null!=tc[a]&&0<=tc[a])){Va.clearRect(0,0,1,1);a==pb?Va.drawImage(ec[q],qa,ra,1,1,0,0,1,1):Va.drawImage(K[q][a],qa,ra,1,1,0,0,1,1);T=Va.getImageData(0,0,1,1).data;O=tc[a];null!=O&&Id(a==pb||lh);break}}!lb||fb||rc||Tb||null==pa||(f.drawImage(pa.can,0,0,pa.width,pa.height,pa.xmin/
A,pa.ymin/E,pa.width/A,pa.height/E),Oa(Ng,(pa.xmin+pa.xmax)/2/A,(pa.ymin+pa.ymax)/2/E,pa.tip,0),eg=!0)}function Id(b){cf=999;kc=ug;var a=ub[O].length-1;if(0==T[3])kc=Ge[O];else{if(vg)lc=T[0];else if(b)gg=0,lc=T[0],cf=0;else for(var d=0;d<a;d++)mc[0]=T[0]-Ya[O][d],0>mc[0]*(Ya[O][d+1]-T[0]-1)||(mc[1]=T[1]-Za[O][d],0>mc[1]*(Za[O][d+1]-T[1]-1)||(mc[2]=T[2]-$a[O][d],0>mc[2]*($a[O][d+1]-T[2]-1)||(Cd=Ef[O][d],hg=mc[Cd]/Uc[O][d][Cd],Nh=Math.abs(mc[Oh[Cd]]-hg*Uc[O][d][Oh[Cd]])+Math.abs(mc[Ph[Cd]]-hg*Uc[O][d][Ph[Cd]]),
Nh<cf&&(lc=d,cf=Nh,gg=hg))));if(999>cf)kc=Sc[O][lc],-1!=bc[O][lc]&&(Qh=ub[O][lc],0!=gg&&(Qh+=gg*(ub[O][lc+1]-ub[O][lc])),kc=kc+" "+Qh.toFixed(bc[O][lc])+" "+Rc[O][lc]);else if(b||0<Kd){var c=-1;if(b)c=T[0];else for(d=0;d<a;d++)if(Math.abs(T[0]-Ya[O][d])<Kd&&Math.abs(T[1]-Za[O][d])<Kd&&Math.abs(T[2]-$a[O][d])<Kd){c=d;break}-1!=c&&(kc=Sc[O][c],-1!=bc[O][c]&&(kc=kc+" "+ub[O][c].toFixed(bc[O][c])+" "+Rc[O][c]))}}"hide"!=kc&&Oa(Uh,W-10,S,kc,1)}function Y(){if(Yc)try{M.clearRect(0,0,U,aa);M.globalAlpha=
1;if(!Yg)if(zd&&null!=fc&&0<=V&&fc[V].gotit)M.drawImage(fc[V],N*ma[V],R*ma[V],bb*ma[V],ab*ma[V],0,0,U,aa);else if(Ha[q].gotit&&(null!=sf?Hd(Ha[q],N,R,bb,ab,sf):M.drawImage(Ha[q],N,R,bb,ab,0,0,U,aa)),null!=Fa&&(M.globalAlpha=1,Ha[q].gotit))for(var b=0;b<Fa.length;b+=4)M.drawImage(Ha[q],Fa[b],Fa[b+1],Fa[b+2],Fa[b+3],Fa[b]/A,Fa[b+1]/E,Fa[b+2]/A,Fa[b+3]/E);if(0<ca){for(b=0;b<ca;b++){var a=null!=Kc?Kc[b]:b;!uf[a]&&F[a].checked&&F[a].showMe&&(null!=ze&&(M.globalAlpha=ze[a]),zd&&0<=V&&null!=ua&&void 0!=
ua[a]&&ua[a][V][q].gotit?M.drawImage(ua[a][V][q],N*ma[V],R*ma[V],bb*ma[V],ab*ma[V],0,0,U,aa):K[q][a].gotit&&(null==Lc||1===Lc[a]?null!=Ic&&0<=Ic[a]?Hd(K[q][a],N,R,bb,ab,Ic[a]):M.drawImage(K[q][a],N,R,bb,ab,0,0,U,aa):0===Lc[a]&&M.drawImage(K[q][a],0,0,na,ia,0,0,U,aa)))}if(null!=qb)for(M.globalAlpha=1,b=0;b<ca;b++)if(a=null!=Kc?Kc[b]:b,K[q][a].gotit&&(Hg[a]||F[a].checked)&&qb[a])for(var d=0;d<ba[a].length;d++)M.drawImage(null!=K[q][a].origImage?K[q][a].origImage:K[q][a],ba[a][d][0],ba[a][d][1],ba[a][d][2],
ba[a][d][3],ba[a][d][4]/A,ba[a][d][5]/E,ba[a][d][2]/A,ba[a][d][3]/E)}Tb&&Z();rh&&n();if(Xf)for(M.globalAlpha=1,a=0;a<mb;a++)if(null!=nb[a]){var c=nb[a];null!=c.icon&&(c.icon.style.visibility="hidden");if((-1==c.frame||c.frame==q)&&null!=c.icon&&c.icon.gotit&&(-1==c.overlay||-1!=c.overlay&&F[c.overlay].checked)){if(c.isPan){c.zoomme&&(c.icon.style.width=Math.round(c.width*B)+"px",c.icon.style.height=Math.round(c.height*C)+"px",c.w2=Math.round(c.width*B/2),c.h2=Math.round(c.height*C/2));var g=Math.round(((c.x0-
N)*B-c.w2)/A);var e=Math.round(((c.y0-R)*C-c.h2)/E);if(c.anim){if(0>=g+c.icon.width||g>=na||0>=e+c.icon.height||e>=ia)continue;c.icon.style.top=e+"px";c.icon.style.left=g+"px"}else M.drawImage(c.icon,c.origX,c.origY,c.width,c.height,g,e,c.width/A,c.height/E)}else M.drawImage(c.icon,c.origX,c.origY,c.width,c.height,c.x0/A,c.y0/E,c.width/A,c.height/E);c.icon.style.visibility="visible"}}}catch(m){ha("Error:"+m)}}function sa(b,a,d){!Ce||d>=a||(M.save(),M.fillStyle="blue",M.strokeStyle="white",M.lineWidth=
3,M.strokeRect(Ie,Je,200,18),M.fillRect(Ie,Je,d/a*200,18),a=M.measureText(b).width,M.fillStyle="orange",M.font="14px arial",M.fillText(b,Ie+100-a/2,Je+14),M.restore())}function n(){Ce&&Fb>Ca?sa("Loading Images",Fb,Ca):(rh=!1,jf&&(qc.style.visibility="hidden"));Ca>=Fb&&!Da&&xa(wa(q));void 0!=Le&&Ca>=Fb&&Le(!0)}function ha(b){if(re&&hf&&!hf.closed)try{hf.document.write(b+"<br>")}catch(a){}}function di(){Da&&Cb(Nf);oi=q==wa(u-1)?wg+Aa:Aa;Y();setTimeout(function(){ui(di)},oi)}function df(b){for(;-180>
b;)b+=360;for(;180<b;)b-=360;return b}function si(){var b,a,d,c,g,e,f,h,n=Math.PI/180;this.init=function(c){for(var d=[],k=1;k<c.length;k++)d[k]=parseFloat(c[k]);a=d[1];b=d[4]/d[5];g=d[6];e=d[7];c=this.toXY(d[2],d[3]);g=c[0];e=c[1]};this.toXY=function(k,f){d=b*df(f-a)*n-g;c=-b*k*n-e;return[d,c]};this.toLatLon=function(c,d){f=-(d+e)/b/n;h=df((c+g)/b/n+a);return[f,h]}}function ri(){var b,a,d,c,g,e,f,h,n,t,r,u,v,q,z,A,w,C,L,y,p,F,D,E,B,x,G,H,K,J,M,I=Math.PI/180;this.init=function(c){for(var d=[],g=1;g<
c.length;g++)d[g]=parseFloat(c[g]);b=d[1];a=d[2];y=0==d[8]?!1:!0;p=d[6];F=p*p;D=F*F;E=D*F;B=D*D;f=d[5]/d[7];M=d[7];y?(h=Math.cos(I*b),n=Math.sin(I*b)):(h=Math.cos(-b*I),n=Math.sin(-b*I));w=h/Math.sqrt(1-F*n*n);L=(1-p*n)/(1+p*n);A=y?Math.tan(Math.PI/4-b*I/2)/Math.pow(L,p/2):Math.tan(Math.PI/4- -b*I/2)/Math.pow(L,p/2);q=d[9];z=d[10];c=this.toXY(d[3],d[4]);q=c[0];z=c[1]};this.toXY=function(k,h){y?(g=I*k,e=I*(h-a)):(g=I*-k,e=I*(a-h));L=(1-p*Math.sin(g))/(1+p*Math.sin(g));C=Math.tan(Math.PI/4-g/2)/Math.pow(L,
p/2);x=90!=b&&-90!=b?f*w*C/A:2*f*M*C/Math.sqrt(Math.pow(1+p,1+p)*Math.pow(1-p,1-p));d=x*Math.sin(e);c=x*Math.cos(e);y||(d=-d,c=-c);t=d-q;r=c-z;return[t,r]};this.toLatLon=function(e,k){d=e+q;c=k+z;x=Math.sqrt(d*d+c*c);C=90==b||-90==b?x*Math.sqrt(Math.pow(1+p,1+p)*Math.pow(1-p,1-p))/(2*f*M):x*A/(f*w);G=Math.PI/2-2*Math.atan(C);H=Math.sin(2*G);K=Math.sin(4*G);J=Math.sin(6*G);g=G+H*F/2+5*H*D/24+H*E/12+13*H*B/360+7*K*D/48+29*K*E/240+811*K*B/11520+7*J*E/120+81*J*B/1120+4279*Math.sin(8*G)*B/161280;y?(u=
g/I,v=Math.atan2(d,c)/I+a):(u=-g/I,v=-Math.atan2(-d,-c)/I+a);return[u,df(v)]}}function ti(){var b,a,d,c,g,e,f,h,n,t,r,u,p,v,q,z,w,y,L,C,A,F,D,x,B,E,G,H,I,K,J,M,P,O,Q,N=Math.PI/180;this.init=function(c){for(var g=[],e=1;e<c.length;e++)g[e]=parseFloat(c[e]);b=g[1];a=g[2];d=g[3];x=g[7];B=x*x;E=B*B;G=E*B;H=E*E;h=g[6]/g[8];n=Math.cos(N*b);t=Math.cos(N*a);u=Math.sin(b*N);r=Math.sin(a*N);A=n/Math.sqrt(1-B*u*u);F=t/Math.sqrt(1-B*r*r);L=Math.sqrt((1-u)/(1+u)*Math.pow((1+x*u)/(1-x*u),x));C=Math.sqrt((1-r)/
(1+r)*Math.pow((1+x*r)/(1-x*r),x));J=(Math.log(A)-Math.log(F))/(Math.log(L)-Math.log(C));M=A/(J*Math.pow(L,J));O=h*M*Math.pow(L,J);w=g[9];y=g[10];c=this.toXY(g[4],g[5]);w=c[0];y=c[1]};this.toXY=function(a,b){e=N*a;f=N*df(b-d);Q=Math.sin(e);D=Math.sqrt((1-Q)/(1+Q)*Math.pow((1+x*Q)/(1-x*Q),x));K=h*M*Math.pow(D,J);P=J*f;c=K*Math.sin(P);g=O+K*Math.cos(P);p=c-w;v=g-y;return[p,v]};this.toLatLon=function(a,b){c=a+w;g=b+y;K=Math.abs(J)/J*Math.sqrt(c*c+(O-g)*(O-g));D=Math.pow(K/(h*M),1/J);I=Math.PI/2-2*Math.atan(D);
P=0>J?Math.atan(-c/(g-O)):Math.atan(c/(O-g));f=P/J;e=I+(B/2+5/24*E+G/12+13/360*H)*Math.sin(2*I)+(7/48*E+29/240*G+811/11520*H)*Math.sin(6*I)+(7/120*G+81/1120*H)*Math.sin(6*I)+4279/161280*H*Math.sin(8*I);q=e/N;z=df(d-f/N);return[q,z]}}var yg,aa,U,ia,na,A,E,ih,jh,Hb,Ib,qc,jf,la,re,Yf,hf,Cc,ig,tf=!1,z,x,Lf,Mf,Pa,yc,qd,ob,M,Va,sc,f,Xd,Kf,Mc,xf,Be,qh,yf,zc,u,ta,bh,Mb,Vc,Ka,ed,ca,uf,Wb,Kc,fa,Ac,Xb,md,ea,Og,Ha,K,F,ze,ae,Gb,Mh,Kh,Lh,jd,Db,Ag,P,Bg,jg,Rh,W,S,y,p,qa,ra,bb,ab,N,R,de,ib,Bc,ci,Da,Ta,Pe,q,Xe,Nf,
ke,xc,pd=!0,xe,kg,se,e,Aa,Zb,Oc,xd,Le,Bf,wg,oi,Md,Ba,rd,Jc,pb,Qa,ec,Wc,$d,If,Me,sf,He,Yd,Dh,fd,eb,Zf,$f,ag,bg,hi,jc,Ic,Sa,yd,Se,Te,Bh,yb,Eh,Ch,yh,zh,Ah,Nd,zg,nb,mb,Xf,zf,Df,ja,Tc,je,oh,vb,Ga,T,lg,Ra,Ne,lb,sd,Jf,Zd,pa,eg,uc,id,ma,V,fc,Xc,ua,Ia,zd,cb,Ja,Ec,Vf,Ue,dd,Uf,Yc,hd,Eb,tb,sb,Jb,ac,$b,ye,$c,xb,wd,De,Cf,Ee,hh,oa,ei,sh,li,ki,mi,gc,fb,Ua,Ob,zb,Ad,Hh,fh,Ih,Jh,gh,Vh,rb,le,$e,me,Sh,Vd,Gf,Gh,fg,Bd,X,We,dc,Ae,Ig,vc,Od,Pd,kd,Jg,Kg,gi,Sf,Tf,Qf,Rf,fe,r,Pf,wh,ic,xh,ka,Kb,cd,ge,bd,ad,Re,fi,ie,he,Dc,Lb,th,
uh,za,Pg,nd,B,C,Oe,Ve,eh,wc,Ud,dh,ch,ya,Nc,od,ef,Af,Cg=!1,Dg,Eg,Fg,vf,Gg,wb,Ye,be,ce,kb,Qe,ee,Hf,hc,rc,af,bf,sg,ue,Ze,cg,Fh,dg,ph=!0,Ke,ng,ne,oe,Th,tg,mf,Ea,lf,ve,Zc,Gc,te,rg,Ng,td,ud,kf,og,pg,qg,cc,db,ni,Ff,nh,$h,ai,Fa,Nb,Wf,Lc,qb,ba,Hg,Of,Fe,Pc,Zg,ah,$g,tc,Tb,vd,we,Qc,Rc,Sc,bc,Cd,cf,Uh,ug,Kd,vg,nf,wf,Lg,Mg,ld,ii,ji,lc,gg,hg,Oh,Ph,mc,O,Nh,kc,Qh,ub,v,Uc,lh,Ya,Za,$a,Wd,Ef,Ge,pi,Ld,of,Hc,Ce,pf,qf,rf,Ub,Vb,xg,rh,Ie,Je,Ca,Fb,Qd,Yg,Qg,Rd,Sg,Sd,Ug,Rg,Tg,Xg,Vg,Td,Wg,Jd,Yb,vi="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),
ui=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},t=function(b){return document.createElement(b)},D=function(b,a){return null==b?!1:0==b.trim().toLowerCase().indexOf(a)},bi=function(b,a){if(null!=b)return b=b.trim(),b.lastIndexOf(a)===b.length-1},Zh=function(b){void 0==ig&&(ig=t("textarea"));ig.innerHTML=b;return ig.value},vh=function(b,a,d){var c=t("select");c.style.width="70px";c.style.margin=
"5px";for(var g=0;g<b.length;g++){var e=t("option");e.innerHTML=b[g];e.value=a[g];c.add(e)}c.addEventListener("change",d,!1);return c},Yh=function(b){b=b.split(",");fa=Array(u);for(var a=0;a<b.length;a++){var d=b[a].split("&");ca=b.length;for(var c=0;c<u;c++)0===a&&(fa[c]=Array(ca)),fa[c][a]=d[1==d.length?0:c].trim(),null!=Yb?fa[c][a]=(Yb+fa[c][a]).trim():null!=ea&&(fa[c][a]=(ea+fa[c][a]).trim())}hd=!1},Wh=function(b){b=b.split(",");u=b.length;ta=Array(u);for(var a=0;a<u;a++)ta[a]=null!=ea?ea+b[a].trim():
b[a].trim();hd=!1;u>ca&&(ca=0)},Xh=function(b,a,d){var c=b;null!=ea&&(c=ea+b);ta=Array(u);for(var g=0;g<u;g++){b=g*d+a;if(0<=c.indexOf("*"))ta[g]=c.replace("*",b);else if(0<=c.indexOf("?")){for(var k=c;0<=k.lastIndexOf("?");){var f=k.lastIndexOf("?");k=k.substring(0,f)+b%10+k.substring(f+1);b=Math.floor(b/10)}ta[g]=k}else ta[g]=c+g;ha("image filename = "+ta[g])}D(e.reverse_order,"t")&&ta.reverse();hd=!1;u>ca&&(ca=0)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,
"toBlob",{value:function(b,a,d){d=window.atob(this.toDataURL(a,d).split(",")[1]);for(var c=d.length,g=new Uint8Array(c),e=0;e<c;e++)g[e]=d.charCodeAt(e);b(new Blob([g],{type:a||"image/png"}))}});this.setup=function(b,a,d,c){void 0==a&&(a="MORdivcan");Ke=d;void 0!=Ke&&"function"!=typeof initiCall&&(Ke=null);ng=void 0!=c?c.split("\n"):null;z=document.getElementById(a);Jd="center";z.align=Jd;Pa=t("div");Pa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");
ob=t("canvas");ob.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");M=ob.getContext("2d");sc=t("canvas");sc.setAttribute("style","position:absolute;top:0;left:0;z-index:6;");f=sc.getContext("2d");f.imageSmoothingEnabled=!1;Xd=t("canvas");Xd.setAttribute("style","position:absolute;top:0;left:0;z-index:10;");Kf=Xd.getContext("2d");Kf.imageSmoothingEnabled=!1;yc=t("div");yc.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;border-width:0px;padding:0px;margin:0px;");
qd=t("div");qd.setAttribute("style","position:absolute;top:0;left:0;z-index:10;overflow:hidden;border-width:0px;padding:0px;margin:0px;");qd.appendChild(Xd);He=t("canvas");Pa.appendChild(qd);Pa.appendChild(ob);Pa.appendChild(sc);Pa.appendChild(yc);z.appendChild(Pa);la=new PEvs(Pa,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);z.setAttribute("tabindex",0);z.addEventListener("keyup",function(a){Kb||se||(kg=!1,a.preventDefault(),a.stopPropagation())},!1);z.addEventListener("keypress",function(a){Kb||
se||(a.preventDefault(),a.stopPropagation())},!1);z.addEventListener("keydown",function(a){Kb||se||(a.preventDefault(),a.stopPropagation(),kg=a.ctrlKey?!0:!1,37==a.keyCode?(G(!1),Cb(-1),Y()):39==a.keyCode?(G(!1),Cb(1),Y()):32==a.keyCode?HAniS.toggleIsLooping():82==a.keyCode&&a.altKey&&HAniS.resetZoom())},!1);qd.addEventListener("mouseenter",function(a){z.focus()},!1);z.style.outlineWidth="0px";z.style.outline="none";z.focus();Bc=q=0;ke=!1;Nf=1;Ye=wb=!1;Ta=Da=!0;mb=ca=u=0;xe=!0;Kc=null;Mb=[];Vc=!1;
Ka=0;ed=[];xc=!0;Aa=500;Zb=100;Oc=2E3;Bf=30;wg=0;of=6E4;Hc=null;Mc=Ld=!1;Be=!0;zc=[];ma=Og=md=Yb=ea=null;zd=!1;V=-1;od=!1;Ve=Oe=C=B=1;ef=!1;R=N=ab=bb=ra=qa=p=y=S=W=0;eh=!1;pd=ph=!0;Vf=jf=tf=!1;Nd=-1;Sa=[];vb=0;Xf=!1;ja=null;Tc=-1;Df=0;je=!1;Ja=null;Je=Ie=Ca=Fb=0;lh=!1;O=0;Gb=yf=zf=Yc=!1;af=bf=ne=oe=0;Zc=rc=!1;Ea=[];Ea.push("default");Ea.push("default");lf="default";ud=!1;ve="default";cc=null;db=[0,0];lb=Hf=ue=!1;id=!0;pa=uc=null;xb=eg=!1;Ee=!0;mf="default";de=!0;oa=[];Tb=nf=!1;we="default";Qc=!1;
Oh=[1,0,0];Ph=[2,2,1];mc=[];tc=[];Jc=rd=fb=!1;Ae=We=0;Nb=Mf=Lf=x=yb=null;Wf=0;Kb=se=kg=!1;a=t("canvas");a.height=1;a.width=1;Va=a.getContext("2d");Va.imageSmoothingEnabled=!1;Jf=t("canvas");re=!1;"string"===typeof b?0>b.indexOf("\n")?mg(b):h(b.split("\n")):h(b)};this.newBasenames=function(b,a,d,c){Yc=!1;Ta=Da;G(!1);u=c;Xh(b,a,d);xc=!0;La()};this.newFilenames=function(b){Yc=!1;Ta=Da;G(!1);Wh(b);xc=!0;La()};this.newOverlayFilenames=function(b){Yc=!1;Ta=Da;G(!1);Yh(b);xc=!0;La()};this.newProbeTable=
function(b){Qc=!1;Q(b.trim())};this.reloadFOF=function(){ha("reload FoF = "+Hc);ff("r");hd?qi(pi,!1):(Ta=null==Pe?!0:Da,xc=!0,La())};this.getFOF=function(){var b=e.file_of_filenames.trim();HAniS.newFOF(null!=md?md+b:b,!0)};this.newFOF=function(b,a){HAniS.resetZoom();qi(b,a)};var qi=function(b,a){var d,c,e,f,h=new XMLHttpRequest,l,n,r,t,p,v,q,x=null,y=!1;oh=vb;Yc=!1;Ta=Da;G(!1);a&&xa(Bc);vb=u=0;ta=[];P=Ra=null;Rh=[];for(jg=null;yc.hasChildNodes();)yc.removeChild(yc.lastChild);Ne=0;zd=lb=sd=!1;ua=Xc=
fc=null;Ia=[];Ec=-1;fa=[];var w=!1;if(null==rb||null!=Vd)rb=[];ha("new FOF="+b);fb&&(null!=gc&&(H(gc,!0,"extrap on"),z.style.cursor="default",G(Ta),Ua=-1),fb=!1,Z());xb&&(null!=$c&&(H($c,!0,"mark on"),z.style.cursor="default",G(Ta),wd=-1),xb=!1,Z());h.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)if(!(2>a[d].length)&&(l=a[d].trim(),ha("FOF: "+l),0!=l.indexOf("#")))if(0==l.indexOf("frame_labels"))p=l.split("="),cb=p[1].split(",");else if(0==l.indexOf("redirect"))for(p=
l.split("="),q=p[1].split(","),jg=q[0].trim(),c=1;c<q.length;c++){var b=parseInt(q[c],10)-1;Rh[b]=!0}else if(0==l.indexOf("slice")){p=l.split("=");q=p[1].split(",");P=[];for(c=0;c<q.length;c++)P[c]=parseInt(q[c],10);P[2]=P[2]-P[0]+1;P[3]=P[3]-P[1]+1;4<P.length&&(P[6]=P[6]-P[4]+1,P[7]=P[7]-P[5]+1)}else if(0==l.indexOf("fof_extension"))p=l.split("="),x=p[1].trim();else if(0==l.indexOf("probe_table"))p=l.split("="),Qc=!1,Q(p[1].trim());else if(0==l.indexOf("image_base"))p=l.split("="),ea=p[1].trim();
else if(0==l.indexOf("overlay_base"))p=l.split("="),Yb=p[1].trim();else if(0==l.indexOf("high_res_basemap")){p=l.split("=");q=p[1].split(",");Xc=[];for(c=0;c<q.length;c++)Xc[c]=q[c].trim(),null!=ea&&(Xc[c]=ea+Xc[c]);zd=!0}else if(0==l.indexOf("high_res_overlay"))for(p=l.split("="),v=p[1].split("&"),e=0;e<v.length;e++){q=v[e].split(",");Ec=parseInt(q[0].trim(),10)-1;Ia[Ec]=[];for(c=1;c<q.length;c++)Ia[Ec][c-1]=q[c].trim(),bi(Ia[Ec][c-1],"/")||(null!=Yb?Ia[Ec][c-1]=Yb+Ia[Ec][c-1]:null!=ea&&(Ia[Ec][c-
1]=ea+Ia[Ec][c-1]));zd=!0}else if(0==l.indexOf("high_res_zoom")){p=l.split("=");q=p[1].split(",");ma=[];for(c=0;c<q.length;c++)ma[c]=parseFloat(q[c].trim());Xa()}else if(0==l.indexOf("hoverzone"))Fc(l);else if(0==l.indexOf("hotzone"))gd(l);else if(0==l.indexOf("hotspot"))y||(nb=null,mb=0,y=!0),Pb(l);else if(0==l.indexOf("toggle_onoff"))p=l.split("="),Ue=p[1].split(",");else if(0==l.indexOf("coordinates"))p=l.split("="),Ab(p[1]);else if(0==l.indexOf("map_scale"))p=l.split("="),q=p[1].split(","),Gc=
parseFloat(q[0]),te=1<q.length?parseFloat(q[1]):Gc;else if(0==l.indexOf("times")){p=l.split("=");q=p[1].split(",");for(d=0;d<q.length;d++)rb[d]=parseInt(q[d].trim(),10);w=!0}else{null!=Vd&&(b=l.match(Vd),null!=b&&2==b.length?(rb.push(parseInt(b[1],10)),ha("+ + + Extrap time = "+b[1]),w=!0):ha("+ + + Cannot parse times using "+Vd+" from line: "+l));e=l.indexOf(" ");0>e&&(e=l.length);ta[u]=l.substring(0,e).trim();null!=ea&&(ta[u]=ea+ta[u]);l=l.substring(e+1);b=l.indexOf('"');0<=b&&(null==cb&&(cb=[]),
e=l.substring(b+1),b=e.indexOf('"'),0<=b&&(cb[u]=e.substring(0,b),0==u&&(Ja.innerHTML=cb[0])));fa[u]=[];b=l.indexOf("overlay");if(0<=b)for(n=l.substring(b),b=n.indexOf("="),0>b&&ha("Cannot find a = sign in "+n),r=n.substring(b+1),n=r.trim(),r=n.split(","),ca=r.length,ha("numOverlays set to "+ca),f=0;f<r.length;f++)fa[u][f]=r[f].trim(),null!=jg&&Rh[f]?fa[u][f]=(jg+fa[u][f]).trim():null!=Yb?fa[u][f]=(Yb+fa[u][f]).trim():null!=ea&&(fa[u][f]=(ea+fa[u][f]).trim());u+=1}w&&va(rb);null!=x?(a=new XMLHttpRequest,
a.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)2>a[d].length||(t=a[d].trim(),ha("ext_FOF: "+t),0!=t.indexOf("#")&&(0==t.indexOf("hotzone")?gd(t):0==t.indexOf("hotspot")&&Pb(t)));Wa()},a.onerror=function(){Wa()},a.open("get",x+"?"+Math.round(1E5*Math.random()),!0),a.send()):Wa()};pi=b;h.open("get",b+"?"+Math.round(1E5*Math.random()),!0);h.send()};this.setWindowSize=function(b,a){if(null!=z){z.style.height=a+"px";z.style.width=b+"px";z.style.padding="0px";a=a-(null!=
Lf?Lf.offsetHeight:0)-(null!=Mf?Mf.offsetHeight:0)-(null!=yb?yb.offsetHeight:0)-Wf*(null!=Nb?Nb.offsetHeight:0);a>ia&&(a=ia);var d=a*na/ia;d>b&&(d=b,a=b*ia/na);a=Math.floor(a);d=Math.floor(d);pd||(Dd(d,a),Z())}};this.drag=function(b){xb||(W=la.getX(),S=la.getY(),Kb?(b=r.length-1,r[b].xe=W,r[b].ye=S,r[b].xp.push(W),r[b].yp.push(S),r[b].size=Math.round(Math.sqrt(Math.pow(W-r[b].x,2)+Math.pow(S-r[b].y,2)))):(y=W*A,p=S*E,Zc=Gb=!1,rc&&(!ue||ue&&b.shiftKey)?(ne=y,oe=p,Zc=!0):(ya&&C!=Ve?(N=qa-y/B,R=ra-p/
C,Fd(),qa=Math.round(N+y/B),ra=Math.round(R+p/C)):xb||fb||!lb||(pa=null,id&&0<=y&&0<=p&&(T=Zd.getImageData(y,p,1,1).data,0!=T[3]&&(pa=Ra[T[3]-1]))),ef=!0,Y())),Z())};this.resetZoom=function(){B=Oe;C=Ve;V=-1;null!=za&&(H(za,!0,"zoom on"),ya=!1);qa=y;ra=p;R=N=0;ab=ia;bb=na;Xa();Y();sd&&(lb=!0)};this.canTip=function(){var b;Gb=!1;W=la.getX();y=W*A;S=la.getY();p=S*E;if(!((xb||fb)&&p<Jh&&p>Ih&&y>Hh)){qa=Math.round(N+y/B);ra=Math.round(R+p/C);if(0!=vb)for(b=0;b<vb;b++)if(Ga[b].overlay>=ca)ha(" Error...hotzone overlay # "+
Ga[b].overlay+" > number of overlays = "+ca);else if(F[Ga[b].overlay].checked&&(Va.clearRect(0,0,1,1),Va.drawImage(K[q][Ga[b].overlay],qa,ra,1,1,0,0,1,1),T=Va.getImageData(0,0,1,1).data,lg=(T[0]<<16)+(T[1]<<8)+T[2],lg==Ga[b].color)){Gb=!0;Kh=W;Lh=S;Mh=Ga[b].tip;break}if(0!=mb)for(b=mb-1;0<=b;b--)if(null!=nb[b]){var a=nb[b];if(-1==a.frame||a.frame==q)if(-1==a.overlay||F[a.overlay].checked){var d=!1;if(a.isPan)if(a.isIcon){var c=(a.x0-N)*B-a.w2;var e=(a.y0-R)*C-a.h2;y>c&&y<c+a.width&&p>e&&p<e+a.height&&
(d=!0)}else c=(a.x0-N)*B,e=(a.y0-R)*C,y>c&&y<c+a.width*B&&p>e&&p<e+a.height*C&&(d=!0);else y>a.x0&&y<a.x1&&p>a.y0&&p<a.y1&&(d=!0);if(d&&null!=a.tip){Gb=!0;Kh=W;Lh=S;Mh=nb[b].tip;break}}}Z()}};this.move=function(){if(!fb&&lb&&(pa=null,id)){var b=la.getX()*A,a=la.getY()*E;0<=b&&0<=a&&(T=Zd.getImageData(b,a,1,1).data,0!=T[3]&&(pa=Ra[T[3]-1]))}fb&&2<=Ua&&(W=la.getX(),y=W*A,S=la.getY(),p=S*E);Z()};this.down=function(){Gb&&(Gb=!1,Z());W=la.getX();y=W*A;S=la.getY();p=S*E;af=y;bf=p;ne=af;oe=bf;qa=Math.round(N+
y/B);ra=Math.round(R+p/C);ef=!1;if(Kb){var b={};b.x=W;b.y=S;b.xe=W;b.ye=S;b.xp=[W];b.yp=[S];b.type=ie.value;b.color=he.value;b.width=Dc.value;b.text=Lb.value;b.size=0;r.push(b)}};this.up=function(b){Gb=!1;if(!Kb){if(fb||xb){W=la.getX();y=W*A;S=la.getY();p=S*E;if(xb){wd=1;if(0<wd&&p/E<mi){if(y/A>li){oa.pop();oa.pop();0==oa.length&&(wd=0);Z();return}if(y/A<ki){Z();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var a=[],d=0;d<oa.length;d+=2)qa=N+oa[d]/B,ra=R+oa[d+1]/C,
Qb(),b.document.write(db[0].toFixed(4)+","+db[1].toFixed(4)+"<br>"),0==d&&(a[0]=db[0],a[1]=db[1]);Ee&&b.document.write(a[0].toFixed(4)+","+a[1].toFixed(4)+"<br>");return}}oa.push(y);oa.push(p);Z();return}if(3>Ua)if(Ob[Ua]=y,zb[Ua]=p,Ad[Ua]=Gf[q],0==Ua)Ua=1,xa(wa(u-1)),We=1,ld=null;else{Sh=Ad[1]-Ad[0];$e=(Ob[1]-Ob[0])/Sh;me=(zb[1]-zb[0])/Sh;if(null!=wf&&null!=Gc){d=$e*Gc;var c=me*te;a=Math.round(60*Math.sqrt(d*d+c*c));d=Math.atan2(d,-c)/.0174533;0>d&&(d+=360);ld=Lg+vi[Math.round(d/22.5)]+" at "+a+
" "+Mg;ii=Ob[0];ji=0<me?zb[0]-15:zb[0]+30}a=parseInt(Pd,10);X=Math.round(Math.abs(4*(a+4)/$e));Bd=Math.round(Math.abs(2*(a+4)/me));Bd<X&&(X=Bd);120<X?X=120*Math.floor(X/120)+60:90<X?X=120:60<X?X=90:30<X?X=60:15<X?X=30:10<X?X=15:5<X?X=10:2<X?X=5:0==X&&(X=1);Bd=Ad[1]/X*X+X;le=1;Kg&&(le=-1);Gh=$e*X;fg=me*X;xa(wa(u-1));Ua=3;We=2}else if(p/E<Jh&&p/E>Ih&&y/A>Hh&&3==Ua){Sb();Z();return}Z()}if(Zc)Zc=!1,Z();else if(null!=hc&&ya&&(rc=!1,H(hc,!0,"distance on")),ef)ef=!1;else if(b.altKey)HAniS.resetZoom();else if(lb&&
null!=pa&&eg)Rb(pa,"z");else{W=la.getX();y=W*A;S=la.getY();p=S*E;if(0!=vb)for(a=0;a<vb;a++)if(Ga[a].overlay>=ca)ha(" Error...hotzone overlay # "+Ga[a].overlay+" > number of overlays = "+ca);else if(F[Ga[a].overlay].checked&&(Va.clearRect(0,0,1,1),Va.drawImage(K[q][Ga[a].overlay],Math.floor(qa),Math.floor(ra),1,1,0,0,1,1),T=Va.getImageData(0,0,1,1).data,lg=(T[0]<<16)+(T[1]<<8)+T[2],lg==Ga[a].color)){Rb(Ga[a],"z");return}if(0!=mb)for(a=mb-1;0<=a;a--)if(null!=nb[a]){var e=nb[a];if(!(-1!=e.frame&&e.frame!=
q||e.fromfile||-1!=e.overlay&&!F[e.overlay].checked)){var f=!1;e.isPan?e.isIcon?(d=(e.x0-N)*B-e.w2,c=(e.y0-R)*C-e.h2,y>d&&y<d+e.width&&p>c&&p<c+e.height&&(f=!0)):(d=(e.x0-N)*B,c=(e.y0-R)*C,y>d&&y<d+e.width*B&&p>c&&p<c+e.height*C&&(f=!0)):y>e.x0&&y<e.x1&&p>e.y0&&p<e.y1&&(f=!0);if(f){Rb(nb[a],"s");return}}}ya&&(lb=!1,Gd(b.ctrlKey||kg||b.which&&3==b.which||b.button&&2==b.button));Y();Z()}}};this.wheel=function(b){bh?Cb(b):ya&&(W=la.getX(),y=W*A,S=la.getY(),p=S*E,qa=Math.round(N+y/B),ra=Math.round(R+
p/C),Gd(-1==b))};this.toggleAutoRefresh=function(){Ld?(H(Pc,!1,"autorefresh off"),null!=Hc&&clearInterval(Hc),Ld=!1):(H(Pc,!0,"autorefresh on"),Hc=setInterval("HAniS.reloadFOF();",of),Ld=!0)};this.toggleLoopRock=function(){ke?(H(be,!0,"looprock rock"),ke=!1):(H(be,!1,"looprock loop"),ke=!0)};this.toggleLoopHalt=function(){wb?(H(ce,!0,"loophalt halt"),Ye=wb=!1):(H(ce,!1,"loophalt loop"),Ye=wb=!0)};this.toggleExtrap=function(){fb?(null!=gc&&(H(gc,!0,"extrap on"),z.style.cursor=Ea.pop(),null!=Eb&&(Eb.disabled=
!1),G(Ta),ya=ch,Ua=-1),fb=!1,Z()):(null!=gc&&(fb=!0,ld=null,Ea.push(z.style.cursor),z.style.cursor="crosshair",H(gc,!1,"extrap off"),Ta=Da,null!=Eb&&(Eb.disabled=!0),Da=!1,ch=ya,ya=!1,HAniS.resetZoom(),Sb(),Z()),Y())};this.doEnhance=function(b){if(rd||Jc){var a=Qa[0].height,d=Qa[0].width;b=parseInt(Ba.value,10);0<=b?(Zf=Ya[b],$f=Za[b],ag=$a[b],bg=Wd[b],tc[pb]=b):tc[pb]=null;var c=a*d*4;for(d=0;d<ec.length;d++)if(Qa[d].gotit){Qa[d].gotit=!1;var e=Me[d].data;var f=If[d];if(0>b)for(a=0;a<c;a+=4)e[a]=
f[a],e[a+1]=f[a+1],e[a+2]=f[a+2],e[a+3]=f[a+3];else for(a=0;a<c;a+=4)eb=f[a],eb===f[a+1]&&eb===f[a+2]&&(e[a]=Zf[eb],e[a+1]=$f[eb],e[a+2]=ag[eb],e[a+3]=bg[eb]);Wc[d].putImageData(Me[d],0,0);Qa[d].gotit=!0}}};this.overClick=function(b){var a;if(b.target.checked)for(a=0;a<F.length;a++)b.target!=F[a]&&0!=b.target.name&&b.target.name==F[a].name&&(F[a].checked=!1);id=!0;for(a=0;a<Xb.length;a++)b.target!=F[a]&&Ma(a),null!=uc&&!uc[a]&&F[a].checked&&(id=!1),null!=Ba&&a===pb&&(Ba.disabled=!F[a].checked);Y()};
this.toggleIsLooping=function(){Da?(Da=!1,H(Eb,!0,"startstop start")):(Da=!0,H(Eb,!1,"startstop stop"),Ye=wb,wb=!1)};this.toggleZooming=function(){ya?(HAniS.resetZoom(),H(za,!0,"zoom on")):(H(za,!1,"zoom off"),ya=!0,null!=hc&&(rc=!1,H(hc,!0,"distance on")),sd&&(lb=!0),fb&&HAniS.toggleExtrap())};this.togclick=function(b){var a=Ch.getX();Ch.getY();for(var d=Eh,c=0;c<Sa.length;c++){if(a>d&&a<d+yd){if(b.shiftKey){0<=Sa[c]&&(G(!1),xa(c));break}b=0;0<=Sa[c]&&(b=-1);hb(c,b);break}d=d+yd+Te}};this.doneLoading=
function(b){Le=b};this.dwellChanged=function(b){xd=b};this.getDwell=function(){return Aa};this.frameChanged=function(b){Xe=b};this.getFrame=function(){return q};this.showFrame=function(b){xa(wa(b))}};
