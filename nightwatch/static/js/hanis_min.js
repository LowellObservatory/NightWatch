var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,ca,Z){p!=Array.prototype&&p!=Object.prototype&&(p[ca]=Z.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var p=0;return function(ca){return $jscomp.SYMBOL_PREFIX+(ca||"")+p++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.iterator;p||(p=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[p]&&$jscomp.defineProperty(Array.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(p){var ca=0;return $jscomp.iteratorPrototype(function(){return ca<p.length?{done:!1,value:p[ca++]}:{done:!0}})};$jscomp.iteratorPrototype=function(p){$jscomp.initSymbolIterator();p={next:p};p[$jscomp.global.Symbol.iterator]=function(){return this};return p};
$jscomp.iteratorFromArray=function(p,ca){$jscomp.initSymbolIterator();p instanceof String&&(p+="");var Z=0,R={next:function(){if(Z<p.length){var zb=Z++;return{value:ca(zb,p[zb]),done:!1}}R.next=function(){return{done:!0,value:void 0}};return R.next()}};R[Symbol.iterator]=function(){return R};return R};
$jscomp.polyfill=function(p,ca,Z,R){if(ca){Z=$jscomp.global;p=p.split(".");for(R=0;R<p.length-1;R++){var zb=p[R];zb in Z||(Z[zb]={});Z=Z[zb]}p=p[p.length-1];R=Z[p];ca=ca(R);ca!=R&&null!=ca&&$jscomp.defineProperty(Z,p,{configurable:!0,writable:!0,value:ca})}};
$jscomp.polyfill("Array.prototype.fill",function(p){return p?p:function(p,Z,R){var ca=this.length||0;0>Z&&(Z=Math.max(0,ca+Z));if(null==R||R>ca)R=ca;R=Number(R);0>R&&(R=Math.max(0,ca+R));for(Z=Number(Z||0);Z<R;Z++)this[Z]=p;return this}},"es6","es3");
function PEvs(p,ca,Z,R,zb,jg,cf){var va,jc,Va,zd,df,Ad,Ka,kc,da,ne,La,Mb=0,Bc=0,bd,Ma=!1,lc=!1,Ab=0,Wa=0,Nb=0,Ob=0,Bd,Cd,Cc=function(h){Ka=h.target;for(da=kc=0;Ka;)kc+=Ka.offsetLeft-Ka.scrollLeft,da+=Ka.offsetTop-Ka.scrollTop,Ka=Ka.offsetParent;Mb=(Ma?Bd:h.pageX)-kc-document.body.scrollLeft;Bc=(Ma?Cd:h.pageY)-da-document.body.scrollTop};this.getX=function(){return Mb};this.getY=function(){return Bc};var G=function(h){h.preventDefault();h.stopImmediatePropagation?h.stopImmediatePropagation():h.stopPropagation()},
Dd=function(h){Cc(h);bd=Mb;xa=Bc;W=!0;null!=X&&(zd=(new Date).getTime());null!=wa&&wa(h)},I=function(h){W&&(Cc(h),W=!1,null!=Bb&&Bb(h),null!=X&&(df=(new Date).getTime(),Ad=df-zd,300>Ad&&X(h)))},gb=function(h){Cc(h);3>Math.abs(Mb-bd)&&3>Math.abs(Bc-xa)||(xa=bd=-9999,W?null!=Na&&Na(h):null!=fb&&fb(h),null!=Ed&&oe())};this.touchDown=function(h){Va=!0;if(1<h.targetTouches.length)return Ma=!0,La&&(Wa=-1,G(h)),!1;va=h.changedTouches;jc=va[0];Dd(jc)};this.touchUp=function(h){0==h.targetTouches.length&&(Ma=
Va=!1);G(h);if(Ma||lc)return Ma||(lc=!1),!1;va=h.changedTouches;jc=va[0];I(jc)};this.touchMove=function(h){Va=!0;G(h);if(Ma)return La&&(va=h.targetTouches,Bd=(va[0].pageX+va[1].pageX)/2,Cd=(va[0].pageY+va[1].pageY)/2,lc=!0,Nb=va[0].pageX-va[1].pageX,Ob=va[0].pageY-va[1].pageY,Ab=Nb*Nb+Ob*Ob,La&&0<Wa&&30<Math.abs(Ab-Wa)&&La(0<Ab-Wa?1:-1),Wa=Ab),!1;va=h.changedTouches;jc=va[0];gb(jc)};this.pointUp=function(h){G(h);for(var p=0;p<sa.length;p++)if(sa[p].pointerId==h.pointerId){sa.splice(p,1);break}0==
sa.length&&(Va=Ma=!1);if(Ma||lc)return Ma||(lc=!1),!1;I(h);return!1};this.pointDown=function(h){G(h);sa.push(h);Wa=-1;Va=!0;1<sa.length?Ma=!0:Dd(h);return!1};this.pointMove=function(h){G(h);for(var p=0;p<sa.length;p++)sa[p].pointerId==h.pointerId&&(sa[p]=h);if(Ma||!lc){if(Ma)return Bd=(sa[0].pageX+sa[1].pageX)/2,Cd=(sa[0].pageY+sa[1].pageY)/2,La&&(lc=!0,Nb=sa[0].pageX-sa[1].pageX,Ob=sa[0].pageY-sa[1].pageY,Ab=Nb*Nb+Ob*Ob,La&&0<Wa&&30<Math.abs(Ab-Wa)&&La(0<Ab-Wa?1:-1),Wa=Ab),!1;gb(h);return!1}};this.mouseDown=
function(h){Va||(G(h),Dd(h))};this.clearDown=function(){W=!1};this.mouseUp=function(h){Va||(G(h),I(h))};this.useWheel=function(h){p.addEventListener("wheel",this.mouseWheel,!0);La=h};this.mouseWheel=function(h){Cc(h);var p=Math.max(-1,Math.min(1,-h.deltaY||-h.detail));G(h);La&&La(p)};this.mouseClick=function(h){G(h);W=!1};this.mouseMove=function(h){Va||(G(h),gb(h))};this.mouseDragged=function(h){Va||(G(h),Cc(h),null!=Na&&Na(h),null!=Ed&&oe())};var oe=function(){clearTimeout(ne);ne=setTimeout(function(){Ed()},
600)};var xa=bd=Bc=Mb=0;var wa=ca;var Bb=Z;var fb=R;var Na=zb;var X=jg;var Ed=cf;var W=Va=!1;var sa=[];p.addEventListener("mousedown",this.mouseDown,!1);p.addEventListener("mouseup",this.mouseUp,!1);p.addEventListener("mousemove",this.mouseMove,!1);p.addEventListener("click",this.mouseClick,!1);p.addEventListener("touchstart",this.touchDown,!1);p.addEventListener("touchend",this.touchUp,!1);p.addEventListener("touchmove",this.touchMove,!1);p.addEventListener("touchleave",this.touchUp,!1);p.addEventListener("touchcancel",
this.touchUp,!1);p.addEventListener("contextmenu",function(h){h.preventDefault()},!1);p.style["touch-action"]="none";p.addEventListener("mouseout",function(h){W||(Bc=Mb=-1,null!=fb&&fb(h));W=!1})};var HAniS=new function(){function p(b){var a,d;cd=!0;if(b instanceof Array)for(e={},null!=kg&&(b=b.concat(kg)),a=0;a<b.length;a++){if(!(2>b[a].length)){var c=b[a].trim();if(0!=c.indexOf("#")){var g=c.indexOf("=");if(!(1>g)){var k=c.substr(0,g).trim().toLowerCase();e[k]=c.substr(g+1).trim()}}}}else e=b;pe=!1;a=e.debug;null!=a&&("true"==a?(ef=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),pe=!0,ha("HAniS Version 4.28")):pe=!1);hb=!0;a=e.set_className;null!=a&&w(a,"f")&&(hb=!1);
ha("Is type of param an array = "+(b instanceof Array));a=e.divalign;null!=a&&(Fd=a.trim(),y.align=Fd);a=e.prevent_shortcuts;null!=a&&w(a,"t")&&(qe=!0);a=e.initial_message;null!=a&&(b=e.initial_message_style,null==b&&(b="background-color:red;top:10px;left:10px;height:100px;width:200px"),b="z-index:99;position:absolute;"+b,mc=n("div"),mc.setAttribute("style",b),mc.innerHTML=a,mc.addEventListener("click",function(){mc.style.visibility="hidden"},!1),mc.style.visibility="visible",Oa.appendChild(mc),b=
e.initial_message_timeout,null!=b&&("auto"==b?ff=!0:(ff=!1,b=parseInt(e.initial_message_timeout,10),2>b&&(b=2),setTimeout(function(){mc.style.visibility="hidden"},1E3*b))));a=e.coordinates;null!=a&&zb(a);c="green";g="white";k="12px Arial";var m=null,l=d=10,f=10;gf=2;lg="Lat = ";mg=" Lon = ";a=e.coordinates_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(lg=b[3],mg=b[4],gf=parseInt(b[5],10),6<b.length&&(m=b[6].trim(),d=parseInt(b[7],10),l=parseInt(b[8],
10),f=parseInt(b[9],10))));ng=new fb(c,g,k,m,d,l,f);re=Dc=null;null!=e.map_scale&&(se=nc=!0,b=e.map_scale.split(","),Dc=parseFloat(b[0]),re=1<b.length?parseFloat(b[1]):Dc);og=" ";a=e.distance_unit;null!=a&&(og=a.trim());a=e.divcan_style;null!=a&&a.trim();hf="default";a=e.distance_cursor;null!=a&&(hf=a.trim());te="default";a=e.location_cursor;null!=a&&(te=a.trim());ue="default";a=e.probe_cursor;null!=a&&(ue=a.trim());jf="default";a=e.mark_cursor;null!=a&&(jf=a.trim());a=e.imagecan_style;null!=a&&(b=
a.trim()+";position:absolute;top:0;left:0;",nb.setAttribute("style",b+"z-index:1;"),oc.setAttribute("style",b+"z-index:6;"));c="blue";g="white";k="12px Arial";m=null;f=l=d=10;pg=1;qg="white";a=e.distance_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),qg=5<=b.length?b[4].trim():g,k=b[2].trim(),pg=parseInt(b[3],10),5<b.length&&(m=b[5].trim(),d=parseInt(b[6],10),l=parseInt(b[7],10),f=parseInt(b[8],10)));Qh=new fb(c,g,k,m,d,l,f);c="black";g="white";k="12px Arial";m=null;f=l=d=10;a=
e.probe_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Rh=new fb(c,g,k,m,d,l,f);rg="Undefined";sg=!1;Gd=0;a=e.probe_undefined;null!=a&&(b=a.split(","),rg=b[0].trim(),1<b.length&&(Gd=parseInt(b[1],10)+1),2<b.length&&(sg=!0));kf=!1;e.probe_base_image&&(kf=!0);a=e.active_probe;null!=a&&(Pb=!0);a=e.pause;null!=a&&(tg=parseInt(a,10));a=e.auto_refresh;null!=a&&(lf=6E4*parseInt(a,10),
Ec=setInterval("HAniS.reloadFOF();",lf),Hd=!0);Id=!1;a=e.enable_smoothing;null!=a&&w(a,"t")&&(Id=!0);ve=!0;a=e.check_image_size;null!=a&&w(a,"f")&&(ve=!1);ug=!1;a=e.sprites;if(null!=a){b=a.split(",");mf=new Image;nf=[];of=[];Qb=[];Rb=[];if("row"==b[1].trim().toLowerCase())for(l=g=c=0,a=2;a<b.length;)for("row"==b[a].trim().toLowerCase()&&(c=0,g+=l,l=0,a+=1),d=parseInt(b[a],10),a+=1,k=parseInt(b[a],10),a+=1,m=parseInt(b[a],10),m>l&&(l=m),a+=1,f=0;f<d;f++)nf.push(c),of.push(g),Qb.push(k),Rb.push(m),
c+=k;else for(g=!1,a=1;a<b.length;)nf.push(parseInt(b[a],10)),a+=1,of.push(parseInt(b[a],10)),a+=1,a>=b.length?(c=0,g=!0):c=parseInt(b[a],10),0>c?(g=!0,Qb.push(Math.abs(c)),a+=1,c=parseInt(b[a++],10),Rb.push(Math.abs(c))):g?(Qb.push(Qb[Qb.length-1]),Rb.push(Rb[Rb.length-1])):(Qb.push(parseInt(b[a],10)),a+=1,Rb.push(parseInt(b[a],10)),a+=1);mf.onload=function(){ug=!0};mf.src=b[0]}a=e.overlay_labels;null!=a&&(Sb=a.split(","));pf=null;a=e.auto_enhance_background;null!=a&&(pf=parseInt(a,10)-1);Fc=null;
a=e.auto_enhance;if(null!=a)for(c=e.overlay_probe_table,b=a.split(","),Fc=Array(b.length),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?Fc[a]=-1:Fc[a]=parseInt(b[a].trim(),10)-1,null==c&&(pc[a]=Fc[a]);Gc=!1;ob=-1;a=e.overlay_enhance;null!=a&&(Gc=!0,ob=parseInt(a,10)-1);qc=null;dd=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(b=a.split(","),qc=Array(b.length),a=0;a<b.length;a++)if(qc[a]=!0,w(b[a],"n")||w(b[a],"f"))qc[a]=!1;S=Y=null;qf=vg=!1;a=e.window_size;null!=a&&(b=a.split(","),"div"==b[0]?
qf=!0:(S=parseInt(b[0],10),Y=parseInt(b[1],10)),vg=!0);Jd=[];a=e.use_for_all_frames;if(null!=a)for(b=a.split(","),a=0;a<b.length;a+=2)Jd[parseInt(b[a],10)]=parseInt(b[a+1],10)-1;Kd=-1;a=e.skip_missing;null!=a&&(Kd=parseInt(a,10));wg="#00000000";a=e.skip_missing_color;null!=a&&(wg=a);we=null;a=e.overlay_spacer;if(null!=a)for(b=a.split(","),we=Array(b.length),a=0;a<b.length;a++)we[a]=parseInt(b[a],10);a=e.overlay_probe_table;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?
pc[a]=-1:pc[a]=parseInt(b[a],10)-1;rf=[];a=e.overlay_ontop;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)rf[parseInt(b[a],10)-1]=!0;Hc=null;a=e.overlay_order;null==a&&(a=e.overlay_zorder);if(null!=a)for(b=a.split(","),Hc=Array(b.length),a=0;a<b.length;a++)Hc[parseInt(b[a],10)-1]=a;Tb=null;a=e.overlay_links;if(null!=a)for(b=a.split(","),Tb=Array(b.length),a=0;a<b.length;a++)Tb[a]=parseInt(b[a],10);xg=[];J=null;a=e.overlay_slice;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)xg[parseInt(b[a],10)-
1]=!0;yg=!0;a=e.slice_smoothing;w(a,"f")&&(yg=!1);ed=null;a=e.overlay_clear;if(null!=a)for(b=a.split(","),ed=Array(b.length),a=0;a<b.length;a++)ed[a]=b[a].trim().toLowerCase();zg=!1;a=e.transparency;null!=a&&(b=a.split(","),1==b.length?Ag=Bg=Cg=parseInt(b[0],10):(Ag=parseInt(b[0],10),Bg=parseInt(b[1],10),Cg=parseInt(b[2],10)),zg=!0);sf=!1;a=e.transparency_list;if(null!=a){b=a.split(",");Dg=[];for(a=0;a<b.length;a++)Dg[parseInt(b[a].trim(),10)-1]=!0;sf=!0}xe=null;a=e.overlay_transparent_amount;if(null!=
a)for(b=a.split(","),xe=Array(b.length),a=0;a<b.length;a++)xe[a]=parseFloat(b[a])/100;Ic=null;a=e.overlay_zoom;if(null!=Sb&&null!=a)for(b=a.split(","),Ic=Array(b.length),a=0;a<b.length;a++)if(Ic[a]=1,w(b[a],"n")||w(b[a],"f"))Ic[a]=0;else if(w(b[a],"d")||w(b[a],"h"))Ic[a]=-1;pb=null;Eg=[];a=e.overlay_preserve_list;if(null!=Sb&&null!=a)for(b=a.split(","),pb=Array(b.length),a=0;a<b.length;a++){pb[a]=!0;if(w(b[a],"n")||w(b[a],"f"))pb[a]=!1;if(w(b[a],"a")||w(b[a],"A"))Eg[a]=!0}aa=null;if(null!=Sb&&null!=
pb)for(b=e.overlay_preserve.replace(/&/g,",&,").split(","),c=e.overlay_preserve_position,null!=c&&(c=c.split(",")),g=0,aa=Array(pb.length),a=k=0;a<pb.length;a++)if(pb[a]){aa[a]=[];m=0;do{aa[a][m]=[];for(d=0;4>d;d++)aa[a][m][d]=parseInt(b[k].trim(),10),k+=1;aa[a][m][2]=aa[a][m][2]-aa[a][m][0]+1;aa[a][m][3]=aa[a][m][3]-aa[a][m][1]+1;null!=c?(aa[a][m][4]=parseInt(c[g],10),aa[a][m][5]=parseInt(c[g+1],10),g+=2):(aa[a][m][4]=aa[a][m][0],aa[a][m][5]=aa[a][m][1]);k<b.length&&"&"==b[k].trim()?(k+=1,m+=1,d=
!0):d=!1}while(d)}ye=0;Fg=" ";rc="white";Ld="transparent";Md="14pt arial";Gg=!1;a=e.times_label_style;null!=a&&(b=a.split(","),rc=b[0].trim(),1<b.length&&(ye=Math.floor(60*parseFloat(b[1]))),1<b.length&&(ye="?"==b[1].trim()||"auto"==b[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(b[1]))),2<b.length&&(Fg=b[2].trim()),3<b.length&&(Ld=b[3].trim()),4<b.length&&(Md=b[4].trim()),5<b.length&&-1!=b[5].trim().indexOf("t")&&(Gg=!0));0==rc.indexOf("0x")&&(rc="#"+
rc.substring(2));0==Ld.indexOf("0x")&&(Ld="#"+Ld.substring(2));fd=parseInt(Md,10);Sh=new fb("black","white",Md,"black",20,5,5);Hg=!1;a=e.to_from_lock;null!=a&&(Hg=w(a,"t")?!0:!1);a="black";d="white";l="14px arial";c=null;m=k=g=10;Ig=Jg=" ";tf=gd=null;a=e.dirspd_display_style;null!=a&&(b=a.split(","),a=b[0].trim(),d=b[1].trim(),l=b[2].trim(),Ig=b[3],Jg=b[4],5<b.length&&(c=b[5].trim(),g=parseInt(b[6],10),k=parseInt(b[7],10),m=parseInt(b[8],10)),tf=new fb(a,d,l,c,g,k,m));c="black";g="white";k="14px arial";
m=null;f=l=d=10;a=e.tipbox_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Kg=new fb(c,g,k,m,d,l,f);hd=null;ea=e.image_base;null!=ea?hd=ea=ea.trim():ea=null!=e.image_only_base?e.image_only_base.trim():null;Lg=ea;a=e.overlay_base;null!=a&&(Ub=a.trim());ze=!0;a=e.zip_only;null!=a&&w(a,"f")&&(ze=!1);Jc=!1;a=e.zip_filename;null!=a&&(Jc=!0,uf=a.trim());cd=!0;a=e.filenames;null==a&&
(a=e.background_filenames);null!=a&&Th(a);a=e.basename;null!=a&&(c=e.base_starting_number,g=0,k=1,null!=c&&(b=c.split(","),g=parseInt(b[0],10),1<b.length&&(k=parseInt(b[1],10))),v=e.num_frames,null==v&&(v=e.num_images),v=parseInt(v,10),Uh(a,g,k));vf=!0;b=e.zip_static;null!=b&&(w(b,"f")||w(b,"n"))&&(vf=!1);wf=!0;b=e.background_static;null!=b&&(w(b,"f")||w(b,"n"))&&(wf=!1);a=e.overlay_filenames;null!=a&&Vh(a);Ea=null;a=e.image_preserve;if(null!=a)for(b=a.split(","),Ea=[],a=0;a<b.length;a++)Ea[a]=parseInt(b[a].trim(),
10),1<a%4&&(Ea[a]=Ea[a]-Ea[a-2]+1);Mg=!0;a=e.keep_zoom;null!=a&&w(a,"f")&&(Mg=!1);Nd=Ng=0;Og=!1;a=e.hide_bottom;null!=a&&(b=a.split(","),Ng=parseInt(b[0].trim(),10),1<b.length&&w(b[1],"t")&&(Og=!0));Od=Pg=0;Qg=!1;a=e.hide_top;null!=a&&(b=a.split(","),Pg=parseInt(b[0].trim(),10),1<b.length&&w(b[1],"t")&&(Qg=!0));Pd=Rg=0;Sg=!1;a=e.hide_left;null!=a&&(b=a.split(","),Rg=parseInt(b[0].trim(),10),1<b.length&&w(b[1],"t")&&(Sg=!0));Qd=Tg=0;Ug=!1;a=e.hide_right;null!=a&&(b=a.split(","),Tg=parseInt(b[0].trim(),
10),1<b.length&&w(b[1],"t")&&(Ug=!0));Vg=!1;a=e.hide_background;null!=a&&w(a,"t")&&(Vg=!0);Wg="<div>";Xg=300;Yg=500;a=e.popup_style;null!=a&&(Wg='<div style="'+a+'">');a=e.popup_window_size;null!=a&&(b=a.split(","),Yg=b[0],Xg=b[1]);Zg=!1;a=e.wheel_frames;null!=a&&(Zg=!0,la.useWheel(HAniS.wheel));$g=ya=!1;a=e.active_zoom;null!=a&&w(a,"t")&&(null==za&&(ya=!0),la.useWheel(HAniS.wheel));xf=!1;a=e.cycle_zoom;null!=a&&w(a,"t")&&(xf=!0);a=e.initial_zoom;null!=a&&(b=a.split(","),sc="auto"!=b[0].toLowerCase()?
parseFloat(b[0]):"auto",1<b.length?(Rd=parseInt(b[1],10),ah=parseInt(b[2],10)):Rd=-1,bh=!0);id=1;jd=!1;ma=null;a=e.zoom_scale;if(null!=a)if(b=a.split(","),1===b.length)w(a,"hi_res")?(jd=!0,id=0):id=parseFloat(a);else{ma=Array(b.length);for(a=0;a<b.length;a++)ma[a]=parseFloat(b[a]);jd=!0}Kc=9999999;a=e.maximum_zoom;null!=a&&(Kc=parseFloat(a));Ae=!0;a=e.use_progress_bar;null!=a&&w(a,"f")&&(Ae=!1);a=e.dwell;null!=a&&(b=a.split(","),Aa=parseInt(b[0].trim(),10),1<b.length&&(Vb=parseInt(b[1].trim(),10),
10>Vb&&(Vb=10),Lc=parseInt(b[2].trim(),10),yf=parseInt(b[3].trim(),10)));a=e.rate;null!=a&&(b=a.split(","),Aa=Math.round(1E4/parseFloat(b[0].trim())),1<b.length&&(Vb=Math.round(1E4/parseFloat(b[2].trim())),10>Vb&&(Vb=10),Lc=Math.round(1E4/parseFloat(b[1].trim()))));a=e.frame_times_template;null!=a&&(b=a.split(","));qb=null;a=e.times;if(null!=a){b=a.split(",");qb=Array(b.length);for(a=0;a<b.length;a++)qb[a]=parseInt(b[a].trim(),10);va(qb)}a=e.extrap_times_filename;if(null!=a){qb=[];var h=new XMLHttpRequest;
h.open("get",a,!0);h.onload=function(){for(var a=h.responseText.split("\n"),b=0;b<a.length;b++){var c=a[b].split(" ");if(3==c.length){c[2].trim();var d=parseInt(c[0],10)-1;qb[d]=100*parseInt(c[2].substring(0,2),10)+parseInt(c[2].substring(3,5),10)+parseInt(c[2].substring(6,8),10)/30}}va(qb)};h.send()}Sd=null;a=e.extrap_times_template;null!=a&&(Sd=RegExp(a));ch=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];dh=10;a=e.extrap_prompts_position;
null!=a&&w(a,"bot")&&(dh=9999);a=e.extrap_prompts;null!=a&&(ch=a.split(","));Be=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&(Be=a.split(","));Ce=!0;a=e.mark_close;null!=a&&w(a,"f")&&(Ce=!1);zf="12pt Arial";eh="white";a=e.mark_prompts_style;null!=a&&(b=a.split(","),zf=b[0].trim(),1<b.length&&(eh=b[1].trim()));fh=e.controls;ha("controls = "+e.controls);ha("bottom_controls = "+e.bottom_controls);Mc=De=Wb=Xb=rb=sb=Cb=null;null!=fh&&ne(fh,!0);gh=e.bottom_controls;
null!=gh&&ne(gh,!1);Nc=!1;a=e.probe_table;null!=a&&R(a);b=e.enhance_filename;null==b&&(b=e.enhance_table);if(null!=b){ha("Reading enhancement table...");Nc=!1;h=new XMLHttpRequest;tb=[];Oc=[];Ee=[];Pc=[];Yb=[];var hh,ib,p;Xa=[];Ya=[];Za=[];Td=[];u=-1;ih=!0;var q=!1,r,z,t,M,F,B,C,A,G,I,jh,x,H;h.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var c=a[b].replace(/\s+/g," ").trim(),d=c.indexOf("#");if(0!=d)if(0<d&&(c=c.substring(0,d)),d=c.split(","),0==
d[0].indexOf("*"))u++,tb[u]=Array(256),Pc[u]=Array(256),Oc[u]=Array(256),Yb[u]=Array(256),Xa[u]=Array(256),Ya[u]=Array(256),Za[u]=Array(256),Td[u]=Array(256),tb[u]=Array(256),Ee[u]=1<d.length?d[1].trim():"None",hh=" ",ib="Value =",p=1,c=n("option"),c.innerHTML=d[0].substring(1),c.value=u,null!=Ba&&Ba.add(c);else{var g=c.indexOf("value");0>g&&(g=c.indexOf("probe"));q=!1;I=jh=0;0<g&&(d=c.substring(g+1),c=c.substring(0,g),g=d.indexOf("="),d=d.substring(g+1),d=d.split(","),1==d.length?(ib=d[0].trim(),
p=-1,q=!1):(I=parseFloat(d[0].trim()),jh=parseFloat(d[1].trim()),2<d.length&&(p=parseInt(d[2],10)),3<d.length&&(hh=Wh(d[3].trim())),4<d.length&&(ib=d[4].trim()),q=!0));c=c.split(" ");r=parseInt(c[0].trim(),10);z=parseInt(c[1].trim(),10);t=z-r;M=parseFloat(c[2].trim());F=parseFloat(c[3].trim());B=parseFloat(c[4].trim());C=parseFloat(c[5].trim());A=parseFloat(c[6].trim());G=parseFloat(c[7].trim());x=H=255;9<c.length&&(x=parseFloat(c[8].trim()),H=parseFloat(c[9].trim()));for(c=r;c<=z;c++)0===t?(Xa[u][r]=
M,Ya[u][r]=B,Za[u][r]=A,Td[u][r]=x):(Xa[u][c]=Math.round(M+(F-M)*(c-r)/t),Ya[u][c]=Math.round(B+(C-B)*(c-r)/t),Za[u][c]=Math.round(A+(G-A)*(c-r)/t),Td[u][c]=Math.round(x+(H-x)*(c-r)/t)),Pc[u][c]=ib,Oc[u][c]=hh,Yb[u][c]=p,q&&(tb[u][c]=I+(jh-I)*(c-r)/t)}}-1!=ob&&E[ob].checked&&(Ba.disabled=!1);Nc=!0;ca()};h.open("get",b,!0);h.send()}else ca()}function ca(){var b=e.sprite_filenames;if(null!=b){var a=b.split(",");Af=0;ja=[];b=e.sprite_images_offset;Qc=-1;null!=b&&(Qc=parseInt(b,10)-1);for(b=0;b<a.length;b++){ja[b]=
new Image;ja[b].gotit=!1;ja[b].inx=b;ja[b].fromfile=!0;var d="/";0<a[b].indexOf("?")&&(d="?");ja[b].zoomme=0<a[b].indexOf(d+"zoom");ja[b].anim=0<a[b].indexOf(d+"animate");d=a[b].indexOf(d);0<d&&(a[b]=a[b].substring(0,d));ja[b].onload=function(){ja[this.inx].gotit=!0;Af++;Af==a.length&&Z()};ja[b].src=a[b].trim()}}else Z()}function Z(){for(var b=Object.keys(e),a=0;a<b.length;a++)w(b[a],"hotspot")&&Mb("hotspot="+e[b[a]]);cd?HAniS.getFOF():(tc=!0,Ka())}function R(b){var a=new XMLHttpRequest;tb=[];Ee=
[];Oc=[];var d=" ";Pc=[];var c="Value=";Yb=[];var g=1;Rc=[];Bf=[];Xa=[];Ya=[];Za=[];var e,m=-1;u=-1;var l=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var k=a[b].replace(/\s+/g," ").trim().split(","),f=k[0].split(" ");if(0==f[0].indexOf("*"))u++,tb[u]=[],Pc[u]=[],Oc[u]=[],Yb[u]=[],Xa[u]=[],Ya[u]=[],Za[u]=[],Bf[u]=[],Rc[u]=[],m=-1,Ee[u]=1<k.length?k[1].trim():"None",l=1;else if(0!=l){m++;var h=Array(3);tb[u][m]=parseFloat(f[0]);Xa[u][m]=parseInt(f[1].trim(),
10);Ya[u][m]=parseInt(f[2].trim(),10);Za[u][m]=parseInt(f[3].trim(),10);0!=m&&(h[0]=Xa[u][m]-Xa[u][m-1],h[1]=Ya[u][m]-Ya[u][m-1],h[2]=Za[u][m]-Za[u][m-1],e=0,Math.abs(h[1])>Math.abs(h[e])&&(e=1),Math.abs(h[2])>Math.abs(h[e])&&(e=2),Bf[u][m-1]=e,Rc[u][m-1]=h,0==Rc[u][m-1][e]&&(Rc[u][m-1][e]=1));1<k.length&&(0==k[1].trim().indexOf('"')?(g=-1,k=k[1].trim(),c=k.substr(1,k.length-2),d=""):(g=parseInt(k[1],10),2<k.length&&(d=Wh(k[2].trim())),3<k.length&&(c=k[3].trim())));Pc[u][m]=c;Yb[u][m]=g;Oc[u][m]=
d}}Nc=!0};a.open("get",b,!0);a.send()}function zb(b){b=b.split(",");var a=b[0].trim();"PS"===a?(Zb=new oi,Zb.init(b)):"CE"==a?(Zb=new pi,Zb.init(b)):"LCC"==a?(Zb=new qi,Zb.init(b)):(Zb=null,Cf=parseFloat(b[0]),kh=parseFloat(b[1]),Xh=parseFloat(b[2]),Yh=parseFloat(b[3]))}function jg(b){var a=new XMLHttpRequest;a.onload=function(){p(this.responseText.split("\n"))};a.open("get",b+"?"+Math.round(1E5*Math.random()),!0);a.send()}function cf(b){var a;if(null!=ed){for(a=0;a<ed.length;a++)-1!=ed[a].indexOf(b)&&
(E[a].checked=!1);for(a=0;a<ed.length;a++)La(a)}}function va(b){Df=Array(b.length);for(var a=0;a<b.length;a++){var d=60*Math.floor(b[a]/100)+Math.floor(b[a])%100;0===a&&($b=d);var c=d-$b;0>c&&(c=d+1440-$b);Df[a]=c;ha("times s="+d+"  min="+Df[a])}$b+=ye;1440<=$b&&($b-=1440);0>$b&&($b+=1440);ha("Starting minute = "+$b)}function jc(b,a){if(0!=b)for(var d=0;d<b;d++)0==E[Fa[d].overlay].isGhost&&(E[Fa[d].overlay].parentNode.style.visibility=a)}function Va(){0!=ub?jc(ub,"visible"):0!=lh&&jc(lh,"hidden");
tc=!0;Ka()}function zd(b,a){kd||(nb.height=a,nb.width=b,oc.height=a,oc.width=b,Ud.height=a,Ud.width=b,Fe.height=a,Fe.width=b,Vd=Fe.getContext("2d"),S=b,Y=a,Ge=S/2-100,He=Y/2-10,B=1*na/S,C=1*ia/Y,mh&&(mh=!1,null!=Wd&&Wd()),Oa.style.height=Y+"px",Oa.style.width=S+"px",uc.style.height=Y+"px",uc.style.width=S+"px",ld.style.height=Y+"px",ld.style.width=S+"px",oe(v,!1))}function df(){for(var b=0,a={},d=0;d<v;a={ii:a.ii},d++){a.ii=d;var c=null==ea?ta[d]:ta[d].substring(ta[d].lastIndexOf("/")+1);(c=nh.file(c))?
c.async("arraybuffer").then(function(a){return function(c){c=new Blob([c]);vc[a.ii]=URL.createObjectURL(c);b++;b>=v&&Ad()}}(a),function(a){return function(){vc[a.ii]=null;b++;b>=v&&Ad()}}(a)):(vc[a.ii]=null,b++,b>=v&&Ad())}}function Ad(){var b=0;if(0==ba)kc();else for(var a=0;a<v;a++){wc[a]=[];for(var d={},c=0;c<ba;d={ii:d.ii,jj:d.jj},c++){d.ii=a;d.jj=c;var g=null==Ub&&null==ea?fa[a][c]:fa[a][c].substring(fa[a][c].lastIndexOf("/")+1);(g=nh.file(g))?g.async("arraybuffer").then(function(a){return function(c){c=
new Blob([c]);wc[a.ii][a.jj]=URL.createObjectURL(c);b++;b>=v*ba&&kc()}}(d),function(a){return function(){wc[a.ii][a.jj]=null;b++;b>=v*ba&&kc()}}(d)):(wc[a][c]=null,b++,b>=v*ba&&kc())}}}function Ka(){if(Jc){var b=new XMLHttpRequest,a=null==hd?uf:hd+uf;vf||(a=a+"?"+Math.round(1E5*Math.random()));b.open("GET",a,!0);b.responseType="arraybuffer";vc=[];wc=[];b.addEventListener("progress",function(a){a.lengthComputable&&sa("Loading ZIP file",a.total,a.loaded)});b.onload=function(a){(new JSZip).loadAsync(this.response).then(function(a){nh=
a;df()},function(){ha("Unable to read ZIP file: "+uf)})};b.send()}else kc()}function kc(){var b,a,d;void 0!=Ie&&Ie(!1);var c="?"+Math.round(1E4*Math.random()),g=[];g[0]=xc;for(b=1;b<v;b++)g[b]=b<=xc?b-1:b;Ga=Array(v);Db=Ha=0;oh=Ae;Ef&&(jb.max=v);kd&&(md||Gc)&&(ac=[],Pa=[],Sc=[],Ff=[],Je=[]);null!=Ba&&(Ba.selectedIndex=0);for(var e=0;e<v;e++){b=g[e];kd&&(md||Gc)&&(ac[b]=n("canvas"),Pa[b]=n("canvas"));Ga[b]=new Image;Ga[b].gotit=!1;Ga[b].frameNum=b;Ga[b].onerror=function(){Ha++};Ga[b].onload=function(){kd&&
(ia=this.height,na=this.width,$a=ia,ab=na,kd=!1,vg?qf?HAniS.setWindowSize(y.offsetWidth,y.offsetHeight):zd(S,Y):zd(na,ia),bh&&("auto"==sc&&(sc=(B+C)/2,Rd=-1),$a/=sc,ab/=sc,0>Rd&&(Rd=na/2,ah=ia/2),P=Math.round(Rd-na/2/sc),O=Math.round(ah-ia/2/sc),x=H=sc,1!=sc&&(ya=!1,HAniS.toggleZooming())));Jc&&null!=vc[this.frameNum]&&URL.revokeObjectURL(vc[this.frameNum]);if(0<Ke&&!nd){Gf.height=ia;Gf.width=na;Xd=Gf.getContext("2d");Xd.clearRect(0,0,S,Y);for(var b=0;b<Qa.length;b++){for(var e=Qa[b].ctx.getImageData(0,
0,Qa[b].width,Qa[b].height).data,m=Xd.getImageData(Qa[b].xmin,Qa[b].ymin,Qa[b].width,Qa[b].height),k=3;k<e.length;k+=4)0!=e[k]&&(m.data[k]=b+1);Xd.putImageData(m,Qa[b].xmin,Qa[b].ymin)}ya||(kb=!0);x==Le&&(kb=!0);nd=!0}if(tc){tc=!1;K=nb.getContext("2d");K.imageSmoothingEnabled=Id;K.fillStyle="blue";K.font="bold 20px Arial";f=oc.getContext("2d");f.imageSmoothingEnabled=Id;Ra=Array(v);oe(v,!0);Me&&!Sa?xa(wa(xc)):xa(wa(q));if(0<ba)for(D=Array(v),k=0;k<v;k++)for(d=g[k],D[d]=Array(ba),a=0;a<ba;a++)D[d][a]=
new Image,D[d][a].gotit=!1,D[d][a].frameNum=d,D[d][a].overlayNum=a,D[d][a].onerror=function(){Ha++},D[d][a].onload=function(){this.gotit=!0;var a=this.frameNum;Ha++;h();!ve||this.height==ia&&this.width==na?this.overlayNum==Kd-1&&(Ra[this.frameNum]=0):(this.gotit=!1,ha("Bad image size:"+this.src));if(Gc&&this.gotit&&this.overlayNum==ob)ac[a].height=this.height,ac[a].width=this.width,Yd=ac[a].getContext("2d"),Yd.drawImage(this,0,0),Ff[a]=Yd.getImageData(0,0,this.width,this.height).data,Pa[a].height=
this.height,Pa[a].width=this.width,Sc[a]=Pa[a].getContext("2d"),Sc[a].drawImage(this,0,0),Je[a]=Sc[a].getImageData(0,0,this.width,this.height),D[a][this.overlayNum]=null,D[a][this.overlayNum]=Pa[a],D[a][this.overlayNum].gotit=!0;else if(this.gotit&&E[this.overlayNum].hotspotIndex){var b=n("canvas");b.height=this.height;b.width=this.width;var c=b.getContext("2d");c.drawImage(this,0,0);var d=c.getImageData(0,0,this.width,this.height).data,g=d.length;var e=this.overlayNum;var k;for(k=0;k<g;k+=4)if(0!=
d[k]){0==lb&&(mb=[]);var m=d[k];var l=Math.floor(k/4/b.width);c=Math.floor(k/4%b.width);mb[lb]=new Ab(c,l,"spritefn",m,"pan",null,null,e,a,null);lb++}}else if(this.gotit&&zg&&(!sf||sf&&Dg[this.overlayNum])){b=n("canvas");b.height=this.height;b.width=this.width;c=b.getContext("2d");c.drawImage(this,0,0);l=c.getImageData(0,0,this.width,this.height);d=l.data;g=d.length;for(k=0;k<g;k+=4)d[k]===Ag&&d[k+1]===Bg&&d[k+2]===Cg&&(d[k+3]=0);c.putImageData(l,0,0);D[a][this.overlayNum]=null;D[a][this.overlayNum]=
b;D[a][this.overlayNum].gotit=!0}this.gotit&&rf[this.overlayNum]?(Hf.clearRect(0,0,S,Y),Hf.drawImage(D[a][this.overlayNum],0,0,S,Y)):this.gotit&&xg[this.overlayNum]&&null!=J&&(b=n("canvas"),b.height=ia,b.width=na,8>J.length&&(J[4]=0,J[5]=0,J[6]=na,J[7]=ia),c=b.getContext("2d"),c.imageSmoothingEnabled=yg,c.drawImage(this,J[0],J[1],J[2],J[3],J[4],J[5],J[6],J[7]),D[a][this.overlayNum]=null,D[a][this.overlayNum]=b,D[a][this.overlayNum].gotit=!0,null!=pb&&pb[this.overlayNum]&&(D[a][this.overlayNum].origImage=
this));Jc&&null!=wc[a][this.overlayNum]&&URL.revokeObjectURL(wc[a][this.overlayNum])},b=fa[d][a],void 0!=Jd[a+1]&&(b=Jd[a+1],b>=v&&(b=v-1),b=fa[b][a]),void 0==Zd||Zd[a]||(b+=c),D[d][a].src=b,D[d][a].src=Jc&&(ze||wc[d][a])?wc[d][a]:b,Db++;if(null!=Tc)for(bc=[],a=0;a<Tc.length;a++)bc[a]=new Image,bc[a].gotit=!1,bc[a].onerror=function(a){Ha++},bc[a].onload=function(a){a.currentTarget.gotit=!0;Ha++;h()},bc[a].src=Tc[a],Db++;if(null!=Ia&&0<Ia.length)for(ua=[],a=0;a<Ia.length;a++)if(void 0!=Ia[a])for(ua[a]=
[],d=0;d<Ia[a].length;d++)for(ua[a][d]=[],k=0;k<v;k++)Zh(Ia[a][d],"/")?(b=fa[k][a].lastIndexOf("/"),b=fa[k][a].substring(0,b+1)+Ia[a][d]+fa[k][a].substring(b+1),ua[a][d][k]=new Image,ua[a][d][k].gotit=!1,ua[a][d][k].onerror=function(a){Ha++;h()},ua[a][d][k].onload=function(a){a.currentTarget.gotit=!0;Ha++;h()},ua[a][d][k].src=b,Db++):0===k?(ua[a][d][0]=new Image,ua[a][d][0].gotit=!1,ua[a][d][0].onerror=function(a){Ha++;h()},ua[a][d][0].onload=function(a){a.currentTarget.gotit=!0;Ha++;h()},ua[a][d][0].src=
Ia[a][d],Db++):ua[a][d][k]=ua[a][d][0]}!ve&&0!=this.height&&0!=this.width||this.height==ia&&this.width==na?(this.gotit=!0,0==Kd&&(Ra[this.frameNum]=0)):(this.gotit=!1,ha("Image has invalid size:"+this.src));md&&this.gotit&&(k=this.frameNum,ac[k].height=this.height,ac[k].width=this.width,Yd=ac[k].getContext("2d"),Yd.drawImage(this,0,0),Ff[k]=Yd.getImageData(0,0,this.width,this.height).data,Pa[k].height=this.height,Pa[k].width=this.width,Sc[k]=Pa[k].getContext("2d"),Sc[k].drawImage(this,0,0),Je[k]=
Sc[k].getImageData(0,0,this.width,this.height),Ga[k]=null,Ga[k]=Pa[k],Ga[k].gotit=!0);Ha++;h();Mg||HAniS.resetZoom();Uc=!0;$h||($h=!0,Ca=!1,ai());G(Sa)};var m=ta[b];void 0!=Jd[0]&&(m=Jd[0],m>=v&&(m=v-1),m=ta[m]);wf||(m+=c);Ga[b].src=Jc&&(ze||vc[b])?vc[b]:m;Db++}Vc=Eb=!1;X()}function da(b,a,d,c,g,k){b.label_on=d;b.label_off=c;hb&&(b.className=k);d=null;c=e[a+"_labels"];null==c&&(c=e[a+"_label"]);null!=c&&(c=c.split(","),b.label_on=c[0].trim(),1<c.length&&(b.label_off=c[1].trim()),2<c.length&&(d="width:"+
c[2].trim()+"px;"));null!=g&&(b.title=g);b.innerHTML=b.label_on;g=a=c=e[a+"_style"];null!=c&&(c=c.split("&"),1<c.length&&(a=c[0],g=c[1]));b.style_on=(null!=d?d:"")+yc+a;b.style_off=(null!=d?d:"")+yc+g;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",b.style_on):(b.style_on=null,b.style_off=null)}function ne(b,a){yc=e.buttons_style;null==yc&&(yc="");var d=null,c=null;d=a?e.controls_tooltip:e.bottom_controls_tooltip;var g=b.split(",");if(null!=d){var k=d.split(",");k.length!=g.length&&(ha("!!! Number of tooltips must equal number of controls!"),
k=d=null)}for(b=0;b<g.length;b++){var m=null!=d?k[b]:null;var l=g[b].trim();c=l.indexOf("/");if(0===c||0===b){0===c&&(l=l.substring(1));t=n("div");t.align=Fd;var f=e.controls_style;null!=f?t.setAttribute("style",f):t.setAttribute("style","position:relative;padding:2px;width:100%;");a?(y.insertBefore(t,Oa),If=t):(f=e.bottom_controls_style,null!=f&&t.setAttribute("style",f),y.appendChild(t),Jf=t)}"enhance"==l.trim()&&(Ba=n("select"),c=e.enhance_style,null!=c&&Ba.setAttribute("style",c),null!=m&&(Ba.title=
m),c=n("option"),c.innerHTML="Pick Enhancement",c.value=-1,Ba.add(c),Ba.addEventListener("change",HAniS.doEnhance,!1),md=!Gc,Ba.disabled=md?!1:!0,t.appendChild(Ba));"startstop"==l&&(Cb=n("button"),da(Cb,"startstop","Start","Stop",m,"startstop start"),Cb.addEventListener("click",HAniS.toggleIsLooping,!1),t.appendChild(Cb));"looprock"==l&&($d=n("button"),da($d,"looprock","Rock","Loop",m,"looprock rock"),Kf=1,$d.addEventListener("click",HAniS.toggleLoopRock,!1),t.appendChild($d));"loophalt"==l&&(ae=
n("button"),da(ae,"loophalt","Halt","Loop",m,"loophalt halt"),vb=!1,ae.addEventListener("click",HAniS.toggleLoopHalt,!1),t.appendChild(ae));"extrap"==l&&(cc=n("button"),da(cc,"extrap","Enable Extrap","Disable Extrap",m,"extrap"),cc.addEventListener("click",HAniS.toggleExtrap,!1),t.appendChild(cc));w(l,"location")&&(od=n("button"),da(od,"location","Show Loc","Hide Loc",m,"location"),0<l.indexOf("/on")?(I(od,!1,"location off"),pd=!0,Da.push(y.style.cursor),y.style.cursor=te):(pd=!1,y.style.cursor=Da.pop()),
od.addEventListener("click",function(){(pd=!pd)?(I(od,!1,"location off"),Da.push(y.style.cursor),y.style.cursor=te):(I(od,!0,"location on"),y.style.cursor=Da.pop());X()},!1),t.appendChild(od));"distance"==l&&(dc=n("button"),da(dc,"distance","Show dist","Hide dist",m,"distance"),nc=se=!1,dc.addEventListener("click",function(){(nc=!nc)?(I(dc,!1,"distance off"),Da.push(y.style.cursor),y.style.cursor=hf):(I(dc,!0,"distance on"),y.style.cursor=Da.pop())},!1),t.appendChild(dc));w(l,"probe")&&(qd=n("button"),
da(qd,"probe","Show probe","Hide probe",m,"probe"),0<l.indexOf("/on")?(I(qd,!1,"probe off"),Pb=!0,Da.push(y.style.cursor),y.style.cursor=ue):(Pb=!1,y.style.cursor=Da.pop()),qd.addEventListener("click",function(){(Pb=!Pb)?(I(qd,!1,"probe off"),Da.push(y.style.cursor),y.style.cursor=ue):(I(qd,!0,"probe on"),y.style.cursor=Da.pop())},!1),t.appendChild(qd));"mark"==l&&(Wc=n("button"),da(Wc,"mark","Mark","Stop Mark",m,"mark"),be=!0,Wc.addEventListener("click",function(){wb=!wb;oa=[];wb?(rd=0,I(Wc,!1,"mark off"),
null!=za&&(za.disabled=!0),Da.push(y.style.cursor),y.style.cursor=jf):(I(Wc,!0,"mark on"),null!=za&&(za.disabled=!1),rd=-1,y.style.cursor=Da.pop());X()},!1),bi=new fb("black","white",zf,"black",20,5,5),ph=new fb("black","white",zf,"black",20,5,5),t.appendChild(Wc));"refresh"==l&&(De=n("button"),da(De,"refresh","Refresh",null,m,"refresh"),De.addEventListener("click",HAniS.reloadFOF,!1),t.appendChild(De));"restore"==l&&(Lf=n("button"),da(Lf,"restore","Restore",null,m,"restore"),Lf.addEventListener("click",
function(a){for(a=0;a<E.length;a++)E[a].checked=E[a].restorableState;for(a=0;a<E.length;a++)La(a)},!1),t.appendChild(Lf));"setframe"==l&&(jb=n("input"),hb&&(jb.className="setframe"),jb.type="range",jb.min=1,jb.max=100,jb.value=1,Ne="Frame #*",null!=m&&(jb.title=m),f=e.setframe_label,null!=f&&(Ne=f),ce=n("span"),ce.innerHTML=Ne.replace("*",1),c="display:block;vertical-align:middle;"+e.setframe_style,jb.setAttribute("style",c),c=n("span"),c.setAttribute("style","display:inline-block;vertical-align:top;"),
ce.setAttribute("style","display:block;vertical-align:middle;"+e.setframe_label_style),c.appendChild(ce),c.appendChild(jb),t.appendChild(c),jb.addEventListener("input",function(a){G(!1);a=parseInt(jb.value,10)-1;0<=Ra[a]&&(xa(a),ce.innerHTML=Ne.replace("*",q+1));W()},!1),Ef=!0);"framelabel"==l&&(Ja=n("button"),hb&&(Ja.className="framelabel"),Ja.innerHTML="",null!=m&&(Ja.title=m),bb=null,f=e.frame_labels,null!=f&&(bb=f.split(","),Ja.innerHTML=bb[0]),c=yc+e.framelabel_style,null!=c&&Ja.setAttribute("style",
c),c=e.framelabel_position,null!=c&&(c=c.split(","),Ja.style.position="absolute",Ja.style.left=y.offsetLeft+parseInt(c[0],10)+"px",Ja.style.top=y.offsetTop+parseInt(c[1],10)+"px"),t.appendChild(Ja));if("autorefresh"==l||"autorefresh/off"==l)null!=Ec&&clearInterval(Ec),Mc=n("button"),da(Mc,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",m,"autorefresh"),Mc.addEventListener("click",HAniS.toggleAutoRefresh,!1),Hd=!1,t.appendChild(Mc),"autorefresh"==l?HAniS.toggleAutoRefresh():I(Mc,!1,"autotoggle off");
"backward"==l&&(rb=n("button"),da(rb,"backward","<","<",m,"step back"),rb.addEventListener("click",function(){G(!1);Bb(-1);W()},!1),t.appendChild(rb));"forward"==l&&(sb=n("button"),da(sb,"forward",">",">",m,"step forward"),sb.addEventListener("click",function(){G(!1);Bb(1);W()},!1),t.appendChild(sb));if("step"==l){c=e.step_labels;var h=null!=c?c.split(","):["<",">"];rb=n("button");hb&&(rb.className="step back");rb.innerHTML=h[0];rb.addEventListener("click",function(){G(!1);Bb(-1);W()},!1);c=yc+e.step_style;
null!=c&&rb.setAttribute("style",c);null!=m&&(rb.title=m);t.appendChild(rb);sb=n("button");hb&&(sb.className="step forward");sb.innerHTML=h[1];sb.addEventListener("click",function(){G(!1);Bb(1);W()},!1);null!=c&&sb.setAttribute("style",c);null!=m&&(sb.title=m);t.appendChild(sb)}"first"==l&&(Fb=n("button"),da(Fb,"first","|<","|<",m,"firstlast first"),Fb.addEventListener("click",function(){G(!1);xa(wa(0));W()},!1),t.appendChild(Fb));"last"==l&&(Gb=n("button"),da(Gb,"last",">|",">|",m,"firstlast last"),
Gb.addEventListener("click",function(){G(!1);xa(wa(v-1));W()},!1),t.appendChild(Gb));"firstlast"==l&&(c=e.firstlast_labels,h=null!=c?c.split(","):["<<",">>"],Fb=n("button"),hb&&(Fb.className="firstlast"),Fb.innerHTML=h[0],Fb.addEventListener("click",function(){G(!1);xa(wa(0));W()},!1),c=yc+e.firstlast_style,null!=c&&Fb.setAttribute("style",c),null!=m&&(Fb.title=m),t.appendChild(Fb),Gb=n("button"),hb&&(Gb.className="firstlast"),Gb.innerHTML=h[1],Gb.addEventListener("click",function(){G(!1);xa(wa(v-
1));W()},!1),null!=c&&Gb.setAttribute("style",c),null!=m&&(Gb.title=m),t.appendChild(Gb));"setspeed"==l?(Hb=n("input"),hb&&(Hb.className="setspeed"),Hb.type="range",Hb.min=Vb,Hb.max=Lc,Hb.value=Lc-Aa,null!=m&&(Hb.title=m),c="vertical-align:middle;"+e.setspeed_style,Hb.setAttribute("style",c),Hb.addEventListener("input",function(a){Aa=Lc-parseInt(Hb.value,10)+30;void 0!=sd&&sd(Aa);G(!0);W()},!1),t.appendChild(Hb)):"speed"==l&&(c=e.speed_labels,h=null!=c?c.split(","):["-","+"],Wb=n("button"),hb&&(Wb.className=
"speed slower"),Wb.innerHTML=h[0],Wb.addEventListener("click",function(){Aa+=yf;Xb.disabled=!1;Aa>Lc&&(Aa=Lc,Wb.disabled=!0);void 0!=sd&&sd(Aa)},!1),c=yc+e.speed_style,null!=c&&Wb.setAttribute("style",c),null!=m&&(Wb.title=m),t.appendChild(Wb),Xb=n("button"),hb&&(Xb.className="speed faster"),Xb.innerHTML=h[1],Xb.addEventListener("click",function(){Aa-=yf;Wb.disabled=!1;Aa<Vb&&(Aa=Vb,Xb.disabled=!0);void 0!=sd&&sd(Aa)},!1),null!=c&&Xb.setAttribute("style",c),null!=m&&(Xb.title=m),t.appendChild(Xb));
"zoom"==l&&(za=n("button"),da(za,"zoom","Zoom","Un-zoom",m,"zoom off"),za.addEventListener("click",HAniS.toggleZooming,!1),t.appendChild(za),ya=!1);if("annotate"==l){de=n("button");da(de,"annotate","Annotate","Finished",m,"annotate");ka=n("div");ka.setAttribute("style","position:absolute;box-sizing:content-box;height:120px;width:180px;top:20px;left:20px;z-index:15;visibility:hidden;background-color:lightgray;border-width:6px;border-style:solid;border-color:magenta;border-radius:25px;padding:10px;font:normal normal normal 16px Arial;color:black;");
ka.title="Drag this box around.  Select attributes, then go onto the image and click & drag";Xc=Yc=20;Oe=Ib=!1;qh=3;rh=11;Zc=ee=0;r=[];ka.style["touch-action"]="none";var p=function(a){Yc=a.clientX-Zc;Xc=a.clientY-ee;ka.style.top=Xc+"px";ka.style.left=Yc+"px"};ka.addEventListener("mousedown",function(a){if(0!=a.clientX||0!=a.clientY)Oe=!0,Zc=a.clientX-Yc,ee=a.clientY-Xc},!1);ka.addEventListener("mouseup",function(a){Oe=!1},!1);ka.addEventListener("mouseout",function(a){Oe&&p(a)},!1);ka.addEventListener("mousemove",
function(a){Oe&&p(a)},!1);window.PointerEvent?(ka.addEventListener("pointerdown",function(a){"mouse"!=a.pointerType&&(Zc=a.clientX-Yc,ee=a.clientY-Xc)},!1),ka.addEventListener("pointermove",function(a){"mouse"!=a.pointerType&&(0==Zc&&(Zc=a.clientX,ee=a.clientY),p(a))},!1)):ka.addEventListener("touchmove",function(a){a=a.changedTouches[0];0==Zc&&(Zc=a.clientX,ee=a.clientY);p(a)},!1);de.addEventListener("click",function(){if(Ib=!Ib){r=[];Yc=y.offsetLeft;Xc=y.offsetTop;var a=e.annotate_position;null!=
a&&(a=a.split(","),Yc+=parseInt(a[0],10),Xc+=parseInt(a[1],10));ka.style.top=Xc+"px";ka.style.left=Yc+"px";ka.style.visibility="visible";I(de,!1,"annotate off");ci=ya;ya=!1;null!=za&&(za.disabled=!0)}else ka.style.visibility="hidden",I(de,!0,"annotate on"),ya=ci,null!=za&&(za.disabled=!1);X()},!0);fe=sh("Color Black White Red Green Blue Yellow Orange Cyan Magenta".split(" "),"black black white red green blue yellow orange cyan magenta".split(" "),function(a){});zc=sh("Width 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),
[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==ge.selectedIndex?rh=zc.selectedIndex:qh=zc.selectedIndex});zc.title="Select width or font size";ge=sh("Type Arrow Circle Box Polygon Draw Text".split(" "),[-1,0,1,2,3,4,5],function(a){6==ge.selectedIndex?(Jb.focus(),Jb.select(),zc.selectedIndex=rh):zc.selectedIndex=qh;0==fe.selectedIndex&&(fe.selectedIndex=2)});c=n("button");c.style.width="70px";c.style.margin="5px";c.innerHTML="Erase";c.title="Erase last item";c.addEventListener("click",
function(){0<r.length&&(r.pop(),X())},!1);Jb=n("input");Jb.type="text";Jb.style.width="150px";Jb.style.margin="5px";Jb.title="Enter your text here, then click where you want it";Jb.value="Text input";h=e.annotate_defaults;null!=h&&(h=h.split(","),ge.selectedIndex=parseInt(h[0],10),1<h.length&&(fe.selectedIndex=parseInt(h[1],10)),2<h.length&&(zc.selectedIndex=parseInt(h[2],10)),3<h.length&&(Jb.value=h[3].trim()));h=n("div");h.innerHTML="Annotation Tools";var ib=n("div");ib.appendChild(ge);ib.appendChild(fe);
var u=n("div");u.appendChild(zc);u.appendChild(c);c=n("div");c.appendChild(Jb);ka.appendChild(h);ka.appendChild(ib);ka.appendChild(u);ka.appendChild(c);t.appendChild(de);y.appendChild(ka)}"saveall"==l&&(Mf=n("button"),da(Mf,"saveall","SaveAll","SaveAll",m,"saveall"),th=e.saveall_prompt,ec=e.saveall_filename,c=e.saveall_list,uh=null==c?["0"]:c.split(","),Mf.addEventListener("click",function(){for(var a=0;a<uh.length;a++)for(var b=parseInt(uh[a],10),c=0;c<ta.length;c++){0===c&&null!=th&&(ec=window.prompt(th,
ec),null!=ec&&1>ec.length&&(ec=null));var d=null==ec?"":-1!=ec.indexOf("#")?ec.replace("#",c.toString()):ec+c;var g=document.createElement("a");g.href=0==b?ta[c]:fa[c][b-1];g.download=d;d=new MouseEvent("click");g.dispatchEvent(d)}},!1),t.appendChild(Mf));if("capture"==l){Nf=n("button");da(Nf,"capture","Capture","Capture",m,"capture");var B=e.capture_prompt;Of=e.capture_filename;null==Of&&(Of="haimage.png");Nf.addEventListener("click",function(){var a=Of;if(null!=B&&(a=window.prompt(B,a),null==a))return;
var b=n("canvas");b.height=nb.height;b.width=nb.width;var c=b.getContext("2d");be=!1;X();c.drawImage(nb,0,0);c.drawImage(oc,0,0);be=!0;b.toBlob(function(b){var c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;d.download=a;c=new MouseEvent("click");d.dispatchEvent(c);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);t.appendChild(Nf)}"show"==l&&(Pf=n("button"),da(Pf,"show","Show","Show",m,"show"),Qf=e.show_prompt,di=e.show_image_file,null==Qf&&(Qf="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),
Pf.addEventListener("click",function(){if(di)window.open(ta[q]);else{var a=nb.toDataURL("image/png;base64;");var b=window.open();b.document.write(Qf+"<img src="+a+"></img>")}},!1),t.appendChild(Pf));"toggle"==l&&(Ra=[],c=e.toggle_size,null!=c?(c=c.split(","),td=parseInt(c[0],10),Pe=parseInt(c[1],10),Qe=parseInt(c[2],10)):(Pe=td=10,Qe=3),vh="red",wh="blue",xh="orange",yh=!1,w(e.toggle_layout_width,"t")&&(yh=!0),c=e.toggle_colors,null!=c&&(c=c.split(","),wh=c[0].trim(),vh=c[1].trim(),xh=c[2].trim()),
xb=n("div"),xb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),xb.style.backgroundColor=t.style.backgroundColor,xb.align=Fd,zh=new PEvs(xb,null,null,null,null,HAniS.togclick,null),$c=n("canvas"),$c.height=2*Pe,Rf=$c.getContext("2d"),xb.appendChild($c),a?y.insertBefore(xb,Oa):y.appendChild(xb),c=e.toggle_onoff,Re=null,null!=c&&(Re=c.split(",")),
Sf=!0,null!=m&&(xb.title=m));if("overlay"==l||"menu"==l){E=[];h=e.overlay_tooltip;c=null;null!=h&&(c=h.split(","));h=e.overlay_radio;ib=null;null!=h&&(ib=h.split(","));var A=e.overlay_labels_color;u=null;null!=A&&(u=A.split(","));A=!1;"menu"==l&&(A=!0);Zd=[];var z=e.overlay_caching;l=null;null==z&&(z=e.overlay_static);null!=z&&(l=z.split(","));var F=!0;null!=e.overlay_nonewdiv&&(F=!1);for(z=0;z<Sb.length;z++){var M=Sb[z].trim();if(0==z||0==M.indexOf("/"))0==M.indexOf("/")&&(M=M.substr(1)),A?(ud=n("div"),
ud.setAttribute("style","text-align:left;display:block;visibility:hidden;position:absolute;border-style:solid;border-width:2px;background:#ffffff;z-index:999;"+e.overlay_labels_style),Tf++):F?(Kb=n("div"),Tf++,Kb.align="center",a?y.insertBefore(Kb,Oa):y.appendChild(Kb)):(Kb=n("span"),t.appendChild(Kb)),f=e.overlay_labels_style,A||null==f||Kb.setAttribute("style",f);var C=!1;f=M.length;0<M.indexOf("/on")&&M.indexOf("/on")==f-3&&(C=!0,M=M.substr(0,f-3));var x=!1;0<M.indexOf("/always")&&M.indexOf("/always")==
f-7&&(x=C=!0);var H=!1;0<M.indexOf("/hidden")&&(H=!0);var K=!1;0<M.indexOf("/hotspots")&&(K=!0,M=M.substr(0,M.indexOf("/")));null!=l?w(l[z],"y")||w(l[z],"t")?Zd[z]=!0:Zd[z]=!1:Zd[z]=!0;E[z]=n("input");E[z].type="checkbox";E[z].value=M;E[z].id=M;E[z].showMe=!(x&H)&!K;var D="vertical-align:middle;";f=e.checkbox_style;null!=f&&(D+=f);E[z].setAttribute("style",D);E[z].checked=C;E[z].restorableState=C;E[z].name=0;E[z].hotspotIndex=K;null!=Ba&&z==ob&&E[z].checked&&(Ba.disabled=!1);null!=qc&&!qc[z]&&C&&
(dd=!1);E[z].addEventListener("click",HAniS.overClick,!1);null!=h&&(f=ib[z].indexOf("/"),-1!=f&&(E[z].name=ib[z].substr(f+1).trim()),w(ib[z],"t")&&(E[z].type="radio",-1==f&&(E[z].name="all")));E[z].isGhost=!0;x||H||(null!=c&&(E[z].title=c[z]),x=n("label"),x.htmlFor=M,null!=c&&(x.title=c[z]),x.innerHTML=M,x.name=E[z].name,M="vertical-align:middle;",null!=u&&(M=M+"color:"+u[z]+";"),x.setAttribute("style",M),M=n("span"),f="10",null!=we&&(f=10+we[z]),M.appendChild(E[z]),M.appendChild(x),A?(M.setAttribute("style",
"display:block;margin-right:5px;"),ud.appendChild(M)):(M.setAttribute("style","margin-left:"+f+"px;"),Kb.appendChild(M)),E[z].isGhost=!1)}if(A){var J=n("button");da(J,"menu","Show Overlay Menu","Hide Menu",m,"menu off");J.addEventListener("click",function(a){"hidden"===ud.style.visibility?(ud.style.visibility="visible",I(J,!1,"menu on")):(ud.style.visibility="hidden",I(J,!0,"menu off"))},!1);t.appendChild(J);y.insertBefore(ud,Oa)}if(null==Tb)for(Tb=Array(Sb.length),z=0;z<Sb.length;z++)Tb[z]=0;else for(z=
0;z<Sb.length;z++)La(z)}}Sa=!0;Me=null;f=e.start_looping;null!=f&&(c=f.split(","),w(c[0],"f")&&(Sa=!1),1<c.length&&(xc=parseInt(c[1],10)-1,isNaN(xc)&&(xc=0),q=xc),2<c.length&&(w(c[2],"t")&&(Me=!0),w(c[2],"f")&&(Me=!1)));G(Sa)}function La(b){var a;if(0>Tb[b]){var d=!1;for(a=0;a<Sb.length;a++)Tb[a]!=-Tb[b]||d||(d=E[a].checked);E[b].checked=d}}function Mb(b){0==lb&&(mb=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var a=b[4].trim(),d=b[4].indexOf("/"),c=b[4].indexOf("?"),g=-1,k=-1;-1!=d&&(g=parseInt(b[4].substring(d+
1),10)-1,a=a.substring(0,d));-1!=c&&(k=parseInt(b[4].substring(c+1),10)-1,c<d||-1==d)&&(a=a.substring(0,c));mb[lb]=new Ab(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),a.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),g,k,8==b.length?b[7].trim():null);lb+=1}function Bc(b){0==Ke&&(Qa=[],pa=null);var a=b.substr(b.indexOf("=")+1).trim().split("(");b=a[0].split(",");var d=b[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));Qa[Ke]=new Ma(d,b[1].trim(),b[2].trim(),b[3].trim(),
a[1].trim());Ke+=1}function bd(b){0==ub&&(Fa=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");Fa[ub]=new lc(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");ub+=1}function Ma(b,a,d,c,g){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=a;this.value=d;this.tip=c;this.poly=g;b=g.split(",");this.xy=[];this.ymin=
this.xmin=9999;for(a=this.ymax=this.xmax=0;a<b.length;a++)this.xy[a]=parseInt(b[a].trim(),10),0==a%2?(this.xy[a]<this.xmin&&(this.xmin=this.xy[a]),this.xy[a]>this.xmax&&(this.xmax=this.xy[a])):(this.xy[a]<this.ymin&&(this.ymin=this.xy[a]),this.xy[a]>this.ymax&&(this.ymax=this.xy[a]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=n("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=
this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(a=2;a<this.xy.length;a+=2)this.ctx.lineTo(this.xy[a]-this.xmin,this.xy[a+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function lc(b,a,d,c,g){this.overlay=b;this.color=a;this.action=d;this.value=c;this.tip=g}function Ab(b,a,d,c,g,k,e,f,h,p){this.x0=b;this.y0=a;this.icon=null;this.isIcon=!1;if("icon"==d)this.icon=new Image,this.icon.hotspot=this,Uf=!0,this.icon.onload=
function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.zoomme=this.fromfile=this.anim=!1,this.icon.gotit=!1,this.icon.src=c.trim();else if("sprite"==d||"spritefn"===d){this.x0=b;this.y0=a;this.inx=parseInt(c,10)-1;he=!1;ug?null!=ja&&
(-1!=Qc?this.inx>=Qc&&this.inx<=Qc+ja.length&&(he=!0):"spritefn"===d&&(he=!0)):he=!0;if(he){-1!=Qc&&(this.inx-=Qc);if(this.inx>=ja.length)return null;this.x1=ja[this.inx].width+b;this.y1=ja[this.inx].height+a;this.width=ja[this.inx].width;this.height=ja[this.inx].height;this.w2=this.width/2;this.h2=this.height/2;this.origY=this.origX=0;this.icon=ja[this.inx].cloneNode();this.anim=ja[this.inx].anim;this.fromfile=ja[this.inx].fromfile;this.zoomme=ja[this.inx].zoomme;this.anim&&(this.icon.setAttribute("style",
"position:absolute;top:0px;left:0px;visibility:hidden;"),uc.appendChild(this.icon))}else this.x1=Qb[this.inx]+b,this.y1=Rb[this.inx]+a,this.width=Qb[this.inx],this.height=Rb[this.inx],this.w2=Qb[this.inx]/2,this.h2=Rb[this.inx]/2,this.origX=nf[this.inx],this.origY=of[this.inx],this.icon=mf,this.zoomme=this.fromfile=this.anim=!1;Uf=this.isIcon=!0;this.icon.gotit=!0}else this.width=parseInt(d,10),this.height=parseInt(c,10),this.x1=this.width+b,this.y1=this.height+a,this.w2=this.width/2,this.h2=this.height/
2;this.pan=g;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=k;this.value=e;this.overlay=f;this.frame=h;this.tip=p}function Wa(){if(vd&&!jd){T=-1;for(var b=0;b<ma.length;b++)x>=ma[b]&&(T=b)}}function Nb(){null!=Zb?cb=Zb.toLatLon(qa,ra):null!=Cf?(cb[0]=Cf+(Xh-Cf)*ra/ia,cb[1]=kh+(Yh-kh)*qa/na):(cb[0]=Math.round(qa),cb[1]=Math.round(ra))}function Ob(b,a){"popup"==b.action?(null!=Vf&&Vf.close(),Vf=window.open("","HAniSPopup","scrollbars=yes,width="+Yg+",height="+Xg),Vf.document.write(Wg+b.value+
"</div>")):"link"==b.action?(b=b.value,Nb(),b=b.replace("%LATITUDE%",cb[0].toFixed(4)),b=b.replace("%LONGITUDE%",cb[1].toFixed(4)),b=b.replace("%FRAMENUMBER%",q+1),window.open(b,"_blank","")):"fof"==b.action&&(ea=Lg,HAniS.resetZoom(),HAniS.newFOF(b.value,!0),cf(a))}function Bd(){var b=Sg?Pd/x:0;P+b<Pd&&(P=Pd-b);b=Ug?Qd/x:0;P+ab-b>na-Qd&&(P=na-ab+b-Qd);b=Qg?Od/H:0;O+b<Od&&(O=Od-b);b=Og?Nd/H:0;O+$a-b>ia-Nd&&(O=ia-$a-Nd+b);O=Math.round(O);P=Math.round(P)}function Cd(b){var a=!1;b?jd?(T--,0>T?a=!0:(x=
ma[T],H=ma[T])):(x-=.1*id/B,H-=.1*id/C):jd?(T++,T>=ma.length?(T--,xf&&(a=!0)):(x=ma[T],H=ma[T])):(!xf||x!==Kc&&H!==Kc||(a=!0),x+=.1*id/B,H+=.1*id/C,x>Kc&&(x=Kc),H>Kc&&(H=Kc));a||x<=Le||H<=Se?(x=Le,H=Se,T=-1,qa=A,ra=F,O=P=0,$a=ia,ab=na,Pd=Qd=Od=Nd=0,nd&&(kb=!0)):(Nd=Ng,Od=Pg,Qd=Tg,Pd=Rg,P=qa-A/x,O=ra-F/H,$a=Math.floor(ia/H),ab=Math.floor(na/x),Bd(),nd&&(kb=!1));Wa()}function Cc(){Te=0;Lb=Array(2);yb=Array(2);wd=Array(2);Ta=0;gd=null;xa(wa(0))}function G(b){Ca=!b;HAniS.toggleIsLooping()}function Dd(b,
a,d,c,g,k){Vd.clearRect(0,0,S,Y);Vd.imageSmoothingEnabled=Id;K.imageSmoothingEnabled=Id;Vd.drawImage(b,a,d,c,g,0,0,S,Y);Ah=Vd.getImageData(0,0,S,Y);ad=Ah.data;Wf=Xa[k];Xf=Ya[k];Yf=Za[k];Zf=Td[k];ei=4*S*Y;for(fc=0;fc<ei;fc+=4)db=ad[fc],db===ad[fc+1]&&db===ad[fc+2]&&(ad[fc]=Wf[db],ad[fc+1]=Xf[db],ad[fc+2]=Yf[db],ad[fc+3]=Zf[db]);Vd.putImageData(Ah,0,0);K.drawImage(Fe,0,0,S,Y)}function I(b,a,d){null!=b&&(a?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&
b.setAttribute("style",b.style_off),b.innerHTML=b.label_off),hb&&(b.className=d))}function gb(b,a){if(!(b>=v)&&(-2==Ra[b]&&(a=-2),Ra[b]=a,Ef&&1==a&&(jb.value=b+1,ce.innerHTML=Ne.replace("*",b+1)),Sf)){b=Bh+b*(td+Qe);var d=xh;0==a?d=wh:-1==a?d=vh:-2==a&&(d=wg);Rf.fillStyle=d;Rf.fillRect(b,Pe/2,td,Pe)}}function oe(b,a){Sf&&($c.width=yh?parseInt(y.style.width,10):S,Rf.clearRect(0,0,$c.width,$c.height),Bh=$c.width/2-b*(td+Qe)/2);for(var d=0;d<b;d++)a?-1!=Kd?gb(d,-2):null!=Re&&"n"==Re[d].toLowerCase().trim()?
gb(d,-1):gb(d,0):gb(d,Ra[d])}function xa(b){gb(q,0);q=b;gb(q,1);null!=Ja&&null!=bb&&null!=bb[q]&&(Ja.innerHTML=bb[q]);void 0!=Ue&&Ue(q)}function wa(b){b>=v&&(b=v-1);if(0<=Ra[b])return b;var a=-1,d=b;0==d&&(a=1);for(var c=0;c<v-1;c++)if(d+=a,0<=Ra[d])return d;return b}function Bb(b){gb(q,0);var a=b;do 0<a?(a=wa(v-1),q+=1,q>a&&(ie&&Ca?(q=a,b=-b,vb&&G(!1)):vb?(q=a,G(!1)):q=wa(0))):(a=wa(0),--q,q<a&&(ie&&Ca?(q=a,b=-b,vb&&G(!1)):vb?(q=a,G(!1)):q=wa(v-1))),a=b;while(0>Ra[q]);vb=Ve;void 0!=Ue&&Ue(q);Kf=
a;gb(q,1);null!=Ja&&null!=bb&&null!=bb[q]&&(Ja.innerHTML=bb[q])}function fb(b,a,d,c,g,k,e){this.bg=b;null!=b&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=a;null!=a&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=c;null!=c&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=g;this.sxoff=k;this.syoff=e}function Na(b,a,d,c,g){f.globalAlpha=1;f.font=b.font;var k=
b.fontHeight;d=d-k-6;var e=f.measureText(c).width;1==g&&(a-=e);0==g&&(a-=e/2);5>a&&(a=5);5>d&&(d=5);d+k+3>Y&&(d=Y-k-6);a+3+e>S&&(a=S-e-6);f.save();f.beginPath();f.fillStyle=b.bg;null!=b.scolor&&(f.shadowColor=b.scolor,f.shadowBlur=b.sblur,f.shadowOffsetX=b.sxoff,f.shadowOffsetY=b.syoff);We=a-3;$f=d;Ch=e+6;ag=k+6;f.fillRect(We,$f,Ch,ag);f.closePath();f.restore();f.textBaseline="bottom";f.fillStyle=b.fg;f.fillText(c,a,d+k+3)}function X(){f.clearRect(0,0,S,Y);bg=!1;if(eb){f.beginPath();f.lineWidth=2;
f.strokeStyle="white";var b=Ta;1<b&&(b=2);for(var a=0;a<b;a++)1<Ta&&(f.moveTo(Lb[0]/B,yb[0]/C),f.lineTo(Lb[1]/B,yb[1]/C)),f.moveTo(Lb[a]/B-15,yb[a]/C),f.lineTo(Lb[a]/B+15,yb[a]/C),f.moveTo(Lb[a]/B,yb[a]/C-15),f.lineTo(Lb[a]/B,yb[a]/C+15);f.closePath();f.stroke();if(3==Ta){var d=U,c=Q;f.moveTo(d,c);f.fillStyle=rc;f.fillRect(d-2,c-2,5,5);b=xd;a=Math.round(d+Xe/B*je*(xd-wd[1]));for(var g=Math.round(c+ke/C*je*(xd-wd[1])),e=0;300>e;e++){f.beginPath();f.lineWidth=1;f.strokeStyle=rc;f.moveTo(d,c);f.lineTo(a,
g);f.stroke();f.beginPath();f.lineWidth=3;f.rect(a-2,g-2,5,5);f.stroke();if(3>a||a+3>S||3>g||g+3>Y)break;c=$b+b;c=100*Math.floor(c/60)+c%60;c%=2400;Gg?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=0;Math.abs(cg)<fd+5&&(c=45*.0174533);var m=g;0>Dh*cg&&0==c&&(m=g+fd);f.font=Md;d=d+" "+Fg;var l=f.measureText(d).width;f.fillStyle=Ld;0===c?(f.fillRect(a+
2,m-fd-2+c,l+4,fd+3),f.fillStyle=rc,f.textBaseline="bottom",f.fillText(d,a+5,m)):(f.save(),f.translate(a+5,g),f.rotate(c),f.fillRect(2,-2,l+4,fd+3),f.fillStyle=rc,f.textBaseline="bottom",f.fillText(d,5,fd),f.restore());d=a;c=g;a=Math.round(d+je*Dh);g=Math.round(c+je*cg);b+=V}}null!=gd&&Na(tf,fi,gi,gd,0);be&&(Na(Sh,9999,dh,ch[Te],0),Eh=We,Fh=$f,Gh=$f+ag)}if(wb){be&&(0==rd?Na(ph,9999,10,Be[0],0):(Na(bi,10,10,Be[1],0),hi=We+Ch,Na(ph,9999,10,Be[2],0)),ii=We,ji=ag);f.beginPath();f.lineWidth=2;f.strokeStyle=
eh;for(b=0;b<oa.length;b+=2)0==b?f.moveTo(oa[b]/B,oa[b+1]/C):f.lineTo(oa[b]/B,oa[b+1]/C);Ce&4<oa.length&&f.lineTo(oa[0]/B,oa[1]/C);f.stroke();for(b=0;b<oa.length;b+=2)f.beginPath(),f.rect(oa[b]/B-2,oa[b+1]/C-2,5,5),f.stroke()}if(Ib)for(b=0;b<r.length;b++){a=r[b].type;f.beginPath();f.strokeStyle=r[b].color;f.lineWidth=r[b].width;if("0"==a)a=Math.atan2(r[b].xe-r[b].x,r[b].ye-r[b].y),g=r[b].x+r[b].width*Math.sin(a),e=r[b].y+r[b].width*Math.cos(a),f.beginPath(),f.moveTo(g,e),f.lineTo(r[b].xe,r[b].ye),
d=12+r[b].width/5,f.moveTo(g+d*Math.sin(a-.523599),e+d*Math.cos(a-.523599)),f.lineTo(g,e),f.lineTo(g+d*Math.sin(a+.523599),e+d*Math.cos(a+.523599));else if("1"==a)f.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==a)f.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);else if("3"==a){f.moveTo(r[b].xp[0],r[b].yp[0]);for(g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],r[b].yp[g]);f.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==a)for(f.moveTo(r[b].xp[0],r[b].yp[0]),g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],
r[b].yp[g]);else"5"==a&&(f.fillStyle=r[b].color,f.font=r[b].width+"pt arial",a=f.measureText(r[b].text).width,f.fillText(r[b].text,r[b].x-a/2,r[b].y+r[b].width/2));f.stroke()}Vc&&(b=Dc*(Ye-le)/x,a=re*(Ze-me)/H,b=" "+Math.sqrt(b*b+a*a).toFixed(pg)+" "+og+" ",Na(Qh,le/B,me/C,b,-1),f.beginPath(),f.strokeStyle=qg,f.lineWidth=3,f.moveTo(Ye/B,Ze/C),f.lineTo(le/B,me/C),f.stroke(),f.closePath());Eb&&Na(Kg,Hh,Ih,Jh,-1);if(Pb||pd)if(U=la.getX(),A=U*B,Q=la.getY(),F=Q*C,0<=A&&0<=F){qa=P+A/x;ra=O+F/H;if(pd){Nb();
ki=lg+cb[0].toFixed(gf)+"  "+mg+cb[1].toFixed(gf);b=Q;if(Vc||Eb)b=Q+ng.fontHeight+6;Na(ng,U+10,b,ki,-1)}if(Pb&&Nc&&Uc)if(qa=Math.round(qa),ra=Math.round(ra),kf)Ua.clearRect(0,0,1,1),Ua.drawImage(Ga[q],qa,ra,1,1,0,0,1,1),N=Ua.getImageData(0,0,1,1).data,L=0,Ed(!1);else for(b=0;b<ba;b++)if(a=ba-b-1,D[q][a].gotit&&E[a].checked&&(a==ob||null!=pc[a]&&0<=pc[a])){Ua.clearRect(0,0,1,1);a==ob?Ua.drawImage(ac[q],qa,ra,1,1,0,0,1,1):Ua.drawImage(D[q][a],qa,ra,1,1,0,0,1,1);N=Ua.getImageData(0,0,1,1).data;L=pc[a];
null!=L&&Ed(a==ob||ih);break}}!kb||eb||nc||Pb||null==pa||(f.drawImage(pa.can,0,0,pa.width,pa.height,pa.xmin/B,pa.ymin/C,pa.width/B,pa.height/C),Na(Kg,(pa.xmin+pa.xmax)/2/B,(pa.ymin+pa.ymax)/2/C,pa.tip,0),bg=!0)}function Ed(b){$e=999;gc=rg;var a=tb[L].length-1;if(0==N[3])gc=Ee[L];else{if(sg)hc=N[0];else if(b)dg=0,hc=N[0],$e=0;else for(var d=0;d<a;d++)ic[0]=N[0]-Xa[L][d],0>ic[0]*(Xa[L][d+1]-N[0]-1)||(ic[1]=N[1]-Ya[L][d],0>ic[1]*(Ya[L][d+1]-N[1]-1)||(ic[2]=N[2]-Za[L][d],0>ic[2]*(Za[L][d+1]-N[2]-1)||
(yd=Bf[L][d],eg=ic[yd]/Rc[L][d][yd],Kh=Math.abs(ic[Lh[yd]]-eg*Rc[L][d][Lh[yd]])+Math.abs(ic[Mh[yd]]-eg*Rc[L][d][Mh[yd]]),Kh<$e&&(hc=d,$e=Kh,dg=eg))));if(999>$e)gc=Pc[L][hc],-1!=Yb[L][hc]&&(Nh=tb[L][hc],0!=dg&&(Nh+=dg*(tb[L][hc+1]-tb[L][hc])),gc=gc+" "+Nh.toFixed(Yb[L][hc])+" "+Oc[L][hc]);else if(b||0<Gd){var c=-1;if(b)c=N[0];else for(d=0;d<a;d++)if(Math.abs(N[0]-Xa[L][d])<Gd&&Math.abs(N[1]-Ya[L][d])<Gd&&Math.abs(N[2]-Za[L][d])<Gd){c=d;break}-1!=c&&(gc=Pc[L][c],-1!=Yb[L][c]&&(gc=gc+" "+tb[L][c].toFixed(Yb[L][c])+
" "+Oc[L][c]))}}"hide"!=gc&&Na(Rh,U-10,Q,gc,1)}function W(){if(Uc)try{K.clearRect(0,0,S,Y);K.globalAlpha=1;if(!Vg)if(vd&&null!=bc&&0<=T&&bc[T].gotit)K.drawImage(bc[T],P*ma[T],O*ma[T],ab*ma[T],$a*ma[T],0,0,S,Y);else if(Ga[q].gotit&&(null!=pf?Dd(Ga[q],P,O,ab,$a,pf):K.drawImage(Ga[q],P,O,ab,$a,0,0,S,Y)),null!=Ea&&(K.globalAlpha=1,Ga[q].gotit))for(var b=0;b<Ea.length;b+=4)K.drawImage(Ga[q],Ea[b],Ea[b+1],Ea[b+2],Ea[b+3],Ea[b]/B,Ea[b+1]/C,Ea[b+2]/B,Ea[b+3]/C);if(0<ba){for(b=0;b<ba;b++){var a=null!=Hc?Hc[b]:
b;!rf[a]&&E[a].checked&&E[a].showMe&&(null!=xe&&(K.globalAlpha=xe[a]),vd&&0<=T&&null!=ua&&void 0!=ua[a]&&ua[a][T][q].gotit?K.drawImage(ua[a][T][q],P*ma[T],O*ma[T],ab*ma[T],$a*ma[T],0,0,S,Y):D[q][a].gotit&&(null==Ic||1===Ic[a]?null!=Fc&&0<=Fc[a]?Dd(D[q][a],P,O,ab,$a,Fc[a]):K.drawImage(D[q][a],P,O,ab,$a,0,0,S,Y):0===Ic[a]&&K.drawImage(D[q][a],0,0,na,ia,0,0,S,Y)))}if(null!=pb)for(K.globalAlpha=1,b=0;b<ba;b++)if(a=null!=Hc?Hc[b]:b,D[q][a].gotit&&(Eg[a]||E[a].checked)&&pb[a])for(var d=0;d<aa[a].length;d++)K.drawImage(null!=
D[q][a].origImage?D[q][a].origImage:D[q][a],aa[a][d][0],aa[a][d][1],aa[a][d][2],aa[a][d][3],aa[a][d][4]/B,aa[a][d][5]/C,aa[a][d][2]/B,aa[a][d][3]/C);Pb&&X()}oh&&h();if(Uf)for(K.globalAlpha=1,a=0;a<lb;a++)if(null!=mb[a]){var c=mb[a];null!=c.icon&&(c.icon.style.visibility="hidden");if((-1==c.frame||c.frame==q)&&null!=c.icon&&c.icon.gotit&&(-1==c.overlay||-1!=c.overlay&&E[c.overlay].checked)){if(c.isPan){c.zoomme&&(c.icon.style.width=Math.round(c.width*x)+"px",c.icon.style.height=Math.round(c.height*
H)+"px",c.w2=Math.round(c.width*x/2),c.h2=Math.round(c.height*H/2));var g=Math.round(((c.x0-P)*x-c.w2)/B);var e=Math.round(((c.y0-O)*H-c.h2)/C);if(c.anim){if(0>=g+c.icon.width||g>=na||0>=e+c.icon.height||e>=ia)continue;c.icon.style.top=e+"px";c.icon.style.left=g+"px"}else K.drawImage(c.icon,c.origX,c.origY,c.width,c.height,g,e,c.width/B,c.height/C)}else K.drawImage(c.icon,c.origX,c.origY,c.width,c.height,c.x0/B,c.y0/C,c.width/B,c.height/C);c.icon.style.visibility="visible"}}}catch(m){ha("Error:"+
m)}}function sa(b,a,d){!Ae||d>=a||(K.save(),K.fillStyle="blue",K.strokeStyle="white",K.lineWidth=3,K.strokeRect(Ge,He,200,18),K.fillRect(Ge,He,d/a*200,18),a=K.measureText(b).width,K.fillStyle="orange",K.font="14px arial",K.fillText(b,Ge+100-a/2,He+14),K.restore())}function h(){Ae&&Db>Ha?sa("Loading Images",Db,Ha):(oh=!1,ff&&(mc.style.visibility="hidden"));Ha>=Db&&!Ca&&xa(wa(q));void 0!=Ie&&Ha>=Db&&Ie(!0)}function ha(b){if(pe&&ef&&!ef.closed)try{ef.document.write(b+"<br>")}catch(a){}}function ai(){Ca&&
Bb(Kf);li=q==wa(v-1)?tg+Aa:Aa;W();setTimeout(function(){ri(ai)},li)}function af(b){for(;-180>b;)b+=360;for(;180<b;)b-=360;return b}function pi(){var b,a,d,c,g,e,f,l,h=Math.PI/180;this.init=function(c){for(var d=[],k=1;k<c.length;k++)d[k]=parseFloat(c[k]);a=d[1];b=d[4]/d[5];g=d[6];e=d[7];c=this.toXY(d[2],d[3]);g=c[0];e=c[1]};this.toXY=function(k,f){d=b*af(f-a)*h-g;c=-b*k*h-e;return[d,c]};this.toLatLon=function(c,d){f=-(d+e)/b/h;l=af((c+g)/b/h+a);return[f,l]}}function oi(){var b,a,d,c,g,e,f,l,h,p,n,
r,v,u,q,z,A,M,y,x,t,C,B,E,F,w,G,H,I,J,K,D=Math.PI/180;this.init=function(c){for(var d=[],g=1;g<c.length;g++)d[g]=parseFloat(c[g]);b=d[1];a=d[2];x=0==d[8]?!1:!0;t=d[6];C=t*t;B=C*C;E=B*C;F=B*B;f=d[5]/d[7];K=d[7];x?(l=Math.cos(D*b),h=Math.sin(D*b)):(l=Math.cos(-b*D),h=Math.sin(-b*D));A=l/Math.sqrt(1-C*h*h);y=(1-t*h)/(1+t*h);z=x?Math.tan(Math.PI/4-b*D/2)/Math.pow(y,t/2):Math.tan(Math.PI/4- -b*D/2)/Math.pow(y,t/2);u=d[9];q=d[10];c=this.toXY(d[3],d[4]);u=c[0];q=c[1]};this.toXY=function(k,h){x?(g=D*k,e=
D*(h-a)):(g=D*-k,e=D*(a-h));y=(1-t*Math.sin(g))/(1+t*Math.sin(g));M=Math.tan(Math.PI/4-g/2)/Math.pow(y,t/2);w=90!=b&&-90!=b?f*A*M/z:2*f*K*M/Math.sqrt(Math.pow(1+t,1+t)*Math.pow(1-t,1-t));d=w*Math.sin(e);c=w*Math.cos(e);x||(d=-d,c=-c);p=d-u;n=c-q;return[p,n]};this.toLatLon=function(e,k){d=e+u;c=k+q;w=Math.sqrt(d*d+c*c);M=90==b||-90==b?w*Math.sqrt(Math.pow(1+t,1+t)*Math.pow(1-t,1-t))/(2*f*K):w*z/(f*A);G=Math.PI/2-2*Math.atan(M);H=Math.sin(2*G);I=Math.sin(4*G);J=Math.sin(6*G);g=G+H*C/2+5*H*B/24+H*E/
12+13*H*F/360+7*I*B/48+29*I*E/240+811*I*F/11520+7*J*E/120+81*J*F/1120+4279*Math.sin(8*G)*F/161280;x?(r=g/D,v=Math.atan2(d,c)/D+a):(r=-g/D,v=-Math.atan2(-d,-c)/D+a);return[r,af(v)]}}function qi(){var b,a,d,c,g,e,f,h,p,n,r,t,v,u,q,z,y,x,A,C,B,F,E,w,D,G,H,I,J,K,L,R,P,O,Q,N=Math.PI/180;this.init=function(c){for(var g=[],e=1;e<c.length;e++)g[e]=parseFloat(c[e]);b=g[1];a=g[2];d=g[3];w=g[7];D=w*w;G=D*D;H=G*D;I=G*G;h=g[6]/g[8];p=Math.cos(N*b);n=Math.cos(N*a);t=Math.sin(b*N);r=Math.sin(a*N);B=p/Math.sqrt(1-
D*t*t);F=n/Math.sqrt(1-D*r*r);A=Math.sqrt((1-t)/(1+t)*Math.pow((1+w*t)/(1-w*t),w));C=Math.sqrt((1-r)/(1+r)*Math.pow((1+w*r)/(1-w*r),w));L=(Math.log(B)-Math.log(F))/(Math.log(A)-Math.log(C));R=B/(L*Math.pow(A,L));O=h*R*Math.pow(A,L);y=g[9];x=g[10];c=this.toXY(g[4],g[5]);y=c[0];x=c[1]};this.toXY=function(a,b){e=N*a;f=N*af(b-d);Q=Math.sin(e);E=Math.sqrt((1-Q)/(1+Q)*Math.pow((1+w*Q)/(1-w*Q),w));K=h*R*Math.pow(E,L);P=L*f;c=K*Math.sin(P);g=O+K*Math.cos(P);v=c-y;u=g-x;return[v,u]};this.toLatLon=function(a,
b){c=a+y;g=b+x;K=Math.abs(L)/L*Math.sqrt(c*c+(O-g)*(O-g));E=Math.pow(K/(h*R),1/L);J=Math.PI/2-2*Math.atan(E);P=0>L?Math.atan(-c/(g-O)):Math.atan(c/(O-g));f=P/L;e=J+(D/2+5/24*G+H/12+13/360*I)*Math.sin(2*J)+(7/48*G+29/240*H+811/11520*I)*Math.sin(6*J)+(7/120*H+81/1120*I)*Math.sin(6*J)+4279/161280*I*Math.sin(8*J);q=e/N;z=af(d-f/N);return[q,z]}}var vg,Y,S,ia,na,B,C,fh,gh,Fb,Gb,mc,ff,la,pe,Vf,ef,yc,fg,qf=!1,y,t,If,Jf,Oa,uc,ld,nb,K,Ua,oc,f,Ud,Hf,Jc,uf,ze,nh,vf,vc,v,ta,Zg,ud,ba,rf,Sb,Hc,fa,wc,Tb,hd,ea,Lg,
Ga,D,E,xe,Zd,Eb,Jh,Hh,Ih,ed,Jd,xg,J,yg,gg,Oh,U,Q,A,F,qa,ra,ab,$a,P,O,be,hb,xc,$h,Ca,Sa,Me,q,Ue,Kf,ie,tc,kd=!0,ve,hg,qe,e,Aa,Vb,Lc,sd,Ie,yf,tg,li,Id,Ba,md,Gc,ob,Pa,ac,Sc,Yd,Ff,Je,pf,Fe,Vd,Ah,ad,db,Wf,Xf,Yf,Zf,ei,fc,Fc,Ra,td,Pe,Qe,yh,xb,Bh,zh,vh,wh,xh,Kd,wg,mb,lb,Uf,wf,Af,ja,Qc,he,lh,ub,Fa,N,ig,Qa,Ke,kb,nd,Gf,Xd,pa,bg,qc,dd,ma,T,bc,Tc,ua,Ia,vd,bb,Ja,Ac,Sf,Re,$c,Rf,Uc,cd,Cb,sb,rb,Hb,Xb,Wb,we,Wc,wb,rd,Be,zf,Ce,eh,oa,bi,ph,ii,hi,ji,cc,eb,Ta,Lb,yb,wd,Eh,ch,Fh,Gh,dh,Sh,qb,je,Xe,ke,Ph,Sd,Df,Dh,cg,xd,V,Te,
$b,ye,Fg,rc,Ld,Md,fd,Gg,Hg,di,Pf,Qf,Nf,Of,de,r,Mf,th,ec,uh,ka,Ib,Zc,ee,Yc,Xc,Oe,ci,ge,fe,zc,Jb,qh,rh,za,Mg,id,x,H,Le,Se,bh,sc,Rd,ah,$g,ya,Kc,jd,bf,xf,zg=!1,Ag,Bg,Cg,sf,Dg,vb,Ve,$d,ae,jb,Ne,ce,Ef,dc,nc,Ye,Ze,pg,se,We,$f,Ch,ag,mh=!0,Wd,kg,le,me,Qh,qg,jf,Da,hf,te,Vc,Dc,re,og,Kg,od,pd,gf,lg,mg,ng,Zb,cb,ki,Cf,kh,Xh,Yh,Ea,Kb,Tf,Ic,pb,aa,Eg,Lf,De,Mc,Wg,Yg,Xg,pc,Pb,qd,ue,Nc,Oc,Pc,Yb,yd,$e,Rh,rg,Gd,sg,kf,tf,Ig,Jg,gd,fi,gi,hc,dg,eg,Lh,Mh,ic,L,Kh,gc,Nh,tb,u,Rc,ih,Xa,Ya,Za,Td,Bf,Ee,mi,Hd,lf,Ec,Ae,mf,nf,of,Qb,
Rb,ug,oh,Ge,He,Ha,Db,Nd,Vg,Ng,Od,Pg,Pd,Rg,Og,Qg,Ug,Sg,Qd,Tg,Fd,Ub,si="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),ri=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},n=function(b){return document.createElement(b)},w=function(b,a){if(null!=b)return 0==b.trim().toLowerCase().indexOf(a)},Zh=function(b,a){if(null!=b)return b=b.trim(),b.lastIndexOf(a)===b.length-1},Wh=function(b){void 0==
fg&&(fg=n("textarea"));fg.innerHTML=b;return fg.value},sh=function(b,a,d){var c=n("select");c.style.width="70px";c.style.margin="5px";for(var g=0;g<b.length;g++){var e=n("option");e.innerHTML=b[g];e.value=a[g];c.add(e)}c.addEventListener("change",d,!1);return c},Vh=function(b){b=b.split(",");fa=Array(v);for(var a=0;a<b.length;a++){var d=b[a].split("&");ba=b.length;for(var c=0;c<v;c++)0===a&&(fa[c]=Array(ba)),fa[c][a]=d[1==d.length?0:c].trim(),null!=Ub?fa[c][a]=(Ub+fa[c][a]).trim():null!=ea&&(fa[c][a]=
(ea+fa[c][a]).trim())}cd=!1},Th=function(b){b=b.split(",");v=b.length;ta=Array(v);for(var a=0;a<v;a++)ta[a]=null!=ea?ea+b[a].trim():b[a].trim();cd=!1;v>ba&&(ba=0)},Uh=function(b,a,d){var c=b;null!=ea&&(c=ea+b);ta=Array(v);for(var g=0;g<v;g++){b=g*d+a;if(0<=c.indexOf("*"))ta[g]=c.replace("*",b);else if(0<=c.indexOf("?")){for(var f=c;0<=f.lastIndexOf("?");){var h=f.lastIndexOf("?");f=f.substring(0,h)+b%10+f.substring(h+1);b=Math.floor(b/10)}ta[g]=f}else ta[g]=c+g;ha("image filename = "+ta[g])}b=e.reverse_order;
null!=b&&w(b,"t")&&ta.reverse();cd=!1;v>ba&&(ba=0)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(b,a,d){d=window.atob(this.toDataURL(a,d).split(",")[1]);for(var c=d.length,g=new Uint8Array(c),e=0;e<c;e++)g[e]=d.charCodeAt(e);b(new Blob([g],{type:a||"image/png"}))}});this.setup=function(b,a,d,c){void 0==a&&(a="MORdivcan");Wd=d;void 0!=Wd&&1>Wd.trim().length&&(Wd=null);kg=void 0!=c?c.split("\n"):null;y=document.getElementById(a);Fd="center";
y.align=Fd;Oa=n("div");Oa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");nb=n("canvas");nb.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");K=nb.getContext("2d");oc=n("canvas");oc.setAttribute("style","position:absolute;top:0;left:0;z-index:6;");f=oc.getContext("2d");f.imageSmoothingEnabled=!1;Ud=n("canvas");Ud.setAttribute("style",
"position:absolute;top:0;left:0;z-index:10;");Hf=Ud.getContext("2d");Hf.imageSmoothingEnabled=!1;uc=n("div");uc.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;border-width:0px;padding:0px;margin:0px;");ld=n("div");ld.setAttribute("style","position:absolute;top:0;left:0;z-index:10;overflow:hidden;border-width:0px;padding:0px;margin:0px;");ld.appendChild(Ud);Fe=n("canvas");Oa.appendChild(ld);Oa.appendChild(nb);Oa.appendChild(oc);Oa.appendChild(uc);y.appendChild(Oa);la=
new PEvs(Oa,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);y.setAttribute("tabindex",0);y.addEventListener("keyup",function(a){Ib||qe||(hg=!1,a.preventDefault(),a.stopPropagation())},!1);y.addEventListener("keypress",function(a){Ib||qe||(a.preventDefault(),a.stopPropagation())},!1);y.addEventListener("keydown",function(a){Ib||qe||(a.preventDefault(),a.stopPropagation(),hg=a.ctrlKey?!0:!1,37==a.keyCode?(G(!1),Bb(-1),W()):39==a.keyCode?(G(!1),Bb(1),W()):32==a.keyCode?HAniS.toggleIsLooping():
82==a.keyCode&&a.altKey&&HAniS.resetZoom())},!1);ld.addEventListener("mouseenter",function(a){y.focus()},!1);y.style.outlineWidth="0px";y.style.outline="none";y.focus();xc=q=0;ie=!1;Kf=1;Ve=vb=!1;Sa=Ca=!0;lb=ba=v=0;ve=!0;Hc=null;tc=!0;Aa=500;Vb=100;Lc=2E3;yf=30;tg=0;lf=6E4;Ec=null;Jc=Hd=!1;ze=!0;vc=[];ma=Lg=hd=Ub=ea=null;vd=!1;T=-1;jd=!1;Se=Le=H=x=1;bf=!1;O=P=$a=ab=ra=qa=F=A=Q=U=0;bh=!1;kd=mh=!0;Sf=ff=qf=!1;Kd=-1;Ra=[];ub=0;Uf=!1;ja=null;Qc=-1;Af=0;he=!1;Ja=null;He=Ge=Ha=Db=0;ih=!1;L=0;Eb=vf=wf=Uc=
!1;Ye=Ze=le=me=0;Vc=nc=!1;Da=[];Da.push("default");Da.push("default");hf="default";pd=!1;te="default";Zb=null;cb=[0,0];kb=Ef=se=!1;dd=!0;pa=qc=null;wb=bg=!1;Ce=!0;jf="default";be=!0;oa=[];Pb=kf=!1;ue="default";Nc=!1;Lh=[1,0,0];Mh=[2,2,1];ic=[];pc=[];Gc=md=eb=!1;ye=Te=0;Kb=Jf=If=t=xb=null;Tf=0;Ib=qe=hg=!1;a=n("canvas");a.height=1;a.width=1;Ua=a.getContext("2d");Ua.imageSmoothingEnabled=!1;Gf=n("canvas");pe=!1;"string"===typeof b?0>b.indexOf("\n")?jg(b):p(b.split("\n")):p(b)};this.newBasenames=function(b,
a,d,c){Uc=!1;Sa=Ca;G(!1);v=c;Uh(b,a,d);tc=!0;Ka()};this.newFilenames=function(b){Uc=!1;Sa=Ca;G(!1);Th(b);tc=!0;Ka()};this.newOverlayFilenames=function(b){Uc=!1;Sa=Ca;G(!1);Vh(b);tc=!0;Ka()};this.newProbeTable=function(b){Nc=!1;R(b.trim())};this.reloadFOF=function(){ha("reload FoF = "+Ec);cf("r");cd?ni(mi,!1):(Sa=null==Me?!0:Ca,tc=!0,Ka())};this.getFOF=function(){var b=e.file_of_filenames.trim();HAniS.newFOF(null!=hd?hd+b:b,!0)};this.newFOF=function(b,a){HAniS.resetZoom();ni(b,a)};var ni=function(b,
a){var d,c,e,f,h=new XMLHttpRequest,l,p,r,t,n,u,q,w=null,z=!1;lh=ub;Uc=!1;Sa=Ca;G(!1);a&&xa(xc);ub=v=0;ta=[];J=Qa=null;Oh=[];for(gg=null;uc.hasChildNodes();)uc.removeChild(uc.lastChild);Ke=0;vd=kb=nd=!1;ua=Tc=bc=null;Ia=[];Ac=-1;fa=[];var x=!1;if(null==qb||null!=Sd)qb=[];ha("new FOF="+b);eb&&(null!=cc&&(I(cc,!0,"extrap on"),y.style.cursor="default",G(Sa),Ta=-1),eb=!1,X());wb&&(null!=Wc&&(I(Wc,!0,"mark on"),y.style.cursor="default",G(Sa),rd=-1),wb=!1,X());h.onload=function(){var a=this.responseText.split("\n");
for(d=0;d<a.length;d++)if(!(2>a[d].length)&&(l=a[d].trim(),ha("FOF: "+l),0!=l.indexOf("#")))if(0==l.indexOf("frame_labels"))n=l.split("="),bb=n[1].split(",");else if(0==l.indexOf("redirect"))for(n=l.split("="),q=n[1].split(","),gg=q[0].trim(),c=1;c<q.length;c++){var b=parseInt(q[c],10)-1;Oh[b]=!0}else if(0==l.indexOf("slice")){n=l.split("=");q=n[1].split(",");J=[];for(c=0;c<q.length;c++)J[c]=parseInt(q[c],10);J[2]=J[2]-J[0]+1;J[3]=J[3]-J[1]+1;4<J.length&&(J[6]=J[6]-J[4]+1,J[7]=J[7]-J[5]+1)}else if(0==
l.indexOf("fof_extension"))n=l.split("="),w=n[1].trim();else if(0==l.indexOf("probe_table"))n=l.split("="),Nc=!1,R(n[1].trim());else if(0==l.indexOf("image_base"))n=l.split("="),ea=n[1].trim();else if(0==l.indexOf("overlay_base"))n=l.split("="),Ub=n[1].trim();else if(0==l.indexOf("high_res_basemap")){n=l.split("=");q=n[1].split(",");Tc=[];for(c=0;c<q.length;c++)Tc[c]=q[c].trim(),null!=ea&&(Tc[c]=ea+Tc[c]);vd=!0}else if(0==l.indexOf("high_res_overlay"))for(n=l.split("="),u=n[1].split("&"),e=0;e<u.length;e++){q=
u[e].split(",");Ac=parseInt(q[0].trim(),10)-1;Ia[Ac]=[];for(c=1;c<q.length;c++)Ia[Ac][c-1]=q[c].trim(),Zh(Ia[Ac][c-1],"/")||(null!=Ub?Ia[Ac][c-1]=Ub+Ia[Ac][c-1]:null!=ea&&(Ia[Ac][c-1]=ea+Ia[Ac][c-1]));vd=!0}else if(0==l.indexOf("high_res_zoom")){n=l.split("=");q=n[1].split(",");ma=[];for(c=0;c<q.length;c++)ma[c]=parseFloat(q[c].trim());Wa()}else if(0==l.indexOf("hoverzone"))Bc(l);else if(0==l.indexOf("hotzone"))bd(l);else if(0==l.indexOf("hotspot"))z||(mb=null,lb=0,z=!0),Mb(l);else if(0==l.indexOf("toggle_onoff"))n=
l.split("="),Re=n[1].split(",");else if(0==l.indexOf("coordinates"))n=l.split("="),zb(n[1]);else if(0==l.indexOf("map_scale"))n=l.split("="),q=n[1].split(","),Dc=parseFloat(q[0]),re=1<q.length?parseFloat(q[1]):Dc;else if(0==l.indexOf("times")){n=l.split("=");q=n[1].split(",");for(d=0;d<q.length;d++)qb[d]=parseInt(q[d].trim(),10);x=!0}else{null!=Sd&&(b=l.match(Sd),null!=b&&2==b.length?(qb.push(parseInt(b[1],10)),ha("+ + + Extrap time = "+b[1]),x=!0):ha("+ + + Cannot parse times using "+Sd+" from line: "+
l));e=l.indexOf(" ");0>e&&(e=l.length);ta[v]=l.substring(0,e).trim();null!=ea&&(ta[v]=ea+ta[v]);l=l.substring(e+1);b=l.indexOf('"');0<=b&&(null==bb&&(bb=[]),e=l.substring(b+1),b=e.indexOf('"'),0<=b&&(bb[v]=e.substring(0,b),0==v&&(Ja.innerHTML=bb[0])));fa[v]=[];b=l.indexOf("overlay");if(0<=b)for(p=l.substring(b),b=p.indexOf("="),0>b&&ha("Cannot find a = sign in "+p),r=p.substring(b+1),p=r.trim(),r=p.split(","),ba=r.length,ha("numOverlays set to "+ba),f=0;f<r.length;f++)fa[v][f]=r[f].trim(),null!=gg&&
Oh[f]?fa[v][f]=(gg+fa[v][f]).trim():null!=Ub?fa[v][f]=(Ub+fa[v][f]).trim():null!=ea&&(fa[v][f]=(ea+fa[v][f]).trim());v+=1}x&&va(qb);null!=w?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)2>a[d].length||(t=a[d].trim(),ha("ext_FOF: "+t),0!=t.indexOf("#")&&(0==t.indexOf("hotzone")?bd(t):0==t.indexOf("hotspot")&&Mb(t)));Va()},a.onerror=function(){Va()},a.open("get",w+"?"+Math.round(1E5*Math.random()),!0),a.send()):Va()};mi=b;h.open("get",b+"?"+Math.round(1E5*
Math.random()),!0);h.send()};this.setWindowSize=function(b,a){if(null!=y){y.style.height=a+"px";y.style.width=b+"px";y.style.padding="0px";a=a-(null!=If?If.offsetHeight:0)-(null!=Jf?Jf.offsetHeight:0)-(null!=xb?xb.offsetHeight:0)-Tf*(null!=Kb?Kb.offsetHeight:0);a>ia&&(a=ia);var d=a*na/ia;d>b&&(d=b,a=b*ia/na);a=Math.floor(a);d=Math.floor(d);kd||(zd(d,a),X())}};this.drag=function(b){wb||(U=la.getX(),Q=la.getY(),Ib?(b=r.length-1,r[b].xe=U,r[b].ye=Q,r[b].xp.push(U),r[b].yp.push(Q),r[b].size=Math.round(Math.sqrt(Math.pow(U-
r[b].x,2)+Math.pow(Q-r[b].y,2)))):(A=U*B,F=Q*C,Vc=Eb=!1,nc&&(!se||se&&b.shiftKey)?(le=A,me=F,Vc=!0):(ya&&H!=Se?(P=qa-A/x,O=ra-F/H,Bd(),qa=Math.round(P+A/x),ra=Math.round(O+F/H)):wb||eb||!kb||(pa=null,dd&&0<=A&&0<=F&&(N=Xd.getImageData(A,F,1,1).data,0!=N[3]&&(pa=Qa[N[3]-1]))),bf=!0,W())),X())};this.resetZoom=function(){x=Le;H=Se;T=-1;null!=za&&(I(za,!0,"zoom on"),ya=!1);qa=A;ra=F;O=P=0;$a=ia;ab=na;Wa();W();nd&&(kb=!0)};this.canTip=function(){var b;Eb=!1;U=la.getX();A=U*B;Q=la.getY();F=Q*C;if(!((wb||
eb)&&F<Gh&&F>Fh&&A>Eh)){qa=Math.round(P+A/x);ra=Math.round(O+F/H);if(0!=ub)for(b=0;b<ub;b++)if(Fa[b].overlay>=ba)ha(" Error...hotzone overlay # "+Fa[b].overlay+" > number of overlays = "+ba);else if(E[Fa[b].overlay].checked&&(Ua.clearRect(0,0,1,1),Ua.drawImage(D[q][Fa[b].overlay],qa,ra,1,1,0,0,1,1),N=Ua.getImageData(0,0,1,1).data,ig=(N[0]<<16)+(N[1]<<8)+N[2],ig==Fa[b].color)){Eb=!0;Hh=U;Ih=Q;Jh=Fa[b].tip;break}if(0!=lb)for(b=lb-1;0<=b;b--)if(null!=mb[b]){var a=mb[b];if(-1==a.frame||a.frame==q)if(-1==
a.overlay||E[a.overlay].checked){var d=!1;if(a.isPan)if(a.isIcon){var c=(a.x0-P)*x-a.w2;var e=(a.y0-O)*H-a.h2;A>c&&A<c+a.width&&F>e&&F<e+a.height&&(d=!0)}else c=(a.x0-P)*x,e=(a.y0-O)*H,A>c&&A<c+a.width*x&&F>e&&F<e+a.height*H&&(d=!0);else A>a.x0&&A<a.x1&&F>a.y0&&F<a.y1&&(d=!0);if(d&&null!=a.tip){Eb=!0;Hh=U;Ih=Q;Jh=mb[b].tip;break}}}X()}};this.move=function(){if(!eb&&kb&&(pa=null,dd)){var b=la.getX()*B,a=la.getY()*C;0<=b&&0<=a&&(N=Xd.getImageData(b,a,1,1).data,0!=N[3]&&(pa=Qa[N[3]-1]))}eb&&2<=Ta&&(U=
la.getX(),A=U*B,Q=la.getY(),F=Q*C);X()};this.down=function(){Eb&&(Eb=!1,X());U=la.getX();A=U*B;Q=la.getY();F=Q*C;Ye=A;Ze=F;le=Ye;me=Ze;qa=Math.round(P+A/x);ra=Math.round(O+F/H);bf=!1;if(Ib){var b={};b.x=U;b.y=Q;b.xe=U;b.ye=Q;b.xp=[U];b.yp=[Q];b.type=ge.value;b.color=fe.value;b.width=zc.value;b.text=Jb.value;b.size=0;r.push(b)}};this.up=function(b){Eb=!1;if(!Ib){if(eb||wb){U=la.getX();A=U*B;Q=la.getY();F=Q*C;if(wb){rd=1;if(0<rd&&F/C<ji){if(A/B>ii){oa.pop();oa.pop();0==oa.length&&(rd=0);X();return}if(A/
B<hi){X();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var a=[],d=0;d<oa.length;d+=2)qa=P+oa[d]/x,ra=O+oa[d+1]/H,Nb(),b.document.write(cb[0].toFixed(4)+","+cb[1].toFixed(4)+"<br>"),0==d&&(a[0]=cb[0],a[1]=cb[1]);Ce&&b.document.write(a[0].toFixed(4)+","+a[1].toFixed(4)+"<br>");return}}oa.push(A);oa.push(F);X();return}if(3>Ta)if(Lb[Ta]=A,yb[Ta]=F,wd[Ta]=Df[q],0==Ta)Ta=1,xa(wa(v-1)),Te=1,gd=null;else{Ph=wd[1]-wd[0];Xe=(Lb[1]-Lb[0])/Ph;ke=(yb[1]-yb[0])/Ph;if(null!=tf&&
null!=Dc){d=Xe*Dc;var c=ke*re;a=Math.round(60*Math.sqrt(d*d+c*c));d=Math.atan2(d,-c)/.0174533;0>d&&(d+=360);gd=Ig+si[Math.round(d/22.5)]+" at "+a+" "+Jg;fi=Lb[0];gi=0<ke?yb[0]-15:yb[0]+30}a=parseInt(Md,10);V=Math.round(Math.abs(4*(a+4)/Xe));xd=Math.round(Math.abs(2*(a+4)/ke));xd<V&&(V=xd);120<V?V=120*Math.floor(V/120)+60:90<V?V=120:60<V?V=90:30<V?V=60:15<V?V=30:10<V?V=15:5<V?V=10:2<V?V=5:0==V&&(V=1);xd=wd[1]/V*V+V;je=1;Hg&&(je=-1);Dh=Xe*V;cg=ke*V;xa(wa(v-1));Ta=3;Te=2}else if(F/C<Gh&&F/C>Fh&&A/B>
Eh&&3==Ta){Cc();X();return}X()}if(Vc)Vc=!1,X();else if(null!=dc&&ya&&(nc=!1,I(dc,!0,"distance on")),bf)bf=!1;else if(b.altKey)HAniS.resetZoom();else if(kb&&null!=pa&&bg)Ob(pa,"z");else{U=la.getX();A=U*B;Q=la.getY();F=Q*C;if(0!=ub)for(a=0;a<ub;a++)if(Fa[a].overlay>=ba)ha(" Error...hotzone overlay # "+Fa[a].overlay+" > number of overlays = "+ba);else if(E[Fa[a].overlay].checked&&(Ua.clearRect(0,0,1,1),Ua.drawImage(D[q][Fa[a].overlay],Math.floor(qa),Math.floor(ra),1,1,0,0,1,1),N=Ua.getImageData(0,0,
1,1).data,ig=(N[0]<<16)+(N[1]<<8)+N[2],ig==Fa[a].color)){Ob(Fa[a],"z");return}if(0!=lb)for(a=lb-1;0<=a;a--)if(null!=mb[a]){var e=mb[a];if(!(-1!=e.frame&&e.frame!=q||e.fromfile||-1!=e.overlay&&!E[e.overlay].checked)){var f=!1;e.isPan?e.isIcon?(d=(e.x0-P)*x-e.w2,c=(e.y0-O)*H-e.h2,A>d&&A<d+e.width&&F>c&&F<c+e.height&&(f=!0)):(d=(e.x0-P)*x,c=(e.y0-O)*H,A>d&&A<d+e.width*x&&F>c&&F<c+e.height*H&&(f=!0)):A>e.x0&&A<e.x1&&F>e.y0&&F<e.y1&&(f=!0);if(f){Ob(mb[a],"s");return}}}ya&&(kb=!1,Cd(b.ctrlKey||hg||b.which&&
3==b.which||b.button&&2==b.button));W();X()}}};this.wheel=function(b){Zg?Bb(b):ya&&(U=la.getX(),A=U*B,Q=la.getY(),F=Q*C,qa=Math.round(P+A/x),ra=Math.round(O+F/H),Cd(-1==b))};this.toggleAutoRefresh=function(){Hd?(I(Mc,!1,"autorefresh off"),null!=Ec&&clearInterval(Ec),Hd=!1):(I(Mc,!0,"autorefresh on"),Ec=setInterval("HAniS.reloadFOF();",lf),Hd=!0)};this.toggleLoopRock=function(){ie?(I($d,!0,"looprock rock"),ie=!1):(I($d,!1,"looprock loop"),ie=!0)};this.toggleLoopHalt=function(){vb?(I(ae,!0,"loophalt halt"),
Ve=vb=!1):(I(ae,!1,"loophalt loop"),Ve=vb=!0)};this.toggleExtrap=function(){eb?(null!=cc&&(I(cc,!0,"extrap on"),y.style.cursor=Da.pop(),null!=Cb&&(Cb.disabled=!1),G(Sa),ya=$g,Ta=-1),eb=!1,X()):(null!=cc&&(eb=!0,gd=null,Da.push(y.style.cursor),y.style.cursor="crosshair",I(cc,!1,"extrap off"),Sa=Ca,null!=Cb&&(Cb.disabled=!0),Ca=!1,$g=ya,ya=!1,HAniS.resetZoom(),Cc(),X()),W())};this.doEnhance=function(b){if(md||Gc){var a=Pa[0].height,d=Pa[0].width;b=parseInt(Ba.value,10);0<=b?(Wf=Xa[b],Xf=Ya[b],Yf=Za[b],
Zf=Td[b],pc[ob]=b):pc[ob]=null;var c=a*d*4;for(d=0;d<ac.length;d++)if(Pa[d].gotit){Pa[d].gotit=!1;var e=Je[d].data;var f=Ff[d];if(0>b)for(a=0;a<c;a+=4)e[a]=f[a],e[a+1]=f[a+1],e[a+2]=f[a+2],e[a+3]=f[a+3];else for(a=0;a<c;a+=4)db=f[a],db===f[a+1]&&db===f[a+2]&&(e[a]=Wf[db],e[a+1]=Xf[db],e[a+2]=Yf[db],e[a+3]=Zf[db]);Sc[d].putImageData(Je[d],0,0);Pa[d].gotit=!0}}};this.overClick=function(b){var a;if(b.target.checked)for(a=0;a<E.length;a++)b.target!=E[a]&&0!=b.target.name&&b.target.name==E[a].name&&(E[a].checked=
!1);dd=!0;for(a=0;a<Tb.length;a++)b.target!=E[a]&&La(a),null!=qc&&!qc[a]&&E[a].checked&&(dd=!1),null!=Ba&&a===ob&&(Ba.disabled=!E[a].checked);W()};this.toggleIsLooping=function(){Ca?(Ca=!1,I(Cb,!0,"startstop start")):(Ca=!0,I(Cb,!1,"startstop stop"),Ve=vb,vb=!1)};this.toggleZooming=function(){ya?(HAniS.resetZoom(),I(za,!0,"zoom on")):(I(za,!1,"zoom off"),ya=!0,null!=dc&&(nc=!1,I(dc,!0,"distance on")),nd&&(kb=!0),eb&&HAniS.toggleExtrap())};this.togclick=function(b){var a=zh.getX();zh.getY();for(var d=
Bh,c=0;c<Ra.length;c++){if(a>d&&a<d+td){if(b.shiftKey){0<=Ra[c]&&(G(!1),xa(c));break}b=0;0<=Ra[c]&&(b=-1);gb(c,b);break}d=d+td+Qe}};this.doneLoading=function(b){Ie=b};this.dwellChanged=function(b){sd=b};this.getDwell=function(){return Aa};this.frameChanged=function(b){Ue=b};this.getFrame=function(){return q};this.showFrame=function(b){xa(wa(b))}};
