var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(h){var P=0;return function(){return P<h.length?{done:!1,value:h[P++]}:{done:!0}}};$jscomp.arrayIterator=function(h){return{next:$jscomp.arrayIteratorImpl(h)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,P,J){h!=Array.prototype&&h!=Object.prototype&&(h[P]=J.value)};$jscomp.getGlobal=function(h){h=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,h];for(var P=0;P<h.length;++P){var J=h[P];if(J&&J.Math==Math)return J}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(h,P){this.$jscomp$symbol$id_=h;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:P})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function h(J){if(this instanceof h)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(J||"")+"_"+P++,J)}var P=0;return h}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.asyncIterator;h||(h=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};
$jscomp.iteratorFromArray=function(h,P){$jscomp.initSymbolIterator();h instanceof String&&(h+="");var J=0,N={next:function(){if(J<h.length){var Bb=J++;return{value:P(Bb,h[Bb]),done:!1}}N.next=function(){return{done:!0,value:void 0}};return N.next()}};N[Symbol.iterator]=function(){return N};return N};
$jscomp.polyfill=function(h,P,J,N){if(P){J=$jscomp.global;h=h.split(".");for(N=0;N<h.length-1;N++){var Bb=h[N];Bb in J||(J[Bb]={});J=J[Bb]}h=h[h.length-1];N=J[h];P=P(N);P!=N&&null!=P&&$jscomp.defineProperty(J,h,{configurable:!0,writable:!0,value:P})}};$jscomp.polyfill("Array.prototype.fill",function(h){return h?h:function(h,J,N){var P=this.length||0;0>J&&(J=Math.max(0,P+J));if(null==N||N>P)N=P;N=Number(N);0>N&&(N=Math.max(0,P+N));for(J=Number(J||0);J<N;J++)this[J]=h;return this}},"es6","es3");
function PEvs(h,P,J,N,Bb,ng,gf){var wa,oc,Xa,Ed,hf,Fd,Ma,pc,ea,qe,Na,Qb=0,Gc=0,hd,Oa=!1,qc=!1,Cb=0,Ya=0,Rb=0,Sb=0,Gd,Hd,Tb=function(n){Ma=n.target;for(ea=pc=0;Ma;)pc+=Ma.offsetLeft-Ma.scrollLeft,ea+=Ma.offsetTop-Ma.scrollTop,Ma=Ma.offsetParent;Qb=(Oa?Gd:n.pageX)-pc-document.body.scrollLeft;Gc=(Oa?Hd:n.pageY)-ea-document.body.scrollTop};this.getX=function(){return Qb};this.getY=function(){return Gc};var I=function(n){n.preventDefault();n.stopImmediatePropagation?n.stopImmediatePropagation():n.stopPropagation()},
Id=function(n){Tb(n);hd=Qb;ya=Gc;Z=!0;null!=aa&&(Ed=(new Date).getTime());null!=xa&&xa(n)},G=function(n){Z&&(Tb(n),Z=!1,null!=Db&&Db(n),null!=aa&&(hf=(new Date).getTime(),Fd=hf-Ed,300>Fd&&aa(n)))},ib=function(n){Tb(n);3>Math.abs(Qb-hd)&&3>Math.abs(Gc-ya)||(ya=hd=-9999,Z?null!=Pa&&Pa(n):null!=hb&&hb(n),null!=Jd&&re())};this.touchDown=function(n){Xa=!0;if(1<n.targetTouches.length)return Oa=!0,Na&&(Ya=-1,I(n)),!1;wa=n.changedTouches;oc=wa[0];Id(oc)};this.touchUp=function(n){0==n.targetTouches.length&&
(Oa=Xa=!1);I(n);if(Oa||qc)return Oa||(qc=!1),!1;wa=n.changedTouches;oc=wa[0];G(oc)};this.touchMove=function(n){Xa=!0;I(n);if(Oa)return Na&&(wa=n.targetTouches,Gd=(wa[0].pageX+wa[1].pageX)/2,Hd=(wa[0].pageY+wa[1].pageY)/2,qc=!0,Rb=wa[0].pageX-wa[1].pageX,Sb=wa[0].pageY-wa[1].pageY,Cb=Rb*Rb+Sb*Sb,Tb(n),Na&&0<Ya&&30<Math.abs(Cb-Ya)&&Na(0<Cb-Ya?1:-1),Ya=Cb),!1;wa=n.changedTouches;oc=wa[0];ib(oc)};this.pointUp=function(n){I(n);for(var h=0;h<ta.length;h++)if(ta[h].pointerId==n.pointerId){ta.splice(h,1);
break}0==ta.length&&(Xa=Oa=!1);if(Oa||qc)return Oa||(qc=!1),!1;G(n);return!1};this.pointDown=function(n){I(n);ta.push(n);Ya=-1;Xa=!0;1<ta.length?Oa=!0:Id(n);return!1};this.pointMove=function(n){I(n);for(var h=0;h<ta.length;h++)ta[h].pointerId==n.pointerId&&(ta[h]=n);if(Oa||!qc){if(Oa)return Gd=(ta[0].pageX+ta[1].pageX)/2,Hd=(ta[0].pageY+ta[1].pageY)/2,Tb(n),Na&&(qc=!0,Rb=ta[0].pageX-ta[1].pageX,Sb=ta[0].pageY-ta[1].pageY,Cb=Rb*Rb+Sb*Sb,Na&&0<Ya&&30<Math.abs(Cb-Ya)&&Na(0<Cb-Ya?1:-1),Ya=Cb),!1;ib(n);
return!1}};this.mouseDown=function(n){Xa||(I(n),Id(n))};this.clearDown=function(){Z=!1};this.mouseUp=function(n){Xa||(I(n),G(n))};this.useWheel=function(n){h.addEventListener("wheel",this.mouseWheel,!0);Na=n};this.mouseWheel=function(n){Tb(n);var h=Math.max(-1,Math.min(1,-n.deltaY||-n.detail));I(n);Na&&Na(h)};this.mouseClick=function(h){I(h);Z=!1};this.mouseMove=function(h){Xa||(I(h),ib(h))};this.mouseDragged=function(h){Xa||(I(h),Tb(h),null!=Pa&&Pa(h),null!=Jd&&re())};var re=function(){clearTimeout(qe);
qe=setTimeout(function(){Jd()},600)};var ya=hd=Gc=Qb=0;var xa=P;var Db=J;var hb=N;var Pa=Bb;var aa=ng;var Jd=gf;var Z=Xa=!1;var ta=[];h.addEventListener("mousedown",this.mouseDown,!1);h.addEventListener("mouseup",this.mouseUp,!1);h.addEventListener("mousemove",this.mouseMove,!1);h.addEventListener("click",this.mouseClick,!1);h.addEventListener("touchstart",this.touchDown,!1);h.addEventListener("touchend",this.touchUp,!1);h.addEventListener("touchmove",this.touchMove,!1);h.addEventListener("touchleave",
this.touchUp,!1);h.addEventListener("touchcancel",this.touchUp,!1);h.addEventListener("contextmenu",function(h){h.preventDefault()},!1);h.style["touch-action"]="none";h.addEventListener("mouseout",function(h){Z||(Gc=Qb=-1,null!=hb&&hb(h));Z=!1})};var HAniSF=function(){function h(b){var a,d;id=!0;if(b instanceof Array)for(e={},null!=og&&(b=b.concat(og)),a=0;a<b.length;a++){if(!(2>b[a].length)){var c=b[a].trim();if(0!=c.indexOf("#")){var g=c.indexOf("=");if(!(1>g)){var k=c.substr(0,g).trim().toLowerCase();e[k]=c.substr(g+1).trim()}}}}else e=b;se=!1;a=e.debug;null!=a&&("true"==a?(jf=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),se=!0,ia("HAniS Version 4.30")):se=!1);jb=!0;D(e.set_className,"f")&&(jb=!1);ia("Is type of param an array = "+
(b instanceof Array));a=e.divalign;null!=a&&(Kd=a.trim(),z.align=Kd);D(e.prevent_shortcuts,"t")&&(te=!0);a=e.initial_message;null!=a&&(b=e.initial_message_style,null==b&&(b="background-color:red;top:10px;left:10px;height:100px;width:200px"),b="z-index:99;position:absolute;"+b,rc=t("div"),rc.setAttribute("style",b),rc.innerHTML=a,rc.addEventListener("click",function(){rc.style.visibility="hidden"},!1),rc.style.visibility="visible",Qa.appendChild(rc),b=e.initial_message_timeout,null!=b&&("auto"==b?
kf=!0:(kf=!1,b=parseInt(e.initial_message_timeout,10),2>b&&(b=2),setTimeout(function(){rc.style.visibility="hidden"},1E3*b))));a=e.coordinates;null!=a&&Bb(a);c="green";g="white";k="12px Arial";var m=null,l=d=10,f=10;lf=2;pg="Lat = ";qg=" Lon = ";a=e.coordinates_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(pg=b[3],qg=b[4],lf=parseInt(b[5],10),6<b.length&&(m=b[6].trim(),d=parseInt(b[7],10),l=parseInt(b[8],10),f=parseInt(b[9],10))));rg=new hb(c,g,k,m,
d,l,f);ue=Hc=null;null!=e.map_scale&&(ve=sc=!0,b=e.map_scale.split(","),Hc=parseFloat(b[0]),ue=1<b.length?parseFloat(b[1]):Hc);sg=" ";a=e.distance_unit;null!=a&&(sg=a.trim());a=e.divcan_style;null!=a&&a.trim();mf="default";a=e.distance_cursor;null!=a&&(mf=a.trim());we="default";a=e.location_cursor;null!=a&&(we=a.trim());xe="default";a=e.probe_cursor;null!=a&&(xe=a.trim());nf="default";a=e.mark_cursor;null!=a&&(nf=a.trim());a=e.imagecan_style;null!=a&&(b=a.trim()+";position:absolute;top:0;left:0;",
pb.setAttribute("style",b+"z-index:1;"),tc.setAttribute("style",b+"z-index:6;"));c="blue";g="white";k="12px Arial";m=null;f=l=d=10;tg=1;ug="white";a=e.distance_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),ug=5<=b.length?b[4].trim():g,k=b[2].trim(),tg=parseInt(b[3],10),5<b.length&&(m=b[5].trim(),d=parseInt(b[6],10),l=parseInt(b[7],10),f=parseInt(b[8],10)));Uh=new hb(c,g,k,m,d,l,f);c="black";g="white";k="12px Arial";m=null;f=l=d=10;a=e.probe_display_style;null!=a&&(b=a.split(","),
c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Vh=new hb(c,g,k,m,d,l,f);vg="Undefined";wg=!1;Ld=0;a=e.probe_undefined;null!=a&&(b=a.split(","),vg=b[0].trim(),1<b.length&&(Ld=parseInt(b[1],10)+1),2<b.length&&(wg=!0));of=!1;e.probe_base_image&&(of=!0);a=e.active_probe;null!=a&&(Ub=!0);a=e.pause;null!=a&&(xg=parseInt(a,10));a=e.auto_refresh;null!=a&&(pf=6E4*parseInt(a,10),Ic=setInterval("HAniS.reloadFOF();",pf),Md=!0);
Nd=!1;D(e.enable_smoothing,"t")&&(Nd=!0);ye=!0;D(e.check_image_size,"f")&&(ye=!1);yg=!1;a=e.sprites;if(null!=a){b=a.split(",");qf=new Image;rf=[];sf=[];Vb=[];Wb=[];if("row"==b[1].trim().toLowerCase())for(l=g=c=0,a=2;a<b.length;)for("row"==b[a].trim().toLowerCase()&&(c=0,g+=l,l=0,a+=1),d=parseInt(b[a],10),a+=1,k=parseInt(b[a],10),a+=1,m=parseInt(b[a],10),m>l&&(l=m),a+=1,f=0;f<d;f++)rf.push(c),sf.push(g),Vb.push(k),Wb.push(m),c+=k;else for(g=!1,a=1;a<b.length;)rf.push(parseInt(b[a],10)),a+=1,sf.push(parseInt(b[a],
10)),a+=1,a>=b.length?(c=0,g=!0):c=parseInt(b[a],10),0>c?(g=!0,Vb.push(Math.abs(c)),a+=1,c=parseInt(b[a++],10),Wb.push(Math.abs(c))):g?(Vb.push(Vb[Vb.length-1]),Wb.push(Wb[Wb.length-1])):(Vb.push(parseInt(b[a],10)),a+=1,Wb.push(parseInt(b[a],10)),a+=1);qf.onload=function(){yg=!0};qf.src=b[0]}a=e.overlay_labels;null!=a&&(Xb=a.split(","));tf=null;a=e.auto_enhance_background;null!=a&&(tf=parseInt(a,10)-1);Jc=null;a=e.auto_enhance;if(null!=a)for(c=e.overlay_probe_table,b=a.split(","),Jc=Array(b.length),
a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?Jc[a]=-1:Jc[a]=parseInt(b[a].trim(),10)-1,null==c&&(uc[a]=Jc[a]);Kc=!1;qb=-1;a=e.overlay_enhance;null!=a&&(Kc=!0,qb=parseInt(a,10)-1);vc=null;jd=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(b=a.split(","),vc=Array(b.length),a=0;a<b.length;a++)if(vc[a]=!0,D(b[a],"n")||D(b[a],"f"))vc[a]=!1;V=ba=null;uf=zg=!1;a=e.window_size;null!=a&&(b=a.split(","),"div"==b[0]?uf=!0:(V=parseInt(b[0],10),ba=parseInt(b[1],10)),zg=!0);Eb=[];a=e.use_for_all_frames;if(null!=
a)for(b=a.split(","),a=0;a<b.length;a+=2)Eb[parseInt(b[a],10)]=parseInt(b[a+1],10)-1;Od=-1;a=e.skip_missing;null!=a&&(Od=parseInt(a,10));Ag="#00000000";a=e.skip_missing_color;null!=a&&(Ag=a);ze=null;a=e.overlay_spacer;if(null!=a)for(b=a.split(","),ze=Array(b.length),a=0;a<b.length;a++)ze[a]=parseInt(b[a],10);a=e.overlay_probe_table;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?uc[a]=-1:uc[a]=parseInt(b[a],10)-1;vf=[];a=e.overlay_ontop;if(null!=a)for(b=a.split(","),
a=0;a<b.length;a++)vf[parseInt(b[a],10)-1]=!0;Lc=null;a=e.overlay_order;null==a&&(a=e.overlay_zorder);if(null!=a)for(b=a.split(","),Lc=Array(b.length),a=0;a<b.length;a++)Lc[parseInt(b[a],10)-1]=a;Yb=null;a=e.overlay_links;if(null!=a)for(b=a.split(","),Yb=Array(b.length),a=0;a<b.length;a++)Yb[a]=parseInt(b[a],10);Bg=[];O=null;a=e.overlay_slice;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)Bg[parseInt(b[a],10)-1]=!0;Cg=!0;D(e.slice_smoothing,"f")&&(Cg=!1);kd=null;a=e.overlay_clear;if(null!=a)for(b=
a.split(","),kd=Array(b.length),a=0;a<b.length;a++)kd[a]=b[a].trim().toLowerCase();Dg=!1;a=e.transparency;null!=a&&(b=a.split(","),1==b.length?Eg=Fg=Gg=parseInt(b[0],10):(Eg=parseInt(b[0],10),Fg=parseInt(b[1],10),Gg=parseInt(b[2],10)),Dg=!0);wf=!1;a=e.transparency_list;if(null!=a){b=a.split(",");Hg=[];for(a=0;a<b.length;a++)Hg[parseInt(b[a].trim(),10)-1]=!0;wf=!0}Ae=null;a=e.overlay_transparent_amount;if(null!=a)for(b=a.split(","),Ae=Array(b.length),a=0;a<b.length;a++)Ae[a]=parseFloat(b[a])/100;Mc=
null;a=e.overlay_zoom;if(null!=Xb&&null!=a)for(b=a.split(","),Mc=Array(b.length),a=0;a<b.length;a++)if(Mc[a]=1,D(b[a],"n")||D(b[a],"f"))Mc[a]=0;else if(D(b[a],"d")||D(b[a],"h"))Mc[a]=-1;rb=null;Ig=[];a=e.overlay_preserve_list;if(null!=Xb&&null!=a)for(b=a.split(","),rb=Array(b.length),a=0;a<b.length;a++){rb[a]=!0;if(D(b[a],"n")||D(b[a],"f"))rb[a]=!1;if(D(b[a],"a")||D(b[a],"A"))Ig[a]=!0}ca=null;if(null!=Xb&&null!=rb)for(b=e.overlay_preserve.replace(/&/g,",&,").split(","),c=e.overlay_preserve_position,
null!=c&&(c=c.split(",")),g=0,ca=Array(rb.length),a=k=0;a<rb.length;a++)if(rb[a]){ca[a]=[];m=0;do{ca[a][m]=[];for(d=0;4>d;d++)ca[a][m][d]=parseInt(b[k].trim(),10),k+=1;ca[a][m][2]=ca[a][m][2]-ca[a][m][0]+1;ca[a][m][3]=ca[a][m][3]-ca[a][m][1]+1;null!=c?(ca[a][m][4]=parseInt(c[g],10),ca[a][m][5]=parseInt(c[g+1],10),g+=2):(ca[a][m][4]=ca[a][m][0],ca[a][m][5]=ca[a][m][1]);k<b.length&&"&"==b[k].trim()?(k+=1,m+=1,d=!0):d=!1}while(d)}Be=0;Jg=" ";wc="white";Pd="transparent";Qd="14pt arial";Kg=!1;a=e.times_label_style;
null!=a&&(b=a.split(","),wc=b[0].trim(),1<b.length&&(Be=Math.floor(60*parseFloat(b[1]))),1<b.length&&(Be="?"==b[1].trim()||"auto"==b[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(b[1]))),2<b.length&&(Jg=b[2].trim()),3<b.length&&(Pd=b[3].trim()),4<b.length&&(Qd=b[4].trim()),5<b.length&&-1!=b[5].trim().indexOf("t")&&(Kg=!0));0==wc.indexOf("0x")&&(wc="#"+wc.substring(2));0==Pd.indexOf("0x")&&(Pd="#"+Pd.substring(2));ld=parseInt(Qd,10);Wh=new hb("black",
"white",Qd,"black",20,5,5);Lg=!1;Lg=D(e.to_from_lock,"t")?!0:!1;a="black";d="white";l="14px arial";c=null;m=k=g=10;Mg=Ng=" ";xf=md=null;a=e.dirspd_display_style;null!=a&&(b=a.split(","),a=b[0].trim(),d=b[1].trim(),l=b[2].trim(),Mg=b[3],Ng=b[4],5<b.length&&(c=b[5].trim(),g=parseInt(b[6],10),k=parseInt(b[7],10),m=parseInt(b[8],10)),xf=new hb(a,d,l,c,g,k,m));c="black";g="white";k="14px arial";m=null;f=l=d=10;a=e.tipbox_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),
3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Og=new hb(c,g,k,m,d,l,f);nd=null;fa=e.image_base;null!=fa?nd=fa=fa.trim():fa=null!=e.image_only_base?e.image_only_base.trim():null;Pg=fa;a=e.overlay_base;null!=a&&(Zb=a.trim());Ce=!0;D(e.zip_only,"f")&&(Ce=!1);Nc=!1;a=e.zip_filename;null!=a&&(Nc=!0,yf=a.trim());id=!0;a=e.filenames;null==a&&(a=e.background_filenames);null!=a&&Xh(a);a=e.basename;null!=a&&(c=e.base_starting_number,g=0,k=1,null!=c&&(b=c.split(","),
g=parseInt(b[0],10),1<b.length&&(k=parseInt(b[1],10))),u=e.num_frames,null==u&&(u=e.num_images),u=parseInt(u,10),Yh(a,g,k));zf=!0;b=e.zip_static;if(D(b,"f")||D(b,"n"))zf=!1;Af=!0;b=e.background_static;if(D(b,"f")||D(b,"n"))Af=!1;a=e.overlay_filenames;null!=a&&Zh(a);Ga=null;a=e.image_preserve;if(null!=a)for(b=a.split(","),Ga=[],a=0;a<b.length;a++)Ga[a]=parseInt(b[a].trim(),10),1<a%4&&(Ga[a]=Ga[a]-Ga[a-2]+1);Qg=!0;D(e.keep_zoom,"f")&&(Qg=!1);Rd=Rg=0;Sg=!1;a=e.hide_bottom;null!=a&&(b=a.split(","),Rg=
parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Sg=!0));Sd=Tg=0;Ug=!1;a=e.hide_top;null!=a&&(b=a.split(","),Tg=parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Ug=!0));Td=Vg=0;Wg=!1;a=e.hide_left;null!=a&&(b=a.split(","),Vg=parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Wg=!0));Ud=Xg=0;Yg=!1;a=e.hide_right;null!=a&&(b=a.split(","),Xg=parseInt(b[0].trim(),10),1<b.length&&D(b[1],"t")&&(Yg=!0));Zg=!1;D(e.hide_background,"t")&&(Zg=!0);$g="<div>";ah=300;bh=500;a=e.popup_style;null!=a&&($g='<div style="'+
a+'">');a=e.popup_window_size;null!=a&&(b=a.split(","),bh=b[0],ah=b[1]);ch=!1;a=e.wheel_frames;null!=a&&(ch=!0,ma.useWheel(H.wheel));dh=za=!1;D(e.active_zoom,"t")&&(null==Aa&&(za=!0),ma.useWheel(H.wheel));Bf=!1;D(e.cycle_zoom,"t")&&(Bf=!0);a=e.initial_zoom;null!=a&&(b=a.split(","),xc="auto"!=b[0].toLowerCase()?parseFloat(b[0]):"auto",1<b.length?(Vd=parseInt(b[1],10),eh=parseInt(b[2],10)):Vd=-1,fh=!0);od=1;pd=!1;na=null;a=e.zoom_scale;if(null!=a)if(b=a.split(","),1===b.length)D(a,"hi_res")?(pd=!0,
od=0):od=parseFloat(a);else{na=Array(b.length);for(a=0;a<b.length;a++)na[a]=parseFloat(b[a]);pd=!0}Oc=9999999;a=e.maximum_zoom;null!=a&&(Oc=parseFloat(a));De=!0;D(e.use_progress_bar,"f")&&(De=!1);a=e.dwell;null!=a&&(b=a.split(","),Ba=parseInt(b[0].trim(),10),1<b.length&&($b=parseInt(b[1].trim(),10),10>$b&&($b=10),Pc=parseInt(b[2].trim(),10),Cf=parseInt(b[3].trim(),10)));a=e.rate;null!=a&&(b=a.split(","),Ba=Math.round(1E4/parseFloat(b[0].trim())),1<b.length&&($b=Math.round(1E4/parseFloat(b[2].trim())),
10>$b&&($b=10),Pc=Math.round(1E4/parseFloat(b[1].trim()))));a=e.frame_times_template;null!=a&&(b=a.split(","));sb=null;a=e.times;if(null!=a){b=a.split(",");sb=Array(b.length);for(a=0;a<b.length;a++)sb[a]=parseInt(b[a].trim(),10);wa(sb)}a=e.extrap_times_filename;if(null!=a){sb=[];var h=new XMLHttpRequest;h.open("get",a,!0);h.onload=function(){for(var a=h.responseText.split("\n"),b=0;b<a.length;b++){var c=a[b].split(" ");if(3==c.length){c[2].trim();var d=parseInt(c[0],10)-1;sb[d]=100*parseInt(c[2].substring(0,
2),10)+parseInt(c[2].substring(3,5),10)+parseInt(c[2].substring(6,8),10)/30}}wa(sb)};h.send()}Wd=null;a=e.extrap_times_template;null!=a&&(Wd=RegExp(a));gh=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];hh=10;D(e.extrap_prompts_position,"bot")&&(hh=9999);a=e.extrap_prompts;null!=a&&(gh=a.split(","));Ee=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&(Ee=a.split(","));Fe=!0;D(e.mark_close,
"f")&&(Fe=!1);Df="12pt Arial";ih="white";a=e.mark_prompts_style;null!=a&&(b=a.split(","),Df=b[0].trim(),1<b.length&&(ih=b[1].trim()));jh=e.controls;ia("controls = "+e.controls);ia("bottom_controls = "+e.bottom_controls);Qc=Ge=ac=bc=tb=ub=Fb=null;null!=jh&&qe(jh,!0);kh=e.bottom_controls;null!=kh&&qe(kh,!1);Rc=!1;a=e.probe_table;null!=a&&N(a);b=e.enhance_filename;null==b&&(b=e.enhance_table);if(null!=b){ia("Reading enhancement table...");Rc=!1;h=new XMLHttpRequest;vb=[];Sc=[];He=[];Tc=[];cc=[];var lh,
kb,n;Za=[];$a=[];ab=[];Xd=[];v=-1;mh=!0;var q=!1,r,x,w,p,L,A,E,y,I,G,nh,B,C;h.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var c=a[b].replace(/\s+/g," ").trim(),d=c.indexOf("#");if(0!=d)if(0<d&&(c=c.substring(0,d)),d=c.split(","),0==d[0].indexOf("*"))v++,vb[v]=Array(256),Tc[v]=Array(256),Sc[v]=Array(256),cc[v]=Array(256),Za[v]=Array(256),$a[v]=Array(256),ab[v]=Array(256),Xd[v]=Array(256),vb[v]=Array(256),He[v]=1<d.length?d[1].trim():"None",lh=" ",
kb="Value =",n=1,c=t("option"),c.innerHTML=d[0].substring(1),c.value=v,null!=Ca&&Ca.add(c);else{var g=c.indexOf("value");0>g&&(g=c.indexOf("probe"));q=!1;G=nh=0;0<g&&(d=c.substring(g+1),c=c.substring(0,g),g=d.indexOf("="),d=d.substring(g+1),d=d.split(","),1==d.length?(kb=d[0].trim(),n=-1,q=!1):(G=parseFloat(d[0].trim()),nh=parseFloat(d[1].trim()),2<d.length&&(n=parseInt(d[2],10)),3<d.length&&(lh=$h(d[3].trim())),4<d.length&&(kb=d[4].trim()),q=!0));c=c.split(" ");r=parseInt(c[0].trim(),10);x=parseInt(c[1].trim(),
10);w=x-r;p=parseFloat(c[2].trim());L=parseFloat(c[3].trim());A=parseFloat(c[4].trim());E=parseFloat(c[5].trim());y=parseFloat(c[6].trim());I=parseFloat(c[7].trim());B=C=255;9<c.length&&(B=parseFloat(c[8].trim()),C=parseFloat(c[9].trim()));for(c=r;c<=x;c++)0===w?(Za[v][r]=p,$a[v][r]=A,ab[v][r]=y,Xd[v][r]=B):(Za[v][c]=Math.round(p+(L-p)*(c-r)/w),$a[v][c]=Math.round(A+(E-A)*(c-r)/w),ab[v][c]=Math.round(y+(I-y)*(c-r)/w),Xd[v][c]=Math.round(B+(C-B)*(c-r)/w)),Tc[v][c]=kb,Sc[v][c]=lh,cc[v][c]=n,q&&(vb[v][c]=
G+(nh-G)*(c-r)/w)}}-1!=qb&&F[qb].checked&&(Ca.disabled=!1);Rc=!0;P()};h.open("get",b,!0);h.send()}else P()}function P(){var b=e.sprite_filenames;if(null!=b){var a=b.split(",");Ef=0;ka=[];b=e.sprite_images_offset;Uc=-1;null!=b&&(Uc=parseInt(b,10)-1);for(b=0;b<a.length;b++){ka[b]=new Image;ka[b].gotit=!1;ka[b].inx=b;ka[b].fromfile=!0;var d="/";0<a[b].indexOf("?")&&(d="?");ka[b].zoomme=0<a[b].indexOf(d+"zoom");ka[b].anim=0<a[b].indexOf(d+"animate");d=a[b].indexOf(d);0<d&&(a[b]=a[b].substring(0,d));ka[b].onload=
function(){ka[this.inx].gotit=!0;Ef++;Ef==a.length&&J()};ka[b].src=a[b].trim()}}else J()}function J(){for(var b=Object.keys(e),a=0;a<b.length;a++)D(b[a],"hotspot")&&Qb("hotspot="+e[b[a]]);id?H.getFOF():(yc=!0,Ma())}function N(b){var a=new XMLHttpRequest;vb=[];He=[];Sc=[];var d=" ";Tc=[];var c="Value=";cc=[];var g=1;Vc=[];Ff=[];Za=[];$a=[];ab=[];var e,m=-1;v=-1;var l=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var k=a[b].replace(/\s+/g," ").trim().split(","),
f=k[0].split(" ");if(0==f[0].indexOf("*"))v++,vb[v]=[],Tc[v]=[],Sc[v]=[],cc[v]=[],Za[v]=[],$a[v]=[],ab[v]=[],Ff[v]=[],Vc[v]=[],m=-1,He[v]=1<k.length?k[1].trim():"None",l=1;else if(0!=l){m++;var h=Array(3);vb[v][m]=parseFloat(f[0]);Za[v][m]=parseInt(f[1].trim(),10);$a[v][m]=parseInt(f[2].trim(),10);ab[v][m]=parseInt(f[3].trim(),10);0!=m&&(h[0]=Za[v][m]-Za[v][m-1],h[1]=$a[v][m]-$a[v][m-1],h[2]=ab[v][m]-ab[v][m-1],e=0,Math.abs(h[1])>Math.abs(h[e])&&(e=1),Math.abs(h[2])>Math.abs(h[e])&&(e=2),Ff[v][m-
1]=e,Vc[v][m-1]=h,0==Vc[v][m-1][e]&&(Vc[v][m-1][e]=1));1<k.length&&(0==k[1].trim().indexOf('"')?(g=-1,k=k[1].trim(),c=k.substr(1,k.length-2),d=""):(g=parseInt(k[1],10),2<k.length&&(d=$h(k[2].trim())),3<k.length&&(c=k[3].trim())));Tc[v][m]=c;cc[v][m]=g;Sc[v][m]=d}}Rc=!0};a.open("get",b,!0);a.send()}function Bb(b){b=b.split(",");var a=b[0].trim();"PS"===a?(dc=new si,dc.init(b)):"CE"==a?(dc=new ti,dc.init(b)):"LCC"==a?(dc=new ui,dc.init(b)):(dc=null,Gf=parseFloat(b[0]),oh=parseFloat(b[1]),ai=parseFloat(b[2]),
bi=parseFloat(b[3]))}function ng(b){var a=new XMLHttpRequest;a.onload=function(){h(this.responseText.split("\n"))};a.open("get",b+"?"+Math.round(1E5*Math.random()),!0);a.send()}function gf(b){var a;if(null!=kd){for(a=0;a<kd.length;a++)-1!=kd[a].indexOf(b)&&(F[a].checked=!1);for(a=0;a<kd.length;a++)Na(a)}}function wa(b){Hf=Array(b.length);for(var a=0;a<b.length;a++){var d=60*Math.floor(b[a]/100)+Math.floor(b[a])%100;0===a&&(ec=d);var c=d-ec;0>c&&(c=d+1440-ec);Hf[a]=c;ia("times s="+d+"  min="+Hf[a])}ec+=
Be;1440<=ec&&(ec-=1440);0>ec&&(ec+=1440);ia("Starting minute = "+ec)}function oc(b,a){if(0!=b&&!Wc)for(var d=0;d<b;d++)0==F[Ha[d].overlay].isGhost&&(F[Ha[d].overlay].parentNode.style.visibility=a)}function Xa(){0!=wb?oc(wb,"visible"):0!=ph&&oc(ph,"hidden");yc=!0;Ma()}function Ed(b,a){qd||(pb.height=a,pb.width=b,tc.height=a,tc.width=b,Yd.height=a,Yd.width=b,Ie.height=a,Ie.width=b,Zd=Ie.getContext("2d"),V=b,ba=a,Je=V/2-100,Ke=ba/2-10,A=1*oa/V,E=1*ja/ba,qh&&(qh=!1,null!=Le&&Le()),Qa.style.height=ba+
"px",Qa.style.width=V+"px",zc.style.height=ba+"px",zc.style.width=V+"px",rd.style.height=ba+"px",rd.style.width=V+"px",re(u,!1))}function hf(){for(var b=0,a={},d=0;d<u;a={$jscomp$loop$prop$ii$2:a.$jscomp$loop$prop$ii$2},d++){a.$jscomp$loop$prop$ii$2=d;var c=null==fa?ua[d]:ua[d].substring(ua[d].lastIndexOf("/")+1);(c=rh.file(c))?c.async("arraybuffer").then(function(a){return function(c){c=new Blob([c]);Ac[a.$jscomp$loop$prop$ii$2]=URL.createObjectURL(c);b++;b>=u&&Fd()}}(a),function(a){return function(){Ac[a.$jscomp$loop$prop$ii$2]=
null;b++;b>=u&&Fd()}}(a)):(Ac[a.$jscomp$loop$prop$ii$2]=null,b++,b>=u&&Fd())}}function Fd(){var b=0;if(0==da)pc();else for(var a=0;a<u;a++){Bc[a]=[];for(var d={},c=0;c<da;d={$jscomp$loop$prop$ii$6:d.$jscomp$loop$prop$ii$6,$jscomp$loop$prop$jj$7:d.$jscomp$loop$prop$jj$7},c++){d.$jscomp$loop$prop$ii$6=a;d.$jscomp$loop$prop$jj$7=c;var g=null==Zb&&null==fa?ha[a][c]:ha[a][c].substring(ha[a][c].lastIndexOf("/")+1);(g=rh.file(g))?g.async("arraybuffer").then(function(a){return function(c){c=new Blob([c]);
Bc[a.$jscomp$loop$prop$ii$6][a.$jscomp$loop$prop$jj$7]=URL.createObjectURL(c);b++;b>=u*da&&pc()}}(d),function(a){return function(){Bc[a.$jscomp$loop$prop$ii$6][a.$jscomp$loop$prop$jj$7]=null;b++;b>=u*da&&pc()}}(d)):(Bc[a][c]=null,b++,b>=u*da&&pc())}}}function Ma(){if(Nc){var b=new XMLHttpRequest,a=null==nd?yf:nd+yf;zf||(a=a+"?"+Math.round(1E5*Math.random()));b.open("GET",a,!0);b.responseType="arraybuffer";Ac=[];Bc=[];b.addEventListener("progress",function(a){a.lengthComputable&&ta("Loading ZIP file",
a.total,a.loaded)});b.onload=function(a){(new JSZip).loadAsync(this.response).then(function(a){rh=a;hf()},function(){ia("Unable to read ZIP file: "+yf)})};b.send()}else pc()}function pc(){var b,a,d;void 0!=Me&&Me(!1);var c="?"+Math.round(1E4*Math.random()),g=[];g[0]=Cc;for(b=1;b<u;b++)g[b]=b<=Cc?b-1:b;Ia=Array(u);Gb=Da=0;sh=De;If&&(lb.max=u);qd&&(sd||Kc)&&(fc=[],Ra=[],Xc=[],Jf=[],Ne=[]);null!=Ca&&(Ca.selectedIndex=0);for(var e=0;e<u;e++){b=g[e];qd&&(sd||Kc)&&(fc[b]=t("canvas"),Ra[b]=t("canvas"));
Ia[b]=new Image;Ia[b].gotit=!1;Ia[b].frameNum=b;Ia[b].onerror=function(){Da++};Ia[b].onload=function(){qd&&(ja=this.height,oa=this.width,bb=ja,cb=oa,qd=!1,zg?uf?H.setWindowSize(z.offsetWidth,z.offsetHeight):Ed(V,ba):Ed(oa,ja),fh&&("auto"==xc&&(xc=(A+E)/2,Vd=-1),bb/=xc,cb/=xc,0>Vd&&(Vd=oa/2,eh=ja/2),R=Math.round(Vd-oa/2/xc),S=Math.round(eh-ja/2/xc),B=C=xc,1!=xc&&(za=!1,H.toggleZooming())));Nc&&null!=Ac[this.frameNum]&&URL.revokeObjectURL(Ac[this.frameNum]);if(0<Oe&&!td){Kf.height=ja;Kf.width=oa;$d=
Kf.getContext("2d");$d.clearRect(0,0,V,ba);for(var b=0;b<Sa.length;b++){for(var e=Sa[b].ctx.getImageData(0,0,Sa[b].width,Sa[b].height).data,m=$d.getImageData(Sa[b].xmin,Sa[b].ymin,Sa[b].width,Sa[b].height),k=3;k<e.length;k+=4)0!=e[k]&&(m.data[k]=b+1);$d.putImageData(m,Sa[b].xmin,Sa[b].ymin)}za||(mb=!0);B==Pe&&(mb=!0);td=!0}if(yc){yc=!1;M=pb.getContext("2d");M.imageSmoothingEnabled=Nd;M.fillStyle="blue";M.font="bold 20px Arial";f=tc.getContext("2d");f.imageSmoothingEnabled=Nd;Ta=Array(u);re(u,!0);
Qe&&!Ua?ya(xa(Cc)):ya(xa(q));if(0<da)for(K=Array(u),k=0;k<u;k++)for(d=g[k],K[d]=Array(da),a=0;a<da;a++)if(void 0!=Eb[a+1]&&Eb[a+1]>=u&&(Eb[a+1]=u-1),void 0==Eb[a+1]||Eb[a+1]==d)K[d][a]=new Image,K[d][a].gotit=!1,K[d][a].frameNum=d,K[d][a].overlayNum=a,K[d][a].onerror=function(){Da++},K[d][a].onload=function(){this.gotit=!0;var a=this.frameNum;Da++;n();!ye||this.height==ja&&this.width==oa?this.overlayNum==Od-1&&(Ta[this.frameNum]=0):(this.gotit=!1,ia("Bad image size:"+this.src));if(Kc&&this.gotit&&
this.overlayNum==qb)fc[a].height=this.height,fc[a].width=this.width,ae=fc[a].getContext("2d"),ae.drawImage(this,0,0),Jf[a]=ae.getImageData(0,0,this.width,this.height).data,Ra[a].height=this.height,Ra[a].width=this.width,Xc[a]=Ra[a].getContext("2d"),Xc[a].drawImage(this,0,0),Ne[a]=Xc[a].getImageData(0,0,this.width,this.height),K[a][this.overlayNum]=null,K[a][this.overlayNum]=Ra[a],K[a][this.overlayNum].gotit=!0;else if(this.gotit&&F[this.overlayNum].hotspotIndex){var b=t("canvas");b.height=this.height;
b.width=this.width;var c=b.getContext("2d");c.drawImage(this,0,0);var d=c.getImageData(0,0,this.width,this.height).data,g=d.length;var e=this.overlayNum;var k;for(k=0;k<g;k+=4)if(0!=d[k]){0==nb&&(ob=[]);var m=d[k];var l=Math.floor(k/4/b.width);c=Math.floor(k/4%b.width);ob[nb]=new Cb(c,l,"spritefn",m,"pan",null,null,e,a,null);nb++}}else if(this.gotit&&Dg&&(!wf||wf&&Hg[this.overlayNum])){b=t("canvas");b.height=this.height;b.width=this.width;c=b.getContext("2d");c.drawImage(this,0,0);l=c.getImageData(0,
0,this.width,this.height);d=l.data;g=d.length;for(k=0;k<g;k+=4)d[k]===Eg&&d[k+1]===Fg&&d[k+2]===Gg&&(d[k+3]=0);c.putImageData(l,0,0);K[a][this.overlayNum]=null;K[a][this.overlayNum]=b;K[a][this.overlayNum].gotit=!0}this.gotit&&vf[this.overlayNum]?(Lf.clearRect(0,0,V,ba),Lf.drawImage(K[a][this.overlayNum],0,0,V,ba)):this.gotit&&Bg[this.overlayNum]&&null!=O&&(b=t("canvas"),b.height=ja,b.width=oa,8>O.length&&(O[4]=0,O[5]=0,O[6]=oa,O[7]=ja),c=b.getContext("2d"),c.imageSmoothingEnabled=Cg,c.drawImage(this,
O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7]),K[a][this.overlayNum]=null,K[a][this.overlayNum]=b,K[a][this.overlayNum].gotit=!0,null!=rb&&rb[this.overlayNum]&&(K[a][this.overlayNum].origImage=this));Nc&&null!=Bc[a][this.overlayNum]&&URL.revokeObjectURL(Bc[a][this.overlayNum]);if(void 0!=Eb[this.overlayNum+1]&&Eb[this.overlayNum+1]==a)for(b=0;b<u;b++)b!=a&&(K[b][this.overlayNum]=K[a][this.overlayNum],Da++)},b=ha[d][a],void 0==be||be[a]||(b+=c),K[d][a].src=Nc&&(Ce||Bc[d][a])?Bc[d][a]:b,Gb++;if(null!=Yc)for(gc=
[],a=0;a<Yc.length;a++)gc[a]=new Image,gc[a].gotit=!1,gc[a].onerror=function(a){Da++},gc[a].onload=function(a){a.currentTarget.gotit=!0;Da++;n()},gc[a].src=Yc[a],Gb++;if(null!=Ja&&0<Ja.length)for(va=[],a=0;a<Ja.length;a++)if(void 0!=Ja[a])for(va[a]=[],d=0;d<Ja[a].length;d++)for(va[a][d]=[],k=0;k<u;k++)ci(Ja[a][d],"/")?(b=ha[k][a].lastIndexOf("/"),b=ha[k][a].substring(0,b+1)+Ja[a][d]+ha[k][a].substring(b+1),va[a][d][k]=new Image,va[a][d][k].gotit=!1,va[a][d][k].onerror=function(a){Da++;n()},va[a][d][k].onload=
function(a){a.currentTarget.gotit=!0;Da++;n()},va[a][d][k].src=b,Gb++):0===k?(va[a][d][0]=new Image,va[a][d][0].gotit=!1,va[a][d][0].onerror=function(a){Da++;n()},va[a][d][0].onload=function(a){a.currentTarget.gotit=!0;Da++;n()},va[a][d][0].src=Ja[a][d],Gb++):va[a][d][k]=va[a][d][0]}!ye&&0!=this.height&&0!=this.width||this.height==ja&&this.width==oa?(this.gotit=!0,0==Od&&(Ta[this.frameNum]=0)):(this.gotit=!1,ia("Image has invalid size:"+this.src));sd&&this.gotit&&(k=this.frameNum,fc[k].height=this.height,
fc[k].width=this.width,ae=fc[k].getContext("2d"),ae.drawImage(this,0,0),Jf[k]=ae.getImageData(0,0,this.width,this.height).data,Ra[k].height=this.height,Ra[k].width=this.width,Xc[k]=Ra[k].getContext("2d"),Xc[k].drawImage(this,0,0),Ne[k]=Xc[k].getImageData(0,0,this.width,this.height),Ia[k]=null,Ia[k]=Ra[k],Ia[k].gotit=!0);Da++;n();Qg||H.resetZoom();Zc=!0;di||(di=!0,Ea=!1,ei());I(Ua)};var m=ua[b];void 0!=Eb[0]&&(m=Eb[0],m>=u&&(m=u-1),m=ua[m]);Af||(m+=c);Ia[b].src=Nc&&(Ce||Ac[b])?Ac[b]:m;Gb++}$c=Hb=!1;
aa()}function ea(b,a,d,c,g,k){b.label_on=d;b.label_off=c;jb&&(b.className=k);d=null;c=e[a+"_labels"];null==c&&(c=e[a+"_label"]);null!=c&&(c=c.split(","),b.label_on=c[0].trim(),1<c.length&&(b.label_off=c[1].trim()),2<c.length&&(d="width:"+c[2].trim()+"px;"));null!=g&&(b.title=g);b.innerHTML=b.label_on;g=a=c=e[a+"_style"];null!=c&&(c=c.split("&"),1<c.length&&(a=c[0],g=c[1]));b.style_on=(null!=d?d:"")+Dc+a;b.style_off=(null!=d?d:"")+Dc+g;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",b.style_on):
(b.style_on=null,b.style_off=null)}function qe(b,a){Dc=e.buttons_style;null==Dc&&(Dc="");var d=null,c=null;d=a?e.controls_tooltip:e.bottom_controls_tooltip;var g=b.split(",");if(null!=d){var k=d.split(",");k.length!=g.length&&(ia("!!! Number of tooltips must equal number of controls!"),k=d=null)}for(b=0;b<g.length;b++){var m=null!=d?k[b]:null;var l=g[b].trim();c=l.indexOf("/");if(0===c||0===b){0===c&&(l=l.substring(1));x=t("div");x.align=Kd;var f=e.controls_style;null!=f?x.setAttribute("style",f):
x.setAttribute("style","position:relative;padding:2px;width:100%;");a?(z.insertBefore(x,Qa),Mf=x):(f=e.bottom_controls_style,null!=f&&x.setAttribute("style",f),z.appendChild(x),Nf=x)}"enhance"==l.trim()&&(Ca=t("select"),c=e.enhance_style,null!=c&&Ca.setAttribute("style",c),null!=m&&(Ca.title=m),c=t("option"),c.innerHTML="Pick Enhancement",c.value=-1,Ca.add(c),Ca.addEventListener("change",H.doEnhance,!1),sd=!Kc,Ca.disabled=sd?!1:!0,x.appendChild(Ca));"startstop"==l&&(Fb=t("button"),ea(Fb,"startstop",
"Start","Stop",m,"startstop start"),Fb.addEventListener("click",H.toggleIsLooping,!1),x.appendChild(Fb));"looprock"==l&&(ce=t("button"),ea(ce,"looprock","Rock","Loop",m,"looprock rock"),Of=1,ce.addEventListener("click",H.toggleLoopRock,!1),x.appendChild(ce),D(e.start_rocking,"t")&&H.toggleLoopRock());"loophalt"==l&&(de=t("button"),ea(de,"loophalt","Halt","Loop",m,"loophalt halt"),xb=!1,de.addEventListener("click",H.toggleLoopHalt,!1),x.appendChild(de));"extrap"==l&&(hc=t("button"),ea(hc,"extrap",
"Enable Extrap","Disable Extrap",m,"extrap"),hc.addEventListener("click",H.toggleExtrap,!1),x.appendChild(hc));D(l,"location")&&(ud=t("button"),ea(ud,"location","Show Loc","Hide Loc",m,"location"),0<l.indexOf("/on")?(G(ud,!1,"location off"),vd=!0,Fa.push(z.style.cursor),z.style.cursor=we):(vd=!1,z.style.cursor=Fa.pop()),ud.addEventListener("click",function(){(vd=!vd)?(G(ud,!1,"location off"),Fa.push(z.style.cursor),z.style.cursor=we):(G(ud,!0,"location on"),z.style.cursor=Fa.pop());aa()},!1),x.appendChild(ud));
"distance"==l&&(ic=t("button"),ea(ic,"distance","Show dist","Hide dist",m,"distance"),sc=ve=!1,ic.addEventListener("click",function(){(sc=!sc)?(G(ic,!1,"distance off"),Fa.push(z.style.cursor),z.style.cursor=mf):(G(ic,!0,"distance on"),z.style.cursor=Fa.pop())},!1),x.appendChild(ic));D(l,"probe")&&(wd=t("button"),ea(wd,"probe","Show probe","Hide probe",m,"probe"),0<l.indexOf("/on")?(G(wd,!1,"probe off"),Ub=!0,Fa.push(z.style.cursor),z.style.cursor=xe):(Ub=!1,z.style.cursor=Fa.pop()),wd.addEventListener("click",
function(){(Ub=!Ub)?(G(wd,!1,"probe off"),Fa.push(z.style.cursor),z.style.cursor=xe):(G(wd,!0,"probe on"),z.style.cursor=Fa.pop())},!1),x.appendChild(wd));"mark"==l&&(ad=t("button"),ea(ad,"mark","Mark","Stop Mark",m,"mark"),ee=!0,ad.addEventListener("click",function(){yb=!yb;pa=[];yb?(xd=0,G(ad,!1,"mark off"),null!=Aa&&(Aa.disabled=!0),Fa.push(z.style.cursor),z.style.cursor=nf):(G(ad,!0,"mark on"),null!=Aa&&(Aa.disabled=!1),xd=-1,z.style.cursor=Fa.pop());aa()},!1),fi=new hb("black","white",Df,"black",
20,5,5),th=new hb("black","white",Df,"black",20,5,5),x.appendChild(ad));"refresh"==l&&(Ge=t("button"),ea(Ge,"refresh","Refresh",null,m,"refresh"),Ge.addEventListener("click",H.reloadFOF,!1),x.appendChild(Ge));"restore"==l&&(Pf=t("button"),ea(Pf,"restore","Restore",null,m,"restore"),Pf.addEventListener("click",function(a){for(a=0;a<F.length;a++)F[a].checked=F[a].restorableState;for(a=0;a<F.length;a++)Na(a)},!1),x.appendChild(Pf));"setframe"==l&&(lb=t("input"),jb&&(lb.className="setframe"),lb.type=
"range",lb.min=1,lb.max=100,lb.value=1,Re="Frame #*",null!=m&&(lb.title=m),f=e.setframe_label,null!=f&&(Re=f),fe=t("span"),fe.innerHTML=Re.replace("*",1),c="display:block;vertical-align:middle;"+e.setframe_style,lb.setAttribute("style",c),c=t("span"),c.setAttribute("style","display:inline-block;vertical-align:top;"),fe.setAttribute("style","display:block;vertical-align:middle;"+e.setframe_label_style),c.appendChild(fe),c.appendChild(lb),x.appendChild(c),lb.addEventListener("input",function(a){I(!1);
a=parseInt(lb.value,10)-1;0<=Ta[a]&&(ya(a),fe.innerHTML=Re.replace("*",q+1));Z()},!1),If=!0);"framelabel"==l&&(Ka=t("button"),jb&&(Ka.className="framelabel"),Ka.innerHTML="",null!=m&&(Ka.title=m),db=null,f=e.frame_labels,null!=f&&(db=f.split(","),Ka.innerHTML=db[0]),c=Dc+e.framelabel_style,null!=c&&Ka.setAttribute("style",c),c=e.framelabel_position,null!=c&&(c=c.split(","),Ka.style.position="absolute",Ka.style.left=z.offsetLeft+parseInt(c[0],10)+"px",Ka.style.top=z.offsetTop+parseInt(c[1],10)+"px"),
x.appendChild(Ka));if("autorefresh"==l||"autorefresh/off"==l)null!=Ic&&clearInterval(Ic),Qc=t("button"),ea(Qc,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",m,"autorefresh"),Qc.addEventListener("click",H.toggleAutoRefresh,!1),Md=!1,x.appendChild(Qc),"autorefresh"==l?H.toggleAutoRefresh():G(Qc,!1,"autotoggle off");"backward"==l&&(tb=t("button"),ea(tb,"backward","<","<",m,"step back"),tb.addEventListener("click",function(){I(!1);Db(-1);Z()},!1),x.appendChild(tb));"forward"==l&&(ub=t("button"),
ea(ub,"forward",">",">",m,"step forward"),ub.addEventListener("click",function(){I(!1);Db(1);Z()},!1),x.appendChild(ub));if("step"==l){c=e.step_labels;var h=null!=c?c.split(","):["<",">"];tb=t("button");jb&&(tb.className="step back");tb.innerHTML=h[0];tb.addEventListener("click",function(){I(!1);Db(-1);Z()},!1);c=Dc+e.step_style;null!=c&&tb.setAttribute("style",c);null!=m&&(tb.title=m);x.appendChild(tb);ub=t("button");jb&&(ub.className="step forward");ub.innerHTML=h[1];ub.addEventListener("click",
function(){I(!1);Db(1);Z()},!1);null!=c&&ub.setAttribute("style",c);null!=m&&(ub.title=m);x.appendChild(ub)}"first"==l&&(Ib=t("button"),ea(Ib,"first","|<","|<",m,"firstlast first"),Ib.addEventListener("click",function(){I(!1);ya(xa(0));Z()},!1),x.appendChild(Ib));"last"==l&&(Jb=t("button"),ea(Jb,"last",">|",">|",m,"firstlast last"),Jb.addEventListener("click",function(){I(!1);ya(xa(u-1));Z()},!1),x.appendChild(Jb));"firstlast"==l&&(c=e.firstlast_labels,h=null!=c?c.split(","):["<<",">>"],Ib=t("button"),
jb&&(Ib.className="firstlast"),Ib.innerHTML=h[0],Ib.addEventListener("click",function(){I(!1);ya(xa(0));Z()},!1),c=Dc+e.firstlast_style,null!=c&&Ib.setAttribute("style",c),null!=m&&(Ib.title=m),x.appendChild(Ib),Jb=t("button"),jb&&(Jb.className="firstlast"),Jb.innerHTML=h[1],Jb.addEventListener("click",function(){I(!1);ya(xa(u-1));Z()},!1),null!=c&&Jb.setAttribute("style",c),null!=m&&(Jb.title=m),x.appendChild(Jb));"setspeed"==l?(Kb=t("input"),jb&&(Kb.className="setspeed"),Kb.type="range",Kb.min=
$b,Kb.max=Pc,Kb.value=Pc-Ba,null!=m&&(Kb.title=m),c="vertical-align:middle;"+e.setspeed_style,Kb.setAttribute("style",c),Kb.addEventListener("input",function(a){Ba=Pc-parseInt(Kb.value,10)+30;void 0!=yd&&yd(Ba);I(!0);Z()},!1),x.appendChild(Kb)):"speed"==l&&(c=e.speed_labels,h=null!=c?c.split(","):["-","+"],ac=t("button"),jb&&(ac.className="speed slower"),ac.innerHTML=h[0],ac.addEventListener("click",function(){Ba+=Cf;bc.disabled=!1;Ba>Pc&&(Ba=Pc,ac.disabled=!0);void 0!=yd&&yd(Ba)},!1),c=Dc+e.speed_style,
null!=c&&ac.setAttribute("style",c),null!=m&&(ac.title=m),x.appendChild(ac),bc=t("button"),jb&&(bc.className="speed faster"),bc.innerHTML=h[1],bc.addEventListener("click",function(){Ba-=Cf;ac.disabled=!1;Ba<$b&&(Ba=$b,bc.disabled=!0);void 0!=yd&&yd(Ba)},!1),null!=c&&bc.setAttribute("style",c),null!=m&&(bc.title=m),x.appendChild(bc));"zoom"==l&&(Aa=t("button"),ea(Aa,"zoom","Zoom","Un-zoom",m,"zoom off"),Aa.addEventListener("click",H.toggleZooming,!1),x.appendChild(Aa),za=!1);if("annotate"==l){ge=t("button");
ea(ge,"annotate","Annotate","Finished",m,"annotate");la=t("div");la.setAttribute("style","position:absolute;box-sizing:content-box;height:120px;width:180px;top:20px;left:20px;z-index:15;visibility:hidden;background-color:lightgray;border-width:6px;border-style:solid;border-color:magenta;border-radius:25px;padding:10px;font:normal normal normal 16px Arial;color:black;");la.title="Drag this box around.  Select attributes, then go onto the image and click & drag";bd=cd=20;Se=Lb=!1;uh=3;vh=11;dd=he=0;
r=[];la.style["touch-action"]="none";var n=function(a){cd=a.clientX-dd;bd=a.clientY-he;la.style.top=bd+"px";la.style.left=cd+"px"};la.addEventListener("mousedown",function(a){if(0!=a.clientX||0!=a.clientY)Se=!0,dd=a.clientX-cd,he=a.clientY-bd},!1);la.addEventListener("mouseup",function(a){Se=!1},!1);la.addEventListener("mouseout",function(a){Se&&n(a)},!1);la.addEventListener("mousemove",function(a){Se&&n(a)},!1);window.PointerEvent?(la.addEventListener("pointerdown",function(a){"mouse"!=a.pointerType&&
(dd=a.clientX-cd,he=a.clientY-bd)},!1),la.addEventListener("pointermove",function(a){"mouse"!=a.pointerType&&(0==dd&&(dd=a.clientX,he=a.clientY),n(a))},!1)):la.addEventListener("touchmove",function(a){a=a.changedTouches[0];0==dd&&(dd=a.clientX,he=a.clientY);n(a)},!1);ge.addEventListener("click",function(){if(Lb=!Lb){r=[];cd=z.offsetLeft;bd=z.offsetTop;var a=e.annotate_position;null!=a&&(a=a.split(","),cd+=parseInt(a[0],10),bd+=parseInt(a[1],10));la.style.top=bd+"px";la.style.left=cd+"px";la.style.visibility=
"visible";G(ge,!1,"annotate off");gi=za;za=!1;null!=Aa&&(Aa.disabled=!0)}else la.style.visibility="hidden",G(ge,!0,"annotate on"),za=gi,null!=Aa&&(Aa.disabled=!1);aa()},!0);ie=wh("Color Black White Red Green Blue Yellow Orange Cyan Magenta".split(" "),"black black white red green blue yellow orange cyan magenta".split(" "),function(a){});Ec=wh("Width 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==je.selectedIndex?vh=
Ec.selectedIndex:uh=Ec.selectedIndex});Ec.title="Select width or font size";je=wh("Type Arrow Circle Box Polygon Draw Text".split(" "),[-1,0,1,2,3,4,5],function(a){6==je.selectedIndex?(Mb.focus(),Mb.select(),Ec.selectedIndex=vh):Ec.selectedIndex=uh;0==ie.selectedIndex&&(ie.selectedIndex=2)});c=t("button");c.style.width="70px";c.style.margin="5px";c.innerHTML="Erase";c.title="Erase last item";c.addEventListener("click",function(){0<r.length&&(r.pop(),aa())},!1);Mb=t("input");Mb.type="text";Mb.style.width=
"150px";Mb.style.margin="5px";Mb.title="Enter your text here, then click where you want it";Mb.value="Text input";h=e.annotate_defaults;null!=h&&(h=h.split(","),je.selectedIndex=parseInt(h[0],10),1<h.length&&(ie.selectedIndex=parseInt(h[1],10)),2<h.length&&(Ec.selectedIndex=parseInt(h[2],10)),3<h.length&&(Mb.value=h[3].trim()));h=t("div");h.innerHTML="Annotation Tools";var kb=t("div");kb.appendChild(je);kb.appendChild(ie);var v=t("div");v.appendChild(Ec);v.appendChild(c);c=t("div");c.appendChild(Mb);
la.appendChild(h);la.appendChild(kb);la.appendChild(v);la.appendChild(c);x.appendChild(ge);z.appendChild(la)}"saveall"==l&&(Qf=t("button"),ea(Qf,"saveall","SaveAll","SaveAll",m,"saveall"),xh=e.saveall_prompt,jc=e.saveall_filename,c=e.saveall_list,yh=null==c?["0"]:c.split(","),Qf.addEventListener("click",function(){for(var a=0;a<yh.length;a++)for(var b=parseInt(yh[a],10),c=0;c<ua.length;c++){0===c&&null!=xh&&(jc=window.prompt(xh,jc),null!=jc&&1>jc.length&&(jc=null));var d=null==jc?"":-1!=jc.indexOf("#")?
jc.replace("#",c.toString()):jc+c;var g=document.createElement("a");g.href=0==b?ua[c]:ha[c][b-1];g.download=d;d=new MouseEvent("click");g.dispatchEvent(d)}},!1),x.appendChild(Qf));if("capture"==l){Rf=t("button");ea(Rf,"capture","Capture","Capture",m,"capture");var p=e.capture_prompt;Sf=e.capture_filename;null==Sf&&(Sf="haimage.png");Rf.addEventListener("click",function(){var a=Sf;if(null!=p&&(a=window.prompt(p,a),null==a))return;var b=t("canvas");b.height=pb.height;b.width=pb.width;var c=b.getContext("2d");
ee=!1;aa();c.drawImage(pb,0,0);c.drawImage(tc,0,0);ee=!0;b.toBlob(function(b){var c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;d.download=a;c=new MouseEvent("click");d.dispatchEvent(c);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);x.appendChild(Rf)}"show"==l&&(Tf=t("button"),ea(Tf,"show","Show","Show",m,"show"),Uf=e.show_prompt,hi=e.show_image_file,null==Uf&&(Uf="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),
Tf.addEventListener("click",function(){if(hi)window.open(ua[q]);else{var a=pb.toDataURL("image/png;base64;");var b=window.open();b.document.write(Uf+"<img src="+a+"></img>")}},!1),x.appendChild(Tf));"toggle"==l&&(Ta=[],c=e.toggle_size,null!=c?(c=c.split(","),zd=parseInt(c[0],10),Te=parseInt(c[1],10),Ue=parseInt(c[2],10)):(Te=zd=10,Ue=3),zh="red",Ah="blue",Bh="orange",Ch=!1,D(e.toggle_layout_width,"t")&&(Ch=!0),c=e.toggle_colors,null!=c&&(c=c.split(","),Ah=c[0].trim(),zh=c[1].trim(),Bh=c[2].trim()),
zb=t("div"),zb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),zb.style.backgroundColor=x.style.backgroundColor,zb.align=Kd,Dh=new PEvs(zb,null,null,null,null,H.togclick,null),ed=t("canvas"),ed.height=2*Te,Vf=ed.getContext("2d"),zb.appendChild(ed),a?z.insertBefore(zb,Qa):z.appendChild(zb),c=e.toggle_onoff,Ve=null,null!=c&&(Ve=c.split(",")),
Wf=!0,null!=m&&(zb.title=m));if("overlay"==l||D(l,"menu")){0==La&&(F=[]);h=e.overlay_tooltip;c=null;null!=h&&(c=h.split(","));h=e.overlay_radio;kb=null;null!=h&&(kb=h.split(","));var A=e.overlay_menu_links;v=null;null!=A&&(v=A.split(","));var y=e.overlay_labels_color;A=null;null!=y&&(A=y.split(","));y=Wc=!1;D(l,"menu")&&(Wc=!0,0<l.indexOf("/on")&&(y=!0));0==La&&(be=[]);var w=e.overlay_caching;l=null;null==w&&(w=e.overlay_static);null!=w&&(l=w.split(","));var E=!0;null!=e.overlay_nonewdiv&&(E=!1);
La++;for(w=0;w<Xb.length;w++){var L=Xb[w].trim();if(0==w||0==L.indexOf("/"))0==L.indexOf("/")&&(L=L.substr(1)),Wc?(Nb[La]=t("div"),Nb[La].setAttribute("style","text-align:left;display:block;position:absolute;border-style:solid;border-width:2px;background:#ffffff;z-index:999;visibility:"+(y?"visible":"hidden")+";"+e.overlay_labels_style),Xf++):E?(Ob=t("div"),Xf++,Ob.align="center",a?z.insertBefore(Ob,Qa):z.appendChild(Ob)):(Ob=t("span"),x.appendChild(Ob)),f=e.overlay_labels_style,Wc||null==f||Ob.setAttribute("style",
f);if(null==v||null!=v&&v[w]==La){var B=!1;f=L.length;0<L.indexOf("/on")&&L.indexOf("/on")==f-3&&(B=!0,L=L.substr(0,f-3));var C=!1;0<L.indexOf("/always")&&L.indexOf("/always")==f-7&&(C=B=!0);var K=!1;0<L.indexOf("/hidden")&&(K=!0);var J=!1;0<L.indexOf("/hotspots")&&(J=!0,L=L.substr(0,L.indexOf("/")));null!=l?D(l[w],"y")||D(l[w],"t")?be[w]=!0:be[w]=!1:be[w]=!0;F[w]=t("input");F[w].type="checkbox";F[w].value=L;F[w].id=L;F[w].showMe=!(C&K)&!J;var M="vertical-align:middle;";f=e.checkbox_style;null!=f&&
(M+=f);F[w].setAttribute("style",M);F[w].checked=B;F[w].restorableState=B;F[w].name=0;F[w].hotspotIndex=J;null!=Ca&&w==qb&&F[w].checked&&(Ca.disabled=!1);null!=vc&&!vc[w]&&B&&(jd=!1);F[w].addEventListener("click",H.overClick,!1);null!=h&&(f=kb[w].indexOf("/"),-1!=f&&(F[w].name=kb[w].substr(f+1).trim()),D(kb[w],"t")&&(F[w].type="radio",-1==f&&(F[w].name="all")));F[w].isGhost=!0;C||K||(null!=c&&(F[w].title=c[w]),C=t("label"),C.htmlFor=L,null!=c&&(C.title=c[w]),C.innerHTML=L,C.name=F[w].name,L="vertical-align:middle;",
null!=A&&(L=L+"color:"+A[w]+";"),C.setAttribute("style",L),L=t("span"),L.appendChild(F[w]),L.appendChild(C),Wc?(L.setAttribute("style","display:block;margin-right:5px;"),Nb[La].appendChild(L)):(C="10",null!=ze&&(C=10+ze[w]),L.setAttribute("style","margin-left:"+C+"px;"),Ob.appendChild(L)),F[w].isGhost=!1)}}Wc&&(fd[La]=t("button"),ea(fd[La],"menu"+La,"Show Overlay Menu","Hide Menu",m,"menu off"),fd[La].menuInx=La,fd[La].addEventListener("click",function(a){if("hidden"===Nb[this.menuInx].style.visibility){for(a=
1;a<Nb.length;a++)"visible"==Nb[a].style.visibility&&(Nb[fd[a].menuInx].style.visibility="hidden",G(fd[a],!0,"menu off"));Nb[this.menuInx].style.visibility="visible";G(this,!1,"menu on")}else Nb[this.menuInx].style.visibility="hidden",G(this,!0,"menu off")},!1),x.appendChild(fd[La]),z.insertBefore(Nb[La],Qa));if(null==Yb)for(Yb=Array(Xb.length),w=0;w<Xb.length;w++)Yb[w]=0;else for(w=0;w<Xb.length;w++)Na(w)}}Ua=!0;Qe=null;f=e.start_looping;null!=f&&(c=f.split(","),D(c[0],"f")&&(Ua=!1),1<c.length&&
(Cc=parseInt(c[1],10)-1,isNaN(Cc)&&(Cc=0),q=Cc),2<c.length&&(D(c[2],"t")&&(Qe=!0),D(c[2],"f")&&(Qe=!1)));I(Ua)}function Na(b){var a;if(0>Yb[b]){var d=!1;for(a=0;a<Xb.length;a++)Yb[a]!=-Yb[b]||d||(d=F[a].checked);F[b].checked=d}}function Qb(b){0==nb&&(ob=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var a=b[4].trim(),d=b[4].indexOf("/"),c=b[4].indexOf("?"),g=-1,k=-1;-1!=d&&(g=parseInt(b[4].substring(d+1),10)-1,a=a.substring(0,d));-1!=c&&(k=parseInt(b[4].substring(c+1),10)-1,c<d||-1==d)&&(a=a.substring(0,
c));ob[nb]=new Cb(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),a.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),g,k,8==b.length?b[7].trim():null);nb+=1}function Gc(b){0==Oe&&(Sa=[],qa=null);var a=b.substr(b.indexOf("=")+1).trim().split("(");b=a[0].split(",");var d=b[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));Sa[Oe]=new Oa(d,b[1].trim(),b[2].trim(),b[3].trim(),a[1].trim());Oe+=1}function hd(b){0==wb&&(Ha=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");
Ha[wb]=new qc(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");wb+=1}function Oa(b,a,d,c,g){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=a;this.value=d;this.tip=c;this.poly=g;b=g.split(",");this.xy=[];this.ymin=this.xmin=9999;for(a=this.ymax=this.xmax=0;a<b.length;a++)this.xy[a]=parseInt(b[a].trim(),10),0==
a%2?(this.xy[a]<this.xmin&&(this.xmin=this.xy[a]),this.xy[a]>this.xmax&&(this.xmax=this.xy[a])):(this.xy[a]<this.ymin&&(this.ymin=this.xy[a]),this.xy[a]>this.ymax&&(this.ymax=this.xy[a]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=t("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-
this.xmin,this.xy[1]-this.ymin);for(a=2;a<this.xy.length;a+=2)this.ctx.lineTo(this.xy[a]-this.xmin,this.xy[a+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function qc(b,a,d,c,g){this.overlay=b;this.color=a;this.action=d;this.value=c;this.tip=g}function Cb(b,a,d,c,g,k,e,f,h,n){this.x0=b;this.y0=a;this.icon=null;this.isIcon=!1;if("icon"==d)this.icon=new Image,this.icon.hotspot=this,Yf=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+
this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.zoomme=this.fromfile=this.anim=!1,this.icon.gotit=!1,this.icon.src=c.trim();else if("sprite"==d||"spritefn"===d){this.x0=b;this.y0=a;this.inx=parseInt(c,10)-1;ke=!1;yg?null!=ka&&(-1!=Uc?this.inx>=Uc&&this.inx<=Uc+ka.length&&(ke=!0):"spritefn"===d&&(ke=!0)):ke=!0;if(ke){-1!=Uc&&
(this.inx-=Uc);if(this.inx>=ka.length)return null;this.x1=ka[this.inx].width+b;this.y1=ka[this.inx].height+a;this.width=ka[this.inx].width;this.height=ka[this.inx].height;this.w2=this.width/2;this.h2=this.height/2;this.origY=this.origX=0;this.icon=ka[this.inx].cloneNode();this.anim=ka[this.inx].anim;this.fromfile=ka[this.inx].fromfile;this.zoomme=ka[this.inx].zoomme;this.anim&&(this.icon.setAttribute("style","position:absolute;top:0px;left:0px;visibility:hidden;"),zc.appendChild(this.icon))}else this.x1=
Vb[this.inx]+b,this.y1=Wb[this.inx]+a,this.width=Vb[this.inx],this.height=Wb[this.inx],this.w2=Vb[this.inx]/2,this.h2=Wb[this.inx]/2,this.origX=rf[this.inx],this.origY=sf[this.inx],this.icon=qf,this.zoomme=this.fromfile=this.anim=!1;Yf=this.isIcon=!0;this.icon.gotit=!0}else this.width=parseInt(d,10),this.height=parseInt(c,10),this.x1=this.width+b,this.y1=this.height+a,this.w2=this.width/2,this.h2=this.height/2;this.pan=g;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=k;this.value=e;this.overlay=
f;this.frame=h;this.tip=n}function Ya(){if(Ad&&!pd){W=-1;for(var b=0;b<na.length;b++)B>=na[b]&&(W=b)}}function Rb(){null!=dc?eb=dc.toLatLon(ra,sa):null!=Gf?(eb[0]=Gf+(ai-Gf)*sa/ja,eb[1]=oh+(bi-oh)*ra/oa):(eb[0]=Math.round(ra),eb[1]=Math.round(sa))}function Sb(b,a){"popup"==b.action?(null!=Zf&&Zf.close(),Zf=window.open("","HAniSPopup","scrollbars=yes,width="+bh+",height="+ah),Zf.document.write($g+b.value+"</div>")):"link"==b.action?(b=b.value,Rb(),b=b.replace("%LATITUDE%",eb[0].toFixed(4)),b=b.replace("%LONGITUDE%",
eb[1].toFixed(4)),b=b.replace("%FRAMENUMBER%",q+1),window.open(b,"_blank","")):"fof"==b.action&&(fa=Pg,H.resetZoom(),H.newFOF(b.value,!0),gf(a))}function Gd(){var b=Wg?Td/B:0;R+b<Td&&(R=Td-b);b=Yg?Ud/B:0;R+cb-b>oa-Ud&&(R=oa-cb+b-Ud);b=Ug?Sd/C:0;S+b<Sd&&(S=Sd-b);b=Sg?Rd/C:0;S+bb-b>ja-Rd&&(S=ja-bb-Rd+b);S=Math.round(S);R=Math.round(R)}function Hd(b){var a=!1;b?pd?(W--,0>W?a=!0:(B=na[W],C=na[W])):(B-=.1*od/A,C-=.1*od/E):pd?(W++,W>=na.length?(W--,Bf&&(a=!0)):(B=na[W],C=na[W])):(!Bf||B!==Oc&&C!==Oc||(a=
!0),B+=.1*od/A,C+=.1*od/E,B>Oc&&(B=Oc),C>Oc&&(C=Oc));a||B<=Pe||C<=We?(B=Pe,C=We,W=-1,ra=y,sa=p,S=R=0,bb=ja,cb=oa,Td=Ud=Sd=Rd=0,td&&(mb=!0)):(Rd=Rg,Sd=Tg,Ud=Xg,Td=Vg,R=ra-y/B,S=sa-p/C,bb=Math.floor(ja/C),cb=Math.floor(oa/B),Gd(),td&&(mb=!1));Ya()}function Tb(){Xe=0;Pb=Array(2);Ab=Array(2);Bd=Array(2);Va=0;md=null;ya(xa(0))}function I(b){Ea=!b;H.toggleIsLooping()}function Id(b,a,d,c,g,k){Zd.clearRect(0,0,V,ba);Zd.imageSmoothingEnabled=Nd;M.imageSmoothingEnabled=Nd;Zd.drawImage(b,a,d,c,g,0,0,V,ba);Eh=
Zd.getImageData(0,0,V,ba);gd=Eh.data;$f=Za[k];ag=$a[k];bg=ab[k];cg=Xd[k];ii=4*V*ba;for(kc=0;kc<ii;kc+=4)fb=gd[kc],fb===gd[kc+1]&&fb===gd[kc+2]&&(gd[kc]=$f[fb],gd[kc+1]=ag[fb],gd[kc+2]=bg[fb],gd[kc+3]=cg[fb]);Zd.putImageData(Eh,0,0);M.drawImage(Ie,0,0,V,ba)}function G(b,a,d){null!=b&&(a?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&b.setAttribute("style",b.style_off),b.innerHTML=b.label_off),jb&&(b.className=d))}function ib(b,a){if(!(b>=u)&&(-2==
Ta[b]&&(a=-2),Ta[b]=a,If&&1==a&&(lb.value=b+1,fe.innerHTML=Re.replace("*",b+1)),Wf)){b=Fh+b*(zd+Ue);var d=Bh;0==a?d=Ah:-1==a?d=zh:-2==a&&(d=Ag);Vf.fillStyle=d;Vf.fillRect(b,Te/2,zd,Te)}}function re(b,a){Wf&&(ed.width=Ch?parseInt(z.style.width,10):V,Vf.clearRect(0,0,ed.width,ed.height),Fh=ed.width/2-b*(zd+Ue)/2);for(var d=0;d<b;d++)a?-1!=Od?ib(d,-2):null!=Ve&&"n"==Ve[d].toLowerCase().trim()?ib(d,-1):ib(d,0):ib(d,Ta[d])}function ya(b){ib(q,0);q=b;ib(q,1);null!=Ka&&null!=db&&null!=db[q]&&(Ka.innerHTML=
db[q]);void 0!=Ye&&Ye(q)}function xa(b){b>=u&&(b=u-1);if(0<=Ta[b])return b;var a=-1,d=b;0==d&&(a=1);for(var c=0;c<u-1;c++)if(d+=a,0<=Ta[d])return d;return b}function Db(b){ib(q,0);var a=b;do 0<a?(a=xa(u-1),q+=1,q>a&&(le&&Ea?(q=a,b=-b,xb&&I(!1)):xb?(q=a,I(!1)):q=xa(0))):(a=xa(0),--q,q<a&&(le&&Ea?(q=a,b=-b,xb&&I(!1)):xb?(q=a,I(!1)):q=xa(u-1))),a=b;while(0>Ta[q]);xb=Ze;void 0!=Ye&&Ye(q);Of=a;ib(q,1);null!=Ka&&null!=db&&null!=db[q]&&(Ka.innerHTML=db[q])}function hb(b,a,d,c,g,k,e){this.bg=b;null!=b&&0==
this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=a;null!=a&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=c;null!=c&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=g;this.sxoff=k;this.syoff=e}function Pa(b,a,d,c,g){f.globalAlpha=1;f.font=b.font;var k=b.fontHeight;d=d-k-6;var e=f.measureText(c).width;1==g&&(a-=e);0==g&&(a-=e/2);5>a&&(a=5);5>d&&(d=5);d+k+3>ba&&
(d=ba-k-6);a+3+e>V&&(a=V-e-6);f.save();f.beginPath();f.fillStyle=b.bg;null!=b.scolor&&(f.shadowColor=b.scolor,f.shadowBlur=b.sblur,f.shadowOffsetX=b.sxoff,f.shadowOffsetY=b.syoff);$e=a-3;dg=d;Gh=e+6;eg=k+6;f.fillRect($e,dg,Gh,eg);f.closePath();f.restore();f.textBaseline="bottom";f.fillStyle=b.fg;f.fillText(c,a,d+k+3)}function aa(){f.clearRect(0,0,V,ba);fg=!1;if(gb){f.beginPath();f.lineWidth=2;f.strokeStyle="white";var b=Va;1<b&&(b=2);for(var a=0;a<b;a++)1<Va&&(f.moveTo(Pb[0]/A,Ab[0]/E),f.lineTo(Pb[1]/
A,Ab[1]/E)),f.moveTo(Pb[a]/A-15,Ab[a]/E),f.lineTo(Pb[a]/A+15,Ab[a]/E),f.moveTo(Pb[a]/A,Ab[a]/E-15),f.lineTo(Pb[a]/A,Ab[a]/E+15);f.closePath();f.stroke();if(3==Va){var d=X,c=T;f.moveTo(d,c);f.fillStyle=wc;f.fillRect(d-2,c-2,5,5);b=Cd;a=Math.round(d+af/A*me*(Cd-Bd[1]));for(var g=Math.round(c+ne/E*me*(Cd-Bd[1])),e=0;300>e;e++){f.beginPath();f.lineWidth=1;f.strokeStyle=wc;f.moveTo(d,c);f.lineTo(a,g);f.stroke();f.beginPath();f.lineWidth=3;f.rect(a-2,g-2,5,5);f.stroke();if(3>a||a+3>V||3>g||g+3>ba)break;
c=ec+b;c=100*Math.floor(c/60)+c%60;c%=2400;Kg?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=0;Math.abs(gg)<ld+5&&(c=45*.0174533);var h=g;0>Hh*gg&&0==c&&(h=g+ld);f.font=Qd;d=d+" "+Jg;var l=f.measureText(d).width;f.fillStyle=Pd;0===c?(f.fillRect(a+2,h-ld-2+c,l+4,ld+3),f.fillStyle=wc,f.textBaseline="bottom",f.fillText(d,a+5,h)):(f.save(),f.translate(a+
5,g),f.rotate(c),f.fillRect(2,-2,l+4,ld+3),f.fillStyle=wc,f.textBaseline="bottom",f.fillText(d,5,ld),f.restore());d=a;c=g;a=Math.round(d+me*Hh);g=Math.round(c+me*gg);b+=Y}}null!=md&&Pa(xf,ji,ki,md,0);ee&&(Pa(Wh,9999,hh,gh[Xe],0),Ih=$e,Jh=dg,Kh=dg+eg)}if(yb){ee&&(0==xd?Pa(th,9999,10,Ee[0],0):(Pa(fi,10,10,Ee[1],0),li=$e+Gh,Pa(th,9999,10,Ee[2],0)),mi=$e,ni=eg);f.beginPath();f.lineWidth=2;f.strokeStyle=ih;for(b=0;b<pa.length;b+=2)0==b?f.moveTo(pa[b]/A,pa[b+1]/E):f.lineTo(pa[b]/A,pa[b+1]/E);Fe&4<pa.length&&
f.lineTo(pa[0]/A,pa[1]/E);f.stroke();for(b=0;b<pa.length;b+=2)f.beginPath(),f.rect(pa[b]/A-2,pa[b+1]/E-2,5,5),f.stroke()}if(Lb)for(b=0;b<r.length;b++){a=r[b].type;f.beginPath();f.strokeStyle=r[b].color;f.lineWidth=r[b].width;if("0"==a)a=Math.atan2(r[b].xe-r[b].x,r[b].ye-r[b].y),g=r[b].x+r[b].width*Math.sin(a),e=r[b].y+r[b].width*Math.cos(a),f.beginPath(),f.moveTo(g,e),f.lineTo(r[b].xe,r[b].ye),d=12+r[b].width/5,f.moveTo(g+d*Math.sin(a-.523599),e+d*Math.cos(a-.523599)),f.lineTo(g,e),f.lineTo(g+d*Math.sin(a+
.523599),e+d*Math.cos(a+.523599));else if("1"==a)f.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==a)f.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);else if("3"==a){f.moveTo(r[b].xp[0],r[b].yp[0]);for(g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],r[b].yp[g]);f.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==a)for(f.moveTo(r[b].xp[0],r[b].yp[0]),g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],r[b].yp[g]);else"5"==a&&(f.fillStyle=r[b].color,f.font=r[b].width+"pt arial",a=f.measureText(r[b].text).width,
f.fillText(r[b].text,r[b].x-a/2,r[b].y+r[b].width/2));f.stroke()}$c&&(b=Hc*(bf-oe)/B,a=ue*(cf-pe)/C,b=" "+Math.sqrt(b*b+a*a).toFixed(tg)+" "+sg+" ",Pa(Uh,oe/A,pe/E,b,-1),f.beginPath(),f.strokeStyle=ug,f.lineWidth=3,f.moveTo(bf/A,cf/E),f.lineTo(oe/A,pe/E),f.stroke(),f.closePath());Hb&&Pa(Og,Lh,Mh,Nh,-1);if(Ub||vd)if(X=ma.getX(),y=X*A,T=ma.getY(),p=T*E,0<=y&&0<=p){ra=R+y/B;sa=S+p/C;if(vd){Rb();oi=pg+eb[0].toFixed(lf)+"  "+qg+eb[1].toFixed(lf);b=T;if($c||Hb)b=T+rg.fontHeight+6;Pa(rg,X+10,b,oi,-1)}if(Ub&&
Rc&&Zc)if(ra=Math.round(ra),sa=Math.round(sa),of)Wa.clearRect(0,0,1,1),Wa.drawImage(Ia[q],ra,sa,1,1,0,0,1,1),U=Wa.getImageData(0,0,1,1).data,Q=0,Jd(!1);else for(b=0;b<da;b++)if(a=da-b-1,K[q][a].gotit&&F[a].checked&&(a==qb||null!=uc[a]&&0<=uc[a])){Wa.clearRect(0,0,1,1);a==qb?Wa.drawImage(fc[q],ra,sa,1,1,0,0,1,1):Wa.drawImage(K[q][a],ra,sa,1,1,0,0,1,1);U=Wa.getImageData(0,0,1,1).data;Q=uc[a];null!=Q&&Jd(a==qb||mh);break}}!mb||gb||sc||Ub||null==qa||(f.drawImage(qa.can,0,0,qa.width,qa.height,qa.xmin/
A,qa.ymin/E,qa.width/A,qa.height/E),Pa(Og,(qa.xmin+qa.xmax)/2/A,(qa.ymin+qa.ymax)/2/E,qa.tip,0),fg=!0)}function Jd(b){df=999;lc=vg;var a=vb[Q].length-1;if(0==U[3])lc=He[Q];else{if(wg)mc=U[0];else if(b)hg=0,mc=U[0],df=0;else for(var d=0;d<a;d++)nc[0]=U[0]-Za[Q][d],0>nc[0]*(Za[Q][d+1]-U[0]-1)||(nc[1]=U[1]-$a[Q][d],0>nc[1]*($a[Q][d+1]-U[1]-1)||(nc[2]=U[2]-ab[Q][d],0>nc[2]*(ab[Q][d+1]-U[2]-1)||(Dd=Ff[Q][d],ig=nc[Dd]/Vc[Q][d][Dd],Oh=Math.abs(nc[Ph[Dd]]-ig*Vc[Q][d][Ph[Dd]])+Math.abs(nc[Qh[Dd]]-ig*Vc[Q][d][Qh[Dd]]),
Oh<df&&(mc=d,df=Oh,hg=ig))));if(999>df)lc=Tc[Q][mc],-1!=cc[Q][mc]&&(Rh=vb[Q][mc],0!=hg&&(Rh+=hg*(vb[Q][mc+1]-vb[Q][mc])),lc=lc+" "+Rh.toFixed(cc[Q][mc])+" "+Sc[Q][mc]);else if(b||0<Ld){var c=-1;if(b)c=U[0];else for(d=0;d<a;d++)if(Math.abs(U[0]-Za[Q][d])<Ld&&Math.abs(U[1]-$a[Q][d])<Ld&&Math.abs(U[2]-ab[Q][d])<Ld){c=d;break}-1!=c&&(lc=Tc[Q][c],-1!=cc[Q][c]&&(lc=lc+" "+vb[Q][c].toFixed(cc[Q][c])+" "+Sc[Q][c]))}}"hide"!=lc&&Pa(Vh,X-10,T,lc,1)}function Z(){if(Zc)try{M.clearRect(0,0,V,ba);M.globalAlpha=
1;if(!Zg)if(Ad&&null!=gc&&0<=W&&gc[W].gotit)M.drawImage(gc[W],R*na[W],S*na[W],cb*na[W],bb*na[W],0,0,V,ba);else if(Ia[q].gotit&&(null!=tf?Id(Ia[q],R,S,cb,bb,tf):M.drawImage(Ia[q],R,S,cb,bb,0,0,V,ba)),null!=Ga&&(M.globalAlpha=1,Ia[q].gotit))for(var b=0;b<Ga.length;b+=4)M.drawImage(Ia[q],Ga[b],Ga[b+1],Ga[b+2],Ga[b+3],Ga[b]/A,Ga[b+1]/E,Ga[b+2]/A,Ga[b+3]/E);if(0<da){for(b=0;b<da;b++){var a=null!=Lc?Lc[b]:b;!vf[a]&&F[a].checked&&F[a].showMe&&(null!=Ae&&(M.globalAlpha=Ae[a]),Ad&&0<=W&&null!=va&&void 0!=
va[a]&&va[a][W][q].gotit?M.drawImage(va[a][W][q],R*na[W],S*na[W],cb*na[W],bb*na[W],0,0,V,ba):K[q][a].gotit&&(null==Mc||1===Mc[a]?null!=Jc&&0<=Jc[a]?Id(K[q][a],R,S,cb,bb,Jc[a]):M.drawImage(K[q][a],R,S,cb,bb,0,0,V,ba):0===Mc[a]&&M.drawImage(K[q][a],0,0,oa,ja,0,0,V,ba)))}if(null!=rb)for(M.globalAlpha=1,b=0;b<da;b++)if(a=null!=Lc?Lc[b]:b,K[q][a].gotit&&(Ig[a]||F[a].checked)&&rb[a])for(var d=0;d<ca[a].length;d++)M.drawImage(null!=K[q][a].origImage?K[q][a].origImage:K[q][a],ca[a][d][0],ca[a][d][1],ca[a][d][2],
ca[a][d][3],ca[a][d][4]/A,ca[a][d][5]/E,ca[a][d][2]/A,ca[a][d][3]/E)}Ub&&aa();sh&&n();if(Yf)for(M.globalAlpha=1,a=0;a<nb;a++)if(null!=ob[a]){var c=ob[a];null!=c.icon&&(c.icon.style.visibility="hidden");if((-1==c.frame||c.frame==q)&&null!=c.icon&&c.icon.gotit&&(-1==c.overlay||-1!=c.overlay&&F[c.overlay].checked)){if(c.isPan){c.zoomme&&(c.icon.style.width=Math.round(c.width*B)+"px",c.icon.style.height=Math.round(c.height*C)+"px",c.w2=Math.round(c.width*B/2),c.h2=Math.round(c.height*C/2));var g=Math.round(((c.x0-
R)*B-c.w2)/A);var e=Math.round(((c.y0-S)*C-c.h2)/E);if(c.anim){if(0>=g+c.icon.width||g>=oa||0>=e+c.icon.height||e>=ja)continue;c.icon.style.top=e+"px";c.icon.style.left=g+"px"}else M.drawImage(c.icon,c.origX,c.origY,c.width,c.height,g,e,c.width/A,c.height/E)}else M.drawImage(c.icon,c.origX,c.origY,c.width,c.height,c.x0/A,c.y0/E,c.width/A,c.height/E);c.icon.style.visibility="visible"}}}catch(m){ia("Error:"+m)}}function ta(b,a,d){!De||d>=a||(M.save(),M.fillStyle="blue",M.strokeStyle="white",M.lineWidth=
3,M.strokeRect(Je,Ke,200,18),M.fillRect(Je,Ke,d/a*200,18),a=M.measureText(b).width,M.fillStyle="orange",M.font="14px arial",M.fillText(b,Je+100-a/2,Ke+14),M.restore())}function n(){De&&Gb>Da?ta("Loading Images",Gb,Da):(sh=!1,kf&&(rc.style.visibility="hidden"));Da>=Gb&&!Ea&&ya(xa(q));void 0!=Me&&Da>=Gb&&Me(!0)}function ia(b){if(se&&jf&&!jf.closed)try{jf.document.write(b+"<br>")}catch(a){}}function ei(){Ea&&Db(Of);pi=q==xa(u-1)?xg+Ba:Ba;Z();setTimeout(function(){vi(ei)},pi)}function ef(b){for(;-180>
b;)b+=360;for(;180<b;)b-=360;return b}function ti(){var b,a,d,c,g,e,f,h,n=Math.PI/180;this.init=function(c){for(var d=[],k=1;k<c.length;k++)d[k]=parseFloat(c[k]);a=d[1];b=d[4]/d[5];g=d[6];e=d[7];c=this.toXY(d[2],d[3]);g=c[0];e=c[1]};this.toXY=function(k,f){d=b*ef(f-a)*n-g;c=-b*k*n-e;return[d,c]};this.toLatLon=function(c,d){f=-(d+e)/b/n;h=ef((c+g)/b/n+a);return[f,h]}}function si(){var b,a,d,c,g,e,f,h,n,t,r,u,v,q,z,A,w,C,L,y,p,F,D,E,B,x,I,G,K,J,M,H=Math.PI/180;this.init=function(c){for(var d=[],g=1;g<
c.length;g++)d[g]=parseFloat(c[g]);b=d[1];a=d[2];y=0==d[8]?!1:!0;p=d[6];F=p*p;D=F*F;E=D*F;B=D*D;f=d[5]/d[7];M=d[7];y?(h=Math.cos(H*b),n=Math.sin(H*b)):(h=Math.cos(-b*H),n=Math.sin(-b*H));w=h/Math.sqrt(1-F*n*n);L=(1-p*n)/(1+p*n);A=y?Math.tan(Math.PI/4-b*H/2)/Math.pow(L,p/2):Math.tan(Math.PI/4- -b*H/2)/Math.pow(L,p/2);q=d[9];z=d[10];c=this.toXY(d[3],d[4]);q=c[0];z=c[1]};this.toXY=function(k,h){y?(g=H*k,e=H*(h-a)):(g=H*-k,e=H*(a-h));L=(1-p*Math.sin(g))/(1+p*Math.sin(g));C=Math.tan(Math.PI/4-g/2)/Math.pow(L,
p/2);x=90!=b&&-90!=b?f*w*C/A:2*f*M*C/Math.sqrt(Math.pow(1+p,1+p)*Math.pow(1-p,1-p));d=x*Math.sin(e);c=x*Math.cos(e);y||(d=-d,c=-c);t=d-q;r=c-z;return[t,r]};this.toLatLon=function(e,k){d=e+q;c=k+z;x=Math.sqrt(d*d+c*c);C=90==b||-90==b?x*Math.sqrt(Math.pow(1+p,1+p)*Math.pow(1-p,1-p))/(2*f*M):x*A/(f*w);I=Math.PI/2-2*Math.atan(C);G=Math.sin(2*I);K=Math.sin(4*I);J=Math.sin(6*I);g=I+G*F/2+5*G*D/24+G*E/12+13*G*B/360+7*K*D/48+29*K*E/240+811*K*B/11520+7*J*E/120+81*J*B/1120+4279*Math.sin(8*I)*B/161280;y?(u=
g/H,v=Math.atan2(d,c)/H+a):(u=-g/H,v=-Math.atan2(-d,-c)/H+a);return[u,ef(v)]}}function ui(){var b,a,d,c,g,e,f,h,n,t,r,u,p,v,q,z,w,y,L,C,A,F,D,x,B,E,I,H,G,K,J,M,P,O,Q,N=Math.PI/180;this.init=function(c){for(var g=[],e=1;e<c.length;e++)g[e]=parseFloat(c[e]);b=g[1];a=g[2];d=g[3];x=g[7];B=x*x;E=B*B;I=E*B;H=E*E;h=g[6]/g[8];n=Math.cos(N*b);t=Math.cos(N*a);u=Math.sin(b*N);r=Math.sin(a*N);A=n/Math.sqrt(1-B*u*u);F=t/Math.sqrt(1-B*r*r);L=Math.sqrt((1-u)/(1+u)*Math.pow((1+x*u)/(1-x*u),x));C=Math.sqrt((1-r)/
(1+r)*Math.pow((1+x*r)/(1-x*r),x));J=(Math.log(A)-Math.log(F))/(Math.log(L)-Math.log(C));M=A/(J*Math.pow(L,J));O=h*M*Math.pow(L,J);w=g[9];y=g[10];c=this.toXY(g[4],g[5]);w=c[0];y=c[1]};this.toXY=function(a,b){e=N*a;f=N*ef(b-d);Q=Math.sin(e);D=Math.sqrt((1-Q)/(1+Q)*Math.pow((1+x*Q)/(1-x*Q),x));K=h*M*Math.pow(D,J);P=J*f;c=K*Math.sin(P);g=O+K*Math.cos(P);p=c-w;v=g-y;return[p,v]};this.toLatLon=function(a,b){c=a+w;g=b+y;K=Math.abs(J)/J*Math.sqrt(c*c+(O-g)*(O-g));D=Math.pow(K/(h*M),1/J);G=Math.PI/2-2*Math.atan(D);
P=0>J?Math.atan(-c/(g-O)):Math.atan(c/(O-g));f=P/J;e=G+(B/2+5/24*E+I/12+13/360*H)*Math.sin(2*G)+(7/48*E+29/240*I+811/11520*H)*Math.sin(6*G)+(7/120*I+81/1120*H)*Math.sin(6*G)+4279/161280*H*Math.sin(8*G);q=e/N;z=ef(d-f/N);return[q,z]}}var H=this,zg,ba,V,ja,oa,A,E,jh,kh,Ib,Jb,rc,kf,ma,se,Zf,jf,Dc,jg,uf=!1,z,x,Mf,Nf,Qa,zc,rd,pb,M,Wa,tc,f,Yd,Lf,Nc,yf,Ce,rh,zf,Ac,u,ua,ch,Nb,Wc,La,fd,da,vf,Xb,Lc,ha,Bc,Yb,nd,fa,Pg,Ia,K,F,Ae,be,Hb,Nh,Lh,Mh,kd,Eb,Bg,O,Cg,kg,Sh,X,T,y,p,ra,sa,cb,bb,R,S,ee,jb,Cc,di,Ea,Ua,Qe,q,
Ye,Of,le,yc,qd=!0,ye,lg,te,e,Ba,$b,Pc,yd,Me,Cf,xg,pi,Nd,Ca,sd,Kc,qb,Ra,fc,Xc,ae,Jf,Ne,tf,Ie,Zd,Eh,gd,fb,$f,ag,bg,cg,ii,kc,Jc,Ta,zd,Te,Ue,Ch,zb,Fh,Dh,zh,Ah,Bh,Od,Ag,ob,nb,Yf,Af,Ef,ka,Uc,ke,ph,wb,Ha,U,mg,Sa,Oe,mb,td,Kf,$d,qa,fg,vc,jd,na,W,gc,Yc,va,Ja,Ad,db,Ka,Fc,Wf,Ve,ed,Vf,Zc,id,Fb,ub,tb,Kb,bc,ac,ze,ad,yb,xd,Ee,Df,Fe,ih,pa,fi,th,mi,li,ni,hc,gb,Va,Pb,Ab,Bd,Ih,gh,Jh,Kh,hh,Wh,sb,me,af,ne,Th,Wd,Hf,Hh,gg,Cd,Y,Xe,ec,Be,Jg,wc,Pd,Qd,ld,Kg,Lg,hi,Tf,Uf,Rf,Sf,ge,r,Qf,xh,jc,yh,la,Lb,dd,he,cd,bd,Se,gi,je,ie,Ec,
Mb,uh,vh,Aa,Qg,od,B,C,Pe,We,fh,xc,Vd,eh,dh,za,Oc,pd,ff,Bf,Dg=!1,Eg,Fg,Gg,wf,Hg,xb,Ze,ce,de,lb,Re,fe,If,ic,sc,bf,cf,tg,ve,$e,dg,Gh,eg,qh=!0,Le,og,oe,pe,Uh,ug,nf,Fa,mf,we,$c,Hc,ue,sg,Og,ud,vd,lf,pg,qg,rg,dc,eb,oi,Gf,oh,ai,bi,Ga,Ob,Xf,Mc,rb,ca,Ig,Pf,Ge,Qc,$g,bh,ah,uc,Ub,wd,xe,Rc,Sc,Tc,cc,Dd,df,Vh,vg,Ld,wg,of,xf,Mg,Ng,md,ji,ki,mc,hg,ig,Ph,Qh,nc,Q,Oh,lc,Rh,vb,v,Vc,mh,Za,$a,ab,Xd,Ff,He,qi,Md,pf,Ic,De,qf,rf,sf,Vb,Wb,yg,sh,Je,Ke,Da,Gb,Rd,Zg,Rg,Sd,Tg,Td,Vg,Sg,Ug,Yg,Wg,Ud,Xg,Kd,Zb,wi="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),
vi=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},t=function(b){return document.createElement(b)},D=function(b,a){return null==b?!1:0==b.trim().toLowerCase().indexOf(a)},ci=function(b,a){if(null!=b)return b=b.trim(),b.lastIndexOf(a)===b.length-1},$h=function(b){void 0==jg&&(jg=t("textarea"));jg.innerHTML=b;return jg.value},wh=function(b,a,d){var c=t("select");c.style.width="70px";c.style.margin=
"5px";for(var g=0;g<b.length;g++){var e=t("option");e.innerHTML=b[g];e.value=a[g];c.add(e)}c.addEventListener("change",d,!1);return c},Zh=function(b){b=b.split(",");ha=Array(u);for(var a=0;a<b.length;a++){var d=b[a].split("&");da=b.length;for(var c=0;c<u;c++)0===a&&(ha[c]=Array(da)),ha[c][a]=d[1==d.length?0:c].trim(),null!=Zb?ha[c][a]=(Zb+ha[c][a]).trim():null!=fa&&(ha[c][a]=(fa+ha[c][a]).trim())}id=!1},Xh=function(b){b=b.split(",");u=b.length;ua=Array(u);for(var a=0;a<u;a++)ua[a]=null!=fa?fa+b[a].trim():
b[a].trim();id=!1;u>da&&(da=0)},Yh=function(b,a,d){var c=b;null!=fa&&(c=fa+b);ua=Array(u);for(var g=0;g<u;g++){b=g*d+a;if(0<=c.indexOf("*"))ua[g]=c.replace("*",b);else if(0<=c.indexOf("?")){for(var k=c;0<=k.lastIndexOf("?");){var f=k.lastIndexOf("?");k=k.substring(0,f)+b%10+k.substring(f+1);b=Math.floor(b/10)}ua[g]=k}else ua[g]=c+g;ia("image filename = "+ua[g])}D(e.reverse_order,"t")&&ua.reverse();id=!1;u>da&&(da=0)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,
"toBlob",{value:function(b,a,d){d=window.atob(this.toDataURL(a,d).split(",")[1]);for(var c=d.length,g=new Uint8Array(c),e=0;e<c;e++)g[e]=d.charCodeAt(e);b(new Blob([g],{type:a||"image/png"}))}});this.setup=function(b,a,d,c){void 0==a&&(a="MORdivcan");Le=d;void 0!=Le&&"function"!=typeof initiCall&&(Le=null);og=void 0!=c?c.split("\n"):null;z=document.getElementById(a);Kd="center";z.align=Kd;Qa=t("div");Qa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");
pb=t("canvas");pb.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");M=pb.getContext("2d");tc=t("canvas");tc.setAttribute("style","position:absolute;top:0;left:0;z-index:6;");f=tc.getContext("2d");f.imageSmoothingEnabled=!1;Yd=t("canvas");Yd.setAttribute("style","position:absolute;top:0;left:0;z-index:10;");Lf=Yd.getContext("2d");Lf.imageSmoothingEnabled=!1;zc=t("div");zc.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;border-width:0px;padding:0px;margin:0px;");
rd=t("div");rd.setAttribute("style","position:absolute;top:0;left:0;z-index:10;overflow:hidden;border-width:0px;padding:0px;margin:0px;");rd.appendChild(Yd);Ie=t("canvas");Qa.appendChild(rd);Qa.appendChild(pb);Qa.appendChild(tc);Qa.appendChild(zc);z.appendChild(Qa);ma=new PEvs(Qa,H.down,H.up,H.move,H.drag,null,H.canTip);z.setAttribute("tabindex",0);z.addEventListener("keyup",function(a){Lb||te||(lg=!1,a.preventDefault(),a.stopPropagation())},!1);z.addEventListener("keypress",function(a){Lb||te||(a.preventDefault(),
a.stopPropagation())},!1);z.addEventListener("keydown",function(a){Lb||te||(a.preventDefault(),a.stopPropagation(),lg=a.ctrlKey?!0:!1,37==a.keyCode?(I(!1),Db(-1),Z()):39==a.keyCode?(I(!1),Db(1),Z()):32==a.keyCode?H.toggleIsLooping():82==a.keyCode&&a.altKey&&H.resetZoom())},!1);rd.addEventListener("mouseenter",function(a){z.focus()},!1);z.style.outlineWidth="0px";z.style.outline="none";z.focus();Cc=q=0;le=!1;Of=1;Ze=xb=!1;Ua=Ea=!0;nb=da=u=0;ye=!0;Lc=null;Nb=[];Wc=!1;La=0;fd=[];yc=!0;Ba=500;$b=100;
Pc=2E3;Cf=30;xg=0;pf=6E4;Ic=null;Nc=Md=!1;Ce=!0;Ac=[];na=Pg=nd=Zb=fa=null;Ad=!1;W=-1;pd=!1;We=Pe=C=B=1;ff=!1;S=R=bb=cb=sa=ra=p=y=T=X=0;fh=!1;qd=qh=!0;Wf=kf=uf=!1;Od=-1;Ta=[];wb=0;Yf=!1;ka=null;Uc=-1;Ef=0;ke=!1;Ka=null;Ke=Je=Da=Gb=0;mh=!1;Q=0;Hb=zf=Af=Zc=!1;bf=cf=oe=pe=0;$c=sc=!1;Fa=[];Fa.push("default");Fa.push("default");mf="default";vd=!1;we="default";dc=null;eb=[0,0];mb=If=ve=!1;jd=!0;qa=vc=null;yb=fg=!1;Fe=!0;nf="default";ee=!0;pa=[];Ub=of=!1;xe="default";Rc=!1;Ph=[1,0,0];Qh=[2,2,1];nc=[];uc=
[];Kc=sd=gb=!1;Be=Xe=0;Ob=Nf=Mf=x=zb=null;Xf=0;Lb=te=lg=!1;a=t("canvas");a.height=1;a.width=1;Wa=a.getContext("2d");Wa.imageSmoothingEnabled=!1;Kf=t("canvas");se=!1;"string"===typeof b?0>b.indexOf("\n")?ng(b):h(b.split("\n")):h(b)};this.newBasenames=function(b,a,d,c){Zc=!1;Ua=Ea;I(!1);u=c;Yh(b,a,d);yc=!0;Ma()};this.newFilenames=function(b){Zc=!1;Ua=Ea;I(!1);Xh(b);yc=!0;Ma()};this.newOverlayFilenames=function(b){Zc=!1;Ua=Ea;I(!1);Zh(b);yc=!0;Ma()};this.newProbeTable=function(b){Rc=!1;N(b.trim())};
this.reloadFOF=function(){ia("reload FoF = "+Ic);gf("r");id?ri(qi,!1):(Ua=null==Qe?!0:Ea,yc=!0,Ma())};this.getFOF=function(){var b=e.file_of_filenames.trim();H.newFOF(null!=nd?nd+b:b,!0)};this.newFOF=function(b,a){H.resetZoom();ri(b,a)};var ri=function(b,a){var d,c,e,f,h=new XMLHttpRequest,l,n,r,t,p,v,q,x=null,y=!1;ph=wb;Zc=!1;Ua=Ea;I(!1);a&&ya(Cc);wb=u=0;ua=[];O=Sa=null;Sh=[];for(kg=null;zc.hasChildNodes();)zc.removeChild(zc.lastChild);Oe=0;Ad=mb=td=!1;va=Yc=gc=null;Ja=[];Fc=-1;ha=[];var w=!1;if(null==
sb||null!=Wd)sb=[];ia("new FOF="+b);gb&&(null!=hc&&(G(hc,!0,"extrap on"),z.style.cursor="default",I(Ua),Va=-1),gb=!1,aa());yb&&(null!=ad&&(G(ad,!0,"mark on"),z.style.cursor="default",I(Ua),xd=-1),yb=!1,aa());h.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)if(!(2>a[d].length)&&(l=a[d].trim(),ia("FOF: "+l),0!=l.indexOf("#")))if(0==l.indexOf("frame_labels"))p=l.split("="),db=p[1].split(",");else if(0==l.indexOf("redirect"))for(p=l.split("="),q=p[1].split(","),kg=q[0].trim(),
c=1;c<q.length;c++){var b=parseInt(q[c],10)-1;Sh[b]=!0}else if(0==l.indexOf("slice")){p=l.split("=");q=p[1].split(",");O=[];for(c=0;c<q.length;c++)O[c]=parseInt(q[c],10);O[2]=O[2]-O[0]+1;O[3]=O[3]-O[1]+1;4<O.length&&(O[6]=O[6]-O[4]+1,O[7]=O[7]-O[5]+1)}else if(0==l.indexOf("fof_extension"))p=l.split("="),x=p[1].trim();else if(0==l.indexOf("probe_table"))p=l.split("="),Rc=!1,N(p[1].trim());else if(0==l.indexOf("image_base"))p=l.split("="),fa=p[1].trim();else if(0==l.indexOf("overlay_base"))p=l.split("="),
Zb=p[1].trim();else if(0==l.indexOf("high_res_basemap")){p=l.split("=");q=p[1].split(",");Yc=[];for(c=0;c<q.length;c++)Yc[c]=q[c].trim(),null!=fa&&(Yc[c]=fa+Yc[c]);Ad=!0}else if(0==l.indexOf("high_res_overlay"))for(p=l.split("="),v=p[1].split("&"),e=0;e<v.length;e++){q=v[e].split(",");Fc=parseInt(q[0].trim(),10)-1;Ja[Fc]=[];for(c=1;c<q.length;c++)Ja[Fc][c-1]=q[c].trim(),ci(Ja[Fc][c-1],"/")||(null!=Zb?Ja[Fc][c-1]=Zb+Ja[Fc][c-1]:null!=fa&&(Ja[Fc][c-1]=fa+Ja[Fc][c-1]));Ad=!0}else if(0==l.indexOf("high_res_zoom")){p=
l.split("=");q=p[1].split(",");na=[];for(c=0;c<q.length;c++)na[c]=parseFloat(q[c].trim());Ya()}else if(0==l.indexOf("hoverzone"))Gc(l);else if(0==l.indexOf("hotzone"))hd(l);else if(0==l.indexOf("hotspot"))y||(ob=null,nb=0,y=!0),Qb(l);else if(0==l.indexOf("toggle_onoff"))p=l.split("="),Ve=p[1].split(",");else if(0==l.indexOf("coordinates"))p=l.split("="),Bb(p[1]);else if(0==l.indexOf("map_scale"))p=l.split("="),q=p[1].split(","),Hc=parseFloat(q[0]),ue=1<q.length?parseFloat(q[1]):Hc;else if(0==l.indexOf("times")){p=
l.split("=");q=p[1].split(",");for(d=0;d<q.length;d++)sb[d]=parseInt(q[d].trim(),10);w=!0}else{null!=Wd&&(b=l.match(Wd),null!=b&&2==b.length?(sb.push(parseInt(b[1],10)),ia("+ + + Extrap time = "+b[1]),w=!0):ia("+ + + Cannot parse times using "+Wd+" from line: "+l));e=l.indexOf(" ");0>e&&(e=l.length);ua[u]=l.substring(0,e).trim();null!=fa&&(ua[u]=fa+ua[u]);l=l.substring(e+1);b=l.indexOf('"');0<=b&&(null==db&&(db=[]),e=l.substring(b+1),b=e.indexOf('"'),0<=b&&(db[u]=e.substring(0,b),0==u&&(Ka.innerHTML=
db[0])));ha[u]=[];b=l.indexOf("overlay");if(0<=b)for(n=l.substring(b),b=n.indexOf("="),0>b&&ia("Cannot find a = sign in "+n),r=n.substring(b+1),n=r.trim(),r=n.split(","),da=r.length,ia("numOverlays set to "+da),f=0;f<r.length;f++)ha[u][f]=r[f].trim(),null!=kg&&Sh[f]?ha[u][f]=(kg+ha[u][f]).trim():null!=Zb?ha[u][f]=(Zb+ha[u][f]).trim():null!=fa&&(ha[u][f]=(fa+ha[u][f]).trim());u+=1}w&&wa(sb);null!=x?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)2>
a[d].length||(t=a[d].trim(),ia("ext_FOF: "+t),0!=t.indexOf("#")&&(0==t.indexOf("hotzone")?hd(t):0==t.indexOf("hotspot")&&Qb(t)));Xa()},a.onerror=function(){Xa()},a.open("get",x+"?"+Math.round(1E5*Math.random()),!0),a.send()):Xa()};qi=b;h.open("get",b+"?"+Math.round(1E5*Math.random()),!0);h.send()};this.setWindowSize=function(b,a){if(null!=z){z.style.height=a+"px";z.style.width=b+"px";z.style.padding="0px";a=a-(null!=Mf?Mf.offsetHeight:0)-(null!=Nf?Nf.offsetHeight:0)-(null!=zb?zb.offsetHeight:0)-Xf*
(null!=Ob?Ob.offsetHeight:0);a>ja&&(a=ja);var d=a*oa/ja;d>b&&(d=b,a=b*ja/oa);a=Math.floor(a);d=Math.floor(d);qd||(Ed(d,a),aa())}};this.drag=function(b){yb||(X=ma.getX(),T=ma.getY(),Lb?(b=r.length-1,r[b].xe=X,r[b].ye=T,r[b].xp.push(X),r[b].yp.push(T),r[b].size=Math.round(Math.sqrt(Math.pow(X-r[b].x,2)+Math.pow(T-r[b].y,2)))):(y=X*A,p=T*E,$c=Hb=!1,sc&&(!ve||ve&&b.shiftKey)?(oe=y,pe=p,$c=!0):(za&&C!=We?(R=ra-y/B,S=sa-p/C,Gd(),ra=Math.round(R+y/B),sa=Math.round(S+p/C)):yb||gb||!mb||(qa=null,jd&&0<=y&&
0<=p&&(U=$d.getImageData(y,p,1,1).data,0!=U[3]&&(qa=Sa[U[3]-1]))),ff=!0,Z())),aa())};this.resetZoom=function(){B=Pe;C=We;W=-1;null!=Aa&&(G(Aa,!0,"zoom on"),za=!1);ra=y;sa=p;S=R=0;bb=ja;cb=oa;Ya();Z();td&&(mb=!0)};this.canTip=function(){var b;Hb=!1;X=ma.getX();y=X*A;T=ma.getY();p=T*E;if(!((yb||gb)&&p<Kh&&p>Jh&&y>Ih)){ra=Math.round(R+y/B);sa=Math.round(S+p/C);if(0!=wb)for(b=0;b<wb;b++)if(Ha[b].overlay>=da)ia(" Error...hotzone overlay # "+Ha[b].overlay+" > number of overlays = "+da);else if(F[Ha[b].overlay].checked&&
(Wa.clearRect(0,0,1,1),Wa.drawImage(K[q][Ha[b].overlay],ra,sa,1,1,0,0,1,1),U=Wa.getImageData(0,0,1,1).data,mg=(U[0]<<16)+(U[1]<<8)+U[2],mg==Ha[b].color)){Hb=!0;Lh=X;Mh=T;Nh=Ha[b].tip;break}if(0!=nb)for(b=nb-1;0<=b;b--)if(null!=ob[b]){var a=ob[b];if(-1==a.frame||a.frame==q)if(-1==a.overlay||F[a.overlay].checked){var d=!1;if(a.isPan)if(a.isIcon){var c=(a.x0-R)*B-a.w2;var e=(a.y0-S)*C-a.h2;y>c&&y<c+a.width&&p>e&&p<e+a.height&&(d=!0)}else c=(a.x0-R)*B,e=(a.y0-S)*C,y>c&&y<c+a.width*B&&p>e&&p<e+a.height*
C&&(d=!0);else y>a.x0&&y<a.x1&&p>a.y0&&p<a.y1&&(d=!0);if(d&&null!=a.tip){Hb=!0;Lh=X;Mh=T;Nh=ob[b].tip;break}}}aa()}};this.move=function(){if(!gb&&mb&&(qa=null,jd)){var b=ma.getX()*A,a=ma.getY()*E;0<=b&&0<=a&&(U=$d.getImageData(b,a,1,1).data,0!=U[3]&&(qa=Sa[U[3]-1]))}gb&&2<=Va&&(X=ma.getX(),y=X*A,T=ma.getY(),p=T*E);aa()};this.down=function(){Hb&&(Hb=!1,aa());X=ma.getX();y=X*A;T=ma.getY();p=T*E;bf=y;cf=p;oe=bf;pe=cf;ra=Math.round(R+y/B);sa=Math.round(S+p/C);ff=!1;if(Lb){var b={};b.x=X;b.y=T;b.xe=X;
b.ye=T;b.xp=[X];b.yp=[T];b.type=je.value;b.color=ie.value;b.width=Ec.value;b.text=Mb.value;b.size=0;r.push(b)}};this.up=function(b){Hb=!1;if(!Lb){if(gb||yb){X=ma.getX();y=X*A;T=ma.getY();p=T*E;if(yb){xd=1;if(0<xd&&p/E<ni){if(y/A>mi){pa.pop();pa.pop();0==pa.length&&(xd=0);aa();return}if(y/A<li){aa();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var a=[],d=0;d<pa.length;d+=2)ra=R+pa[d]/B,sa=S+pa[d+1]/C,Rb(),b.document.write(eb[0].toFixed(4)+","+eb[1].toFixed(4)+"<br>"),
0==d&&(a[0]=eb[0],a[1]=eb[1]);Fe&&b.document.write(a[0].toFixed(4)+","+a[1].toFixed(4)+"<br>");return}}pa.push(y);pa.push(p);aa();return}if(3>Va)if(Pb[Va]=y,Ab[Va]=p,Bd[Va]=Hf[q],0==Va)Va=1,ya(xa(u-1)),Xe=1,md=null;else{Th=Bd[1]-Bd[0];af=(Pb[1]-Pb[0])/Th;ne=(Ab[1]-Ab[0])/Th;if(null!=xf&&null!=Hc){d=af*Hc;var c=ne*ue;a=Math.round(60*Math.sqrt(d*d+c*c));d=Math.atan2(d,-c)/.0174533;0>d&&(d+=360);md=Mg+wi[Math.round(d/22.5)]+" at "+a+" "+Ng;ji=Pb[0];ki=0<ne?Ab[0]-15:Ab[0]+30}a=parseInt(Qd,10);Y=Math.round(Math.abs(4*
(a+4)/af));Cd=Math.round(Math.abs(2*(a+4)/ne));Cd<Y&&(Y=Cd);120<Y?Y=120*Math.floor(Y/120)+60:90<Y?Y=120:60<Y?Y=90:30<Y?Y=60:15<Y?Y=30:10<Y?Y=15:5<Y?Y=10:2<Y?Y=5:0==Y&&(Y=1);Cd=Bd[1]/Y*Y+Y;me=1;Lg&&(me=-1);Hh=af*Y;gg=ne*Y;ya(xa(u-1));Va=3;Xe=2}else if(p/E<Kh&&p/E>Jh&&y/A>Ih&&3==Va){Tb();aa();return}aa()}if($c)$c=!1,aa();else if(null!=ic&&za&&(sc=!1,G(ic,!0,"distance on")),ff)ff=!1;else if(b.altKey)H.resetZoom();else if(mb&&null!=qa&&fg)Sb(qa,"z");else{X=ma.getX();y=X*A;T=ma.getY();p=T*E;if(0!=wb)for(a=
0;a<wb;a++)if(Ha[a].overlay>=da)ia(" Error...hotzone overlay # "+Ha[a].overlay+" > number of overlays = "+da);else if(F[Ha[a].overlay].checked&&(Wa.clearRect(0,0,1,1),Wa.drawImage(K[q][Ha[a].overlay],Math.floor(ra),Math.floor(sa),1,1,0,0,1,1),U=Wa.getImageData(0,0,1,1).data,mg=(U[0]<<16)+(U[1]<<8)+U[2],mg==Ha[a].color)){Sb(Ha[a],"z");return}if(0!=nb)for(a=nb-1;0<=a;a--)if(null!=ob[a]){var e=ob[a];if(!(-1!=e.frame&&e.frame!=q||e.fromfile||-1!=e.overlay&&!F[e.overlay].checked)){var f=!1;e.isPan?e.isIcon?
(d=(e.x0-R)*B-e.w2,c=(e.y0-S)*C-e.h2,y>d&&y<d+e.width&&p>c&&p<c+e.height&&(f=!0)):(d=(e.x0-R)*B,c=(e.y0-S)*C,y>d&&y<d+e.width*B&&p>c&&p<c+e.height*C&&(f=!0)):y>e.x0&&y<e.x1&&p>e.y0&&p<e.y1&&(f=!0);if(f){Sb(ob[a],"s");return}}}za&&(mb=!1,Hd(b.ctrlKey||lg||b.which&&3==b.which||b.button&&2==b.button));Z();aa()}}};this.wheel=function(b){ch?Db(b):za&&(X=ma.getX(),y=X*A,T=ma.getY(),p=T*E,ra=Math.round(R+y/B),sa=Math.round(S+p/C),Hd(-1==b))};this.toggleAutoRefresh=function(){Md?(G(Qc,!1,"autorefresh off"),
null!=Ic&&clearInterval(Ic),Md=!1):(G(Qc,!0,"autorefresh on"),Ic=setInterval("HAniS.reloadFOF();",pf),Md=!0)};this.toggleLoopRock=function(){le?(G(ce,!0,"looprock rock"),le=!1):(G(ce,!1,"looprock loop"),le=!0)};this.toggleLoopHalt=function(){xb?(G(de,!0,"loophalt halt"),Ze=xb=!1):(G(de,!1,"loophalt loop"),Ze=xb=!0)};this.toggleExtrap=function(){gb?(null!=hc&&(G(hc,!0,"extrap on"),z.style.cursor=Fa.pop(),null!=Fb&&(Fb.disabled=!1),I(Ua),za=dh,Va=-1),gb=!1,aa()):(null!=hc&&(gb=!0,md=null,Fa.push(z.style.cursor),
z.style.cursor="crosshair",G(hc,!1,"extrap off"),Ua=Ea,null!=Fb&&(Fb.disabled=!0),Ea=!1,dh=za,za=!1,H.resetZoom(),Tb(),aa()),Z())};this.doEnhance=function(b){if(sd||Kc){var a=Ra[0].height,d=Ra[0].width;b=parseInt(Ca.value,10);0<=b?($f=Za[b],ag=$a[b],bg=ab[b],cg=Xd[b],uc[qb]=b):uc[qb]=null;var c=a*d*4;for(d=0;d<fc.length;d++)if(Ra[d].gotit){Ra[d].gotit=!1;var e=Ne[d].data;var f=Jf[d];if(0>b)for(a=0;a<c;a+=4)e[a]=f[a],e[a+1]=f[a+1],e[a+2]=f[a+2],e[a+3]=f[a+3];else for(a=0;a<c;a+=4)fb=f[a],fb===f[a+
1]&&fb===f[a+2]&&(e[a]=$f[fb],e[a+1]=ag[fb],e[a+2]=bg[fb],e[a+3]=cg[fb]);Xc[d].putImageData(Ne[d],0,0);Ra[d].gotit=!0}}};this.overClick=function(b){var a;if(b.target.checked)for(a=0;a<F.length;a++)b.target!=F[a]&&0!=b.target.name&&b.target.name==F[a].name&&(F[a].checked=!1);jd=!0;for(a=0;a<Yb.length;a++)b.target!=F[a]&&Na(a),null!=vc&&!vc[a]&&F[a].checked&&(jd=!1),null!=Ca&&a===qb&&(Ca.disabled=!F[a].checked);Z()};this.toggleIsLooping=function(){Ea?(Ea=!1,G(Fb,!0,"startstop start")):(Ea=!0,G(Fb,!1,
"startstop stop"),Ze=xb,xb=!1)};this.toggleZooming=function(){za?(H.resetZoom(),G(Aa,!0,"zoom on")):(G(Aa,!1,"zoom off"),za=!0,null!=ic&&(sc=!1,G(ic,!0,"distance on")),td&&(mb=!0),gb&&H.toggleExtrap())};this.togclick=function(b){var a=Dh.getX();Dh.getY();for(var d=Fh,c=0;c<Ta.length;c++){if(a>d&&a<d+zd){if(b.shiftKey){0<=Ta[c]&&(I(!1),ya(c));break}b=0;0<=Ta[c]&&(b=-1);ib(c,b);break}d=d+zd+Ue}};this.doneLoading=function(b){Me=b};this.dwellChanged=function(b){yd=b};this.getDwell=function(){return Ba};
this.frameChanged=function(b){Ye=b};this.getFrame=function(){return q};this.showFrame=function(b){ya(xa(b))}};
