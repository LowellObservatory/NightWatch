var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,da,aa){p!=Array.prototype&&p!=Object.prototype&&(p[da]=aa.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var p=0;return function(da){return $jscomp.SYMBOL_PREFIX+(da||"")+p++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.iterator;p||(p=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[p]&&$jscomp.defineProperty(Array.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(p){var da=0;return $jscomp.iteratorPrototype(function(){return da<p.length?{done:!1,value:p[da++]}:{done:!0}})};$jscomp.iteratorPrototype=function(p){$jscomp.initSymbolIterator();p={next:p};p[$jscomp.global.Symbol.iterator]=function(){return this};return p};
$jscomp.iteratorFromArray=function(p,da){$jscomp.initSymbolIterator();p instanceof String&&(p+="");var aa=0,Q={next:function(){if(aa<p.length){var Ab=aa++;return{value:da(Ab,p[Ab]),done:!1}}Q.next=function(){return{done:!0,value:void 0}};return Q.next()}};Q[Symbol.iterator]=function(){return Q};return Q};
$jscomp.polyfill=function(p,da,aa,Q){if(da){aa=$jscomp.global;p=p.split(".");for(Q=0;Q<p.length-1;Q++){var Ab=p[Q];Ab in aa||(aa[Ab]={});aa=aa[Ab]}p=p[p.length-1];Q=aa[p];da=da(Q);da!=Q&&null!=da&&$jscomp.defineProperty(aa,p,{configurable:!0,writable:!0,value:da})}};
$jscomp.polyfill("Array.prototype.fill",function(p){return p?p:function(p,aa,Q){var da=this.length||0;0>aa&&(aa=Math.max(0,da+aa));if(null==Q||Q>da)Q=da;Q=Number(Q);0>Q&&(Q=Math.max(0,da+Q));for(aa=Number(aa||0);aa<Q;aa++)this[aa]=p;return this}},"es6","es3");
function PEvs(p,da,aa,Q,Ab,kg,df){var wa,kc,Wa,Ad,ef,Bd,La,lc,ea,oe,Ma,Nb=0,Cc=0,cd,Na=!1,mc=!1,Bb=0,Xa=0,Ob=0,Pb=0,Cd,Dd,Dc=function(h){La=h.target;for(ea=lc=0;La;)lc+=La.offsetLeft-La.scrollLeft,ea+=La.offsetTop-La.scrollTop,La=La.offsetParent;Nb=(Na?Cd:h.pageX)-lc-document.body.scrollLeft;Cc=(Na?Dd:h.pageY)-ea-document.body.scrollTop};this.getX=function(){return Nb};this.getY=function(){return Cc};var G=function(h){h.preventDefault();h.stopImmediatePropagation?h.stopImmediatePropagation():h.stopPropagation()},
Ed=function(h){Dc(h);cd=Nb;ya=Cc;X=!0;null!=Y&&(Ad=(new Date).getTime());null!=xa&&xa(h)},I=function(h){X&&(Dc(h),X=!1,null!=Cb&&Cb(h),null!=Y&&(ef=(new Date).getTime(),Bd=ef-Ad,300>Bd&&Y(h)))},hb=function(h){Dc(h);3>Math.abs(Nb-cd)&&3>Math.abs(Cc-ya)||(ya=cd=-9999,X?null!=Oa&&Oa(h):null!=gb&&gb(h),null!=Fd&&pe())};this.touchDown=function(h){Wa=!0;if(1<h.targetTouches.length)return Na=!0,Ma&&(Xa=-1,G(h)),!1;wa=h.changedTouches;kc=wa[0];Ed(kc)};this.touchUp=function(h){0==h.targetTouches.length&&(Na=
Wa=!1);G(h);if(Na||mc)return Na||(mc=!1),!1;wa=h.changedTouches;kc=wa[0];I(kc)};this.touchMove=function(h){Wa=!0;G(h);if(Na)return Ma&&(wa=h.targetTouches,Cd=(wa[0].pageX+wa[1].pageX)/2,Dd=(wa[0].pageY+wa[1].pageY)/2,mc=!0,Ob=wa[0].pageX-wa[1].pageX,Pb=wa[0].pageY-wa[1].pageY,Bb=Ob*Ob+Pb*Pb,Ma&&0<Xa&&30<Math.abs(Bb-Xa)&&Ma(0<Bb-Xa?1:-1),Xa=Bb),!1;wa=h.changedTouches;kc=wa[0];hb(kc)};this.pointUp=function(h){G(h);for(var p=0;p<ta.length;p++)if(ta[p].pointerId==h.pointerId){ta.splice(p,1);break}0==
ta.length&&(Wa=Na=!1);if(Na||mc)return Na||(mc=!1),!1;I(h);return!1};this.pointDown=function(h){G(h);ta.push(h);Xa=-1;Wa=!0;1<ta.length?Na=!0:Ed(h);return!1};this.pointMove=function(h){G(h);for(var p=0;p<ta.length;p++)ta[p].pointerId==h.pointerId&&(ta[p]=h);if(Na||!mc){if(Na)return Cd=(ta[0].pageX+ta[1].pageX)/2,Dd=(ta[0].pageY+ta[1].pageY)/2,Ma&&(mc=!0,Ob=ta[0].pageX-ta[1].pageX,Pb=ta[0].pageY-ta[1].pageY,Bb=Ob*Ob+Pb*Pb,Ma&&0<Xa&&30<Math.abs(Bb-Xa)&&Ma(0<Bb-Xa?1:-1),Xa=Bb),!1;hb(h);return!1}};this.mouseDown=
function(h){Wa||(G(h),Ed(h))};this.clearDown=function(){X=!1};this.mouseUp=function(h){Wa||(G(h),I(h))};this.useWheel=function(h){p.addEventListener("wheel",this.mouseWheel,!0);Ma=h};this.mouseWheel=function(h){Dc(h);var p=Math.max(-1,Math.min(1,-h.deltaY||-h.detail));G(h);Ma&&Ma(p)};this.mouseClick=function(h){G(h);X=!1};this.mouseMove=function(h){Wa||(G(h),hb(h))};this.mouseDragged=function(h){Wa||(G(h),Dc(h),null!=Oa&&Oa(h),null!=Fd&&pe())};var pe=function(){clearTimeout(oe);oe=setTimeout(function(){Fd()},
600)};var ya=cd=Cc=Nb=0;var xa=da;var Cb=aa;var gb=Q;var Oa=Ab;var Y=kg;var Fd=df;var X=Wa=!1;var ta=[];p.addEventListener("mousedown",this.mouseDown,!1);p.addEventListener("mouseup",this.mouseUp,!1);p.addEventListener("mousemove",this.mouseMove,!1);p.addEventListener("click",this.mouseClick,!1);p.addEventListener("touchstart",this.touchDown,!1);p.addEventListener("touchend",this.touchUp,!1);p.addEventListener("touchmove",this.touchMove,!1);p.addEventListener("touchleave",this.touchUp,!1);p.addEventListener("touchcancel",
this.touchUp,!1);p.addEventListener("contextmenu",function(h){h.preventDefault()},!1);p.style["touch-action"]="none";p.addEventListener("mouseout",function(h){X||(Cc=Nb=-1,null!=gb&&gb(h));X=!1})};var HAniSF=function(){function p(b){var a,d;dd=!0;if(b instanceof Array)for(e={},null!=lg&&(b=b.concat(lg)),a=0;a<b.length;a++){if(!(2>b[a].length)){var c=b[a].trim();if(0!=c.indexOf("#")){var g=c.indexOf("=");if(!(1>g)){var k=c.substr(0,g).trim().toLowerCase();e[k]=c.substr(g+1).trim()}}}}else e=b;qe=!1;a=e.debug;null!=a&&("true"==a?(ff=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),qe=!0,ia("HAniS Version 4.28")):qe=!1);ib=!0;a=e.set_className;null!=a&&w(a,"f")&&(ib=!1);
ia("Is type of param an array = "+(b instanceof Array));a=e.divalign;null!=a&&(Gd=a.trim(),y.align=Gd);a=e.prevent_shortcuts;null!=a&&w(a,"t")&&(re=!0);a=e.initial_message;null!=a&&(b=e.initial_message_style,null==b&&(b="background-color:red;top:10px;left:10px;height:100px;width:200px"),b="z-index:99;position:absolute;"+b,nc=n("div"),nc.setAttribute("style",b),nc.innerHTML=a,nc.addEventListener("click",function(){nc.style.visibility="hidden"},!1),nc.style.visibility="visible",Pa.appendChild(nc),b=
e.initial_message_timeout,null!=b&&("auto"==b?gf=!0:(gf=!1,b=parseInt(e.initial_message_timeout,10),2>b&&(b=2),setTimeout(function(){nc.style.visibility="hidden"},1E3*b))));a=e.coordinates;null!=a&&Ab(a);c="green";g="white";k="12px Arial";var m=null,l=d=10,f=10;hf=2;mg="Lat = ";ng=" Lon = ";a=e.coordinates_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(mg=b[3],ng=b[4],hf=parseInt(b[5],10),6<b.length&&(m=b[6].trim(),d=parseInt(b[7],10),l=parseInt(b[8],
10),f=parseInt(b[9],10))));og=new gb(c,g,k,m,d,l,f);se=Ec=null;null!=e.map_scale&&(te=oc=!0,b=e.map_scale.split(","),Ec=parseFloat(b[0]),se=1<b.length?parseFloat(b[1]):Ec);pg=" ";a=e.distance_unit;null!=a&&(pg=a.trim());a=e.divcan_style;null!=a&&a.trim();jf="default";a=e.distance_cursor;null!=a&&(jf=a.trim());ue="default";a=e.location_cursor;null!=a&&(ue=a.trim());ve="default";a=e.probe_cursor;null!=a&&(ve=a.trim());kf="default";a=e.mark_cursor;null!=a&&(kf=a.trim());a=e.imagecan_style;null!=a&&(b=
a.trim()+";position:absolute;top:0;left:0;",ob.setAttribute("style",b+"z-index:1;"),pc.setAttribute("style",b+"z-index:6;"));c="blue";g="white";k="12px Arial";m=null;f=l=d=10;qg=1;rg="white";a=e.distance_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),rg=5<=b.length?b[4].trim():g,k=b[2].trim(),qg=parseInt(b[3],10),5<b.length&&(m=b[5].trim(),d=parseInt(b[6],10),l=parseInt(b[7],10),f=parseInt(b[8],10)));Rh=new gb(c,g,k,m,d,l,f);c="black";g="white";k="12px Arial";m=null;f=l=d=10;a=
e.probe_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Sh=new gb(c,g,k,m,d,l,f);sg="Undefined";tg=!1;Hd=0;a=e.probe_undefined;null!=a&&(b=a.split(","),sg=b[0].trim(),1<b.length&&(Hd=parseInt(b[1],10)+1),2<b.length&&(tg=!0));lf=!1;e.probe_base_image&&(lf=!0);a=e.active_probe;null!=a&&(Qb=!0);a=e.pause;null!=a&&(ug=parseInt(a,10));a=e.auto_refresh;null!=a&&(mf=6E4*parseInt(a,10),
Fc=setInterval("HAniS.reloadFOF();",mf),Id=!0);Jd=!1;a=e.enable_smoothing;null!=a&&w(a,"t")&&(Jd=!0);we=!0;a=e.check_image_size;null!=a&&w(a,"f")&&(we=!1);vg=!1;a=e.sprites;if(null!=a){b=a.split(",");nf=new Image;of=[];pf=[];Rb=[];Sb=[];if("row"==b[1].trim().toLowerCase())for(l=g=c=0,a=2;a<b.length;)for("row"==b[a].trim().toLowerCase()&&(c=0,g+=l,l=0,a+=1),d=parseInt(b[a],10),a+=1,k=parseInt(b[a],10),a+=1,m=parseInt(b[a],10),m>l&&(l=m),a+=1,f=0;f<d;f++)of.push(c),pf.push(g),Rb.push(k),Sb.push(m),
c+=k;else for(g=!1,a=1;a<b.length;)of.push(parseInt(b[a],10)),a+=1,pf.push(parseInt(b[a],10)),a+=1,a>=b.length?(c=0,g=!0):c=parseInt(b[a],10),0>c?(g=!0,Rb.push(Math.abs(c)),a+=1,c=parseInt(b[a++],10),Sb.push(Math.abs(c))):g?(Rb.push(Rb[Rb.length-1]),Sb.push(Sb[Sb.length-1])):(Rb.push(parseInt(b[a],10)),a+=1,Sb.push(parseInt(b[a],10)),a+=1);nf.onload=function(){vg=!0};nf.src=b[0]}a=e.overlay_labels;null!=a&&(Tb=a.split(","));qf=null;a=e.auto_enhance_background;null!=a&&(qf=parseInt(a,10)-1);Gc=null;
a=e.auto_enhance;if(null!=a)for(c=e.overlay_probe_table,b=a.split(","),Gc=Array(b.length),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?Gc[a]=-1:Gc[a]=parseInt(b[a].trim(),10)-1,null==c&&(qc[a]=Gc[a]);Hc=!1;pb=-1;a=e.overlay_enhance;null!=a&&(Hc=!0,pb=parseInt(a,10)-1);rc=null;ed=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(b=a.split(","),rc=Array(b.length),a=0;a<b.length;a++)if(rc[a]=!0,w(b[a],"n")||w(b[a],"f"))rc[a]=!1;T=Z=null;rf=wg=!1;a=e.window_size;null!=a&&(b=a.split(","),"div"==b[0]?
rf=!0:(T=parseInt(b[0],10),Z=parseInt(b[1],10)),wg=!0);Kd=[];a=e.use_for_all_frames;if(null!=a)for(b=a.split(","),a=0;a<b.length;a+=2)Kd[parseInt(b[a],10)]=parseInt(b[a+1],10)-1;Ld=-1;a=e.skip_missing;null!=a&&(Ld=parseInt(a,10));xg="#00000000";a=e.skip_missing_color;null!=a&&(xg=a);xe=null;a=e.overlay_spacer;if(null!=a)for(b=a.split(","),xe=Array(b.length),a=0;a<b.length;a++)xe[a]=parseInt(b[a],10);a=e.overlay_probe_table;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?
qc[a]=-1:qc[a]=parseInt(b[a],10)-1;sf=[];a=e.overlay_ontop;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)sf[parseInt(b[a],10)-1]=!0;Ic=null;a=e.overlay_order;null==a&&(a=e.overlay_zorder);if(null!=a)for(b=a.split(","),Ic=Array(b.length),a=0;a<b.length;a++)Ic[parseInt(b[a],10)-1]=a;Ub=null;a=e.overlay_links;if(null!=a)for(b=a.split(","),Ub=Array(b.length),a=0;a<b.length;a++)Ub[a]=parseInt(b[a],10);yg=[];J=null;a=e.overlay_slice;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)yg[parseInt(b[a],10)-
1]=!0;zg=!0;a=e.slice_smoothing;w(a,"f")&&(zg=!1);fd=null;a=e.overlay_clear;if(null!=a)for(b=a.split(","),fd=Array(b.length),a=0;a<b.length;a++)fd[a]=b[a].trim().toLowerCase();Ag=!1;a=e.transparency;null!=a&&(b=a.split(","),1==b.length?Bg=Cg=Dg=parseInt(b[0],10):(Bg=parseInt(b[0],10),Cg=parseInt(b[1],10),Dg=parseInt(b[2],10)),Ag=!0);tf=!1;a=e.transparency_list;if(null!=a){b=a.split(",");Eg=[];for(a=0;a<b.length;a++)Eg[parseInt(b[a].trim(),10)-1]=!0;tf=!0}ye=null;a=e.overlay_transparent_amount;if(null!=
a)for(b=a.split(","),ye=Array(b.length),a=0;a<b.length;a++)ye[a]=parseFloat(b[a])/100;Jc=null;a=e.overlay_zoom;if(null!=Tb&&null!=a)for(b=a.split(","),Jc=Array(b.length),a=0;a<b.length;a++)if(Jc[a]=1,w(b[a],"n")||w(b[a],"f"))Jc[a]=0;else if(w(b[a],"d")||w(b[a],"h"))Jc[a]=-1;qb=null;Fg=[];a=e.overlay_preserve_list;if(null!=Tb&&null!=a)for(b=a.split(","),qb=Array(b.length),a=0;a<b.length;a++){qb[a]=!0;if(w(b[a],"n")||w(b[a],"f"))qb[a]=!1;if(w(b[a],"a")||w(b[a],"A"))Fg[a]=!0}ba=null;if(null!=Tb&&null!=
qb)for(b=e.overlay_preserve.replace(/&/g,",&,").split(","),c=e.overlay_preserve_position,null!=c&&(c=c.split(",")),g=0,ba=Array(qb.length),a=k=0;a<qb.length;a++)if(qb[a]){ba[a]=[];m=0;do{ba[a][m]=[];for(d=0;4>d;d++)ba[a][m][d]=parseInt(b[k].trim(),10),k+=1;ba[a][m][2]=ba[a][m][2]-ba[a][m][0]+1;ba[a][m][3]=ba[a][m][3]-ba[a][m][1]+1;null!=c?(ba[a][m][4]=parseInt(c[g],10),ba[a][m][5]=parseInt(c[g+1],10),g+=2):(ba[a][m][4]=ba[a][m][0],ba[a][m][5]=ba[a][m][1]);k<b.length&&"&"==b[k].trim()?(k+=1,m+=1,d=
!0):d=!1}while(d)}ze=0;Gg=" ";sc="white";Md="transparent";Nd="14pt arial";Hg=!1;a=e.times_label_style;null!=a&&(b=a.split(","),sc=b[0].trim(),1<b.length&&(ze=Math.floor(60*parseFloat(b[1]))),1<b.length&&(ze="?"==b[1].trim()||"auto"==b[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(b[1]))),2<b.length&&(Gg=b[2].trim()),3<b.length&&(Md=b[3].trim()),4<b.length&&(Nd=b[4].trim()),5<b.length&&-1!=b[5].trim().indexOf("t")&&(Hg=!0));0==sc.indexOf("0x")&&(sc="#"+
sc.substring(2));0==Md.indexOf("0x")&&(Md="#"+Md.substring(2));gd=parseInt(Nd,10);Th=new gb("black","white",Nd,"black",20,5,5);Ig=!1;a=e.to_from_lock;null!=a&&(Ig=w(a,"t")?!0:!1);a="black";d="white";l="14px arial";c=null;m=k=g=10;Jg=Kg=" ";uf=hd=null;a=e.dirspd_display_style;null!=a&&(b=a.split(","),a=b[0].trim(),d=b[1].trim(),l=b[2].trim(),Jg=b[3],Kg=b[4],5<b.length&&(c=b[5].trim(),g=parseInt(b[6],10),k=parseInt(b[7],10),m=parseInt(b[8],10)),uf=new gb(a,d,l,c,g,k,m));c="black";g="white";k="14px arial";
m=null;f=l=d=10;a=e.tipbox_display_style;null!=a&&(b=a.split(","),c=b[0].trim(),g=b[1].trim(),k=b[2].trim(),3<b.length&&(m=b[3].trim(),d=parseInt(b[4],10),l=parseInt(b[5],10),f=parseInt(b[6],10)));Lg=new gb(c,g,k,m,d,l,f);id=null;fa=e.image_base;null!=fa?id=fa=fa.trim():fa=null!=e.image_only_base?e.image_only_base.trim():null;Mg=fa;a=e.overlay_base;null!=a&&(Vb=a.trim());Ae=!0;a=e.zip_only;null!=a&&w(a,"f")&&(Ae=!1);Kc=!1;a=e.zip_filename;null!=a&&(Kc=!0,vf=a.trim());dd=!0;a=e.filenames;null==a&&
(a=e.background_filenames);null!=a&&Uh(a);a=e.basename;null!=a&&(c=e.base_starting_number,g=0,k=1,null!=c&&(b=c.split(","),g=parseInt(b[0],10),1<b.length&&(k=parseInt(b[1],10))),v=e.num_frames,null==v&&(v=e.num_images),v=parseInt(v,10),Vh(a,g,k));wf=!0;b=e.zip_static;null!=b&&(w(b,"f")||w(b,"n"))&&(wf=!1);xf=!0;b=e.background_static;null!=b&&(w(b,"f")||w(b,"n"))&&(xf=!1);a=e.overlay_filenames;null!=a&&Wh(a);Fa=null;a=e.image_preserve;if(null!=a)for(b=a.split(","),Fa=[],a=0;a<b.length;a++)Fa[a]=parseInt(b[a].trim(),
10),1<a%4&&(Fa[a]=Fa[a]-Fa[a-2]+1);Ng=!0;a=e.keep_zoom;null!=a&&w(a,"f")&&(Ng=!1);Od=Og=0;Pg=!1;a=e.hide_bottom;null!=a&&(b=a.split(","),Og=parseInt(b[0].trim(),10),1<b.length&&w(b[1],"t")&&(Pg=!0));Pd=Qg=0;Rg=!1;a=e.hide_top;null!=a&&(b=a.split(","),Qg=parseInt(b[0].trim(),10),1<b.length&&w(b[1],"t")&&(Rg=!0));Qd=Sg=0;Tg=!1;a=e.hide_left;null!=a&&(b=a.split(","),Sg=parseInt(b[0].trim(),10),1<b.length&&w(b[1],"t")&&(Tg=!0));Rd=Ug=0;Vg=!1;a=e.hide_right;null!=a&&(b=a.split(","),Ug=parseInt(b[0].trim(),
10),1<b.length&&w(b[1],"t")&&(Vg=!0));Wg=!1;a=e.hide_background;null!=a&&w(a,"t")&&(Wg=!0);Xg="<div>";Yg=300;Zg=500;a=e.popup_style;null!=a&&(Xg='<div style="'+a+'">');a=e.popup_window_size;null!=a&&(b=a.split(","),Zg=b[0],Yg=b[1]);$g=!1;a=e.wheel_frames;null!=a&&($g=!0,ma.useWheel(L.wheel));ah=za=!1;a=e.active_zoom;null!=a&&w(a,"t")&&(null==Aa&&(za=!0),ma.useWheel(L.wheel));yf=!1;a=e.cycle_zoom;null!=a&&w(a,"t")&&(yf=!0);a=e.initial_zoom;null!=a&&(b=a.split(","),tc="auto"!=b[0].toLowerCase()?parseFloat(b[0]):
"auto",1<b.length?(Sd=parseInt(b[1],10),bh=parseInt(b[2],10)):Sd=-1,ch=!0);jd=1;kd=!1;na=null;a=e.zoom_scale;if(null!=a)if(b=a.split(","),1===b.length)w(a,"hi_res")?(kd=!0,jd=0):jd=parseFloat(a);else{na=Array(b.length);for(a=0;a<b.length;a++)na[a]=parseFloat(b[a]);kd=!0}Lc=9999999;a=e.maximum_zoom;null!=a&&(Lc=parseFloat(a));Be=!0;a=e.use_progress_bar;null!=a&&w(a,"f")&&(Be=!1);a=e.dwell;null!=a&&(b=a.split(","),Ba=parseInt(b[0].trim(),10),1<b.length&&(Wb=parseInt(b[1].trim(),10),10>Wb&&(Wb=10),Mc=
parseInt(b[2].trim(),10),zf=parseInt(b[3].trim(),10)));a=e.rate;null!=a&&(b=a.split(","),Ba=Math.round(1E4/parseFloat(b[0].trim())),1<b.length&&(Wb=Math.round(1E4/parseFloat(b[2].trim())),10>Wb&&(Wb=10),Mc=Math.round(1E4/parseFloat(b[1].trim()))));a=e.frame_times_template;null!=a&&(b=a.split(","));rb=null;a=e.times;if(null!=a){b=a.split(",");rb=Array(b.length);for(a=0;a<b.length;a++)rb[a]=parseInt(b[a].trim(),10);wa(rb)}a=e.extrap_times_filename;if(null!=a){rb=[];var h=new XMLHttpRequest;h.open("get",
a,!0);h.onload=function(){for(var a=h.responseText.split("\n"),b=0;b<a.length;b++){var c=a[b].split(" ");if(3==c.length){c[2].trim();var d=parseInt(c[0],10)-1;rb[d]=100*parseInt(c[2].substring(0,2),10)+parseInt(c[2].substring(3,5),10)+parseInt(c[2].substring(6,8),10)/30}}wa(rb)};h.send()}Td=null;a=e.extrap_times_template;null!=a&&(Td=RegExp(a));dh=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];eh=10;a=e.extrap_prompts_position;
null!=a&&w(a,"bot")&&(eh=9999);a=e.extrap_prompts;null!=a&&(dh=a.split(","));Ce=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&(Ce=a.split(","));De=!0;a=e.mark_close;null!=a&&w(a,"f")&&(De=!1);Af="12pt Arial";fh="white";a=e.mark_prompts_style;null!=a&&(b=a.split(","),Af=b[0].trim(),1<b.length&&(fh=b[1].trim()));gh=e.controls;ia("controls = "+e.controls);ia("bottom_controls = "+e.bottom_controls);Nc=Ee=Xb=Yb=sb=tb=Db=null;null!=gh&&oe(gh,!0);hh=e.bottom_controls;
null!=hh&&oe(hh,!1);Oc=!1;a=e.probe_table;null!=a&&Q(a);b=e.enhance_filename;null==b&&(b=e.enhance_table);if(null!=b){ia("Reading enhancement table...");Oc=!1;h=new XMLHttpRequest;ub=[];Pc=[];Fe=[];Qc=[];Zb=[];var ih,jb,p;Ya=[];Za=[];$a=[];Ud=[];u=-1;jh=!0;var q=!1,r,z,t,M,F,B,C,A,G,I,kh,x,H;h.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var c=a[b].replace(/\s+/g," ").trim(),d=c.indexOf("#");if(0!=d)if(0<d&&(c=c.substring(0,d)),d=c.split(","),0==
d[0].indexOf("*"))u++,ub[u]=Array(256),Qc[u]=Array(256),Pc[u]=Array(256),Zb[u]=Array(256),Ya[u]=Array(256),Za[u]=Array(256),$a[u]=Array(256),Ud[u]=Array(256),ub[u]=Array(256),Fe[u]=1<d.length?d[1].trim():"None",ih=" ",jb="Value =",p=1,c=n("option"),c.innerHTML=d[0].substring(1),c.value=u,null!=Ca&&Ca.add(c);else{var g=c.indexOf("value");0>g&&(g=c.indexOf("probe"));q=!1;I=kh=0;0<g&&(d=c.substring(g+1),c=c.substring(0,g),g=d.indexOf("="),d=d.substring(g+1),d=d.split(","),1==d.length?(jb=d[0].trim(),
p=-1,q=!1):(I=parseFloat(d[0].trim()),kh=parseFloat(d[1].trim()),2<d.length&&(p=parseInt(d[2],10)),3<d.length&&(ih=Xh(d[3].trim())),4<d.length&&(jb=d[4].trim()),q=!0));c=c.split(" ");r=parseInt(c[0].trim(),10);z=parseInt(c[1].trim(),10);t=z-r;M=parseFloat(c[2].trim());F=parseFloat(c[3].trim());B=parseFloat(c[4].trim());C=parseFloat(c[5].trim());A=parseFloat(c[6].trim());G=parseFloat(c[7].trim());x=H=255;9<c.length&&(x=parseFloat(c[8].trim()),H=parseFloat(c[9].trim()));for(c=r;c<=z;c++)0===t?(Ya[u][r]=
M,Za[u][r]=B,$a[u][r]=A,Ud[u][r]=x):(Ya[u][c]=Math.round(M+(F-M)*(c-r)/t),Za[u][c]=Math.round(B+(C-B)*(c-r)/t),$a[u][c]=Math.round(A+(G-A)*(c-r)/t),Ud[u][c]=Math.round(x+(H-x)*(c-r)/t)),Qc[u][c]=jb,Pc[u][c]=ih,Zb[u][c]=p,q&&(ub[u][c]=I+(kh-I)*(c-r)/t)}}-1!=pb&&E[pb].checked&&(Ca.disabled=!1);Oc=!0;da()};h.open("get",b,!0);h.send()}else da()}function da(){var b=e.sprite_filenames;if(null!=b){var a=b.split(",");Bf=0;ka=[];b=e.sprite_images_offset;Rc=-1;null!=b&&(Rc=parseInt(b,10)-1);for(b=0;b<a.length;b++){ka[b]=
new Image;ka[b].gotit=!1;ka[b].inx=b;ka[b].fromfile=!0;var d="/";0<a[b].indexOf("?")&&(d="?");ka[b].zoomme=0<a[b].indexOf(d+"zoom");ka[b].anim=0<a[b].indexOf(d+"animate");d=a[b].indexOf(d);0<d&&(a[b]=a[b].substring(0,d));ka[b].onload=function(){ka[this.inx].gotit=!0;Bf++;Bf==a.length&&aa()};ka[b].src=a[b].trim()}}else aa()}function aa(){for(var b=Object.keys(e),a=0;a<b.length;a++)w(b[a],"hotspot")&&Nb("hotspot="+e[b[a]]);dd?L.getFOF():(uc=!0,La())}function Q(b){var a=new XMLHttpRequest;ub=[];Fe=[];
Pc=[];var d=" ";Qc=[];var c="Value=";Zb=[];var g=1;Sc=[];Cf=[];Ya=[];Za=[];$a=[];var e,m=-1;u=-1;var l=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var k=a[b].replace(/\s+/g," ").trim().split(","),f=k[0].split(" ");if(0==f[0].indexOf("*"))u++,ub[u]=[],Qc[u]=[],Pc[u]=[],Zb[u]=[],Ya[u]=[],Za[u]=[],$a[u]=[],Cf[u]=[],Sc[u]=[],m=-1,Fe[u]=1<k.length?k[1].trim():"None",l=1;else if(0!=l){m++;var h=Array(3);ub[u][m]=parseFloat(f[0]);Ya[u][m]=parseInt(f[1].trim(),
10);Za[u][m]=parseInt(f[2].trim(),10);$a[u][m]=parseInt(f[3].trim(),10);0!=m&&(h[0]=Ya[u][m]-Ya[u][m-1],h[1]=Za[u][m]-Za[u][m-1],h[2]=$a[u][m]-$a[u][m-1],e=0,Math.abs(h[1])>Math.abs(h[e])&&(e=1),Math.abs(h[2])>Math.abs(h[e])&&(e=2),Cf[u][m-1]=e,Sc[u][m-1]=h,0==Sc[u][m-1][e]&&(Sc[u][m-1][e]=1));1<k.length&&(0==k[1].trim().indexOf('"')?(g=-1,k=k[1].trim(),c=k.substr(1,k.length-2),d=""):(g=parseInt(k[1],10),2<k.length&&(d=Xh(k[2].trim())),3<k.length&&(c=k[3].trim())));Qc[u][m]=c;Zb[u][m]=g;Pc[u][m]=
d}}Oc=!0};a.open("get",b,!0);a.send()}function Ab(b){b=b.split(",");var a=b[0].trim();"PS"===a?($b=new pi,$b.init(b)):"CE"==a?($b=new qi,$b.init(b)):"LCC"==a?($b=new ri,$b.init(b)):($b=null,Df=parseFloat(b[0]),lh=parseFloat(b[1]),Yh=parseFloat(b[2]),Zh=parseFloat(b[3]))}function kg(b){var a=new XMLHttpRequest;a.onload=function(){p(this.responseText.split("\n"))};a.open("get",b+"?"+Math.round(1E5*Math.random()),!0);a.send()}function df(b){var a;if(null!=fd){for(a=0;a<fd.length;a++)-1!=fd[a].indexOf(b)&&
(E[a].checked=!1);for(a=0;a<fd.length;a++)Ma(a)}}function wa(b){Ef=Array(b.length);for(var a=0;a<b.length;a++){var d=60*Math.floor(b[a]/100)+Math.floor(b[a])%100;0===a&&(ac=d);var c=d-ac;0>c&&(c=d+1440-ac);Ef[a]=c;ia("times s="+d+"  min="+Ef[a])}ac+=ze;1440<=ac&&(ac-=1440);0>ac&&(ac+=1440);ia("Starting minute = "+ac)}function kc(b,a){if(0!=b)for(var d=0;d<b;d++)0==E[Ga[d].overlay].isGhost&&(E[Ga[d].overlay].parentNode.style.visibility=a)}function Wa(){0!=vb?kc(vb,"visible"):0!=mh&&kc(mh,"hidden");
uc=!0;La()}function Ad(b,a){ld||(ob.height=a,ob.width=b,pc.height=a,pc.width=b,Vd.height=a,Vd.width=b,Ge.height=a,Ge.width=b,Wd=Ge.getContext("2d"),T=b,Z=a,He=T/2-100,Ie=Z/2-10,B=1*oa/T,C=1*ja/Z,nh&&(nh=!1,null!=Xd&&Xd()),Pa.style.height=Z+"px",Pa.style.width=T+"px",vc.style.height=Z+"px",vc.style.width=T+"px",md.style.height=Z+"px",md.style.width=T+"px",pe(v,!1))}function ef(){for(var b=0,a={},d=0;d<v;a={ii:a.ii},d++){a.ii=d;var c=null==fa?ua[d]:ua[d].substring(ua[d].lastIndexOf("/")+1);(c=oh.file(c))?
c.async("arraybuffer").then(function(a){return function(c){c=new Blob([c]);wc[a.ii]=URL.createObjectURL(c);b++;b>=v&&Bd()}}(a),function(a){return function(){wc[a.ii]=null;b++;b>=v&&Bd()}}(a)):(wc[a.ii]=null,b++,b>=v&&Bd())}}function Bd(){var b=0;if(0==ca)lc();else for(var a=0;a<v;a++){xc[a]=[];for(var d={},c=0;c<ca;d={ii:d.ii,jj:d.jj},c++){d.ii=a;d.jj=c;var g=null==Vb&&null==fa?ha[a][c]:ha[a][c].substring(ha[a][c].lastIndexOf("/")+1);(g=oh.file(g))?g.async("arraybuffer").then(function(a){return function(c){c=
new Blob([c]);xc[a.ii][a.jj]=URL.createObjectURL(c);b++;b>=v*ca&&lc()}}(d),function(a){return function(){xc[a.ii][a.jj]=null;b++;b>=v*ca&&lc()}}(d)):(xc[a][c]=null,b++,b>=v*ca&&lc())}}}function La(){if(Kc){var b=new XMLHttpRequest,a=null==id?vf:id+vf;wf||(a=a+"?"+Math.round(1E5*Math.random()));b.open("GET",a,!0);b.responseType="arraybuffer";wc=[];xc=[];b.addEventListener("progress",function(a){a.lengthComputable&&ta("Loading ZIP file",a.total,a.loaded)});b.onload=function(a){(new JSZip).loadAsync(this.response).then(function(a){oh=
a;ef()},function(){ia("Unable to read ZIP file: "+vf)})};b.send()}else lc()}function lc(){var b,a,d;void 0!=Je&&Je(!1);var c="?"+Math.round(1E4*Math.random()),g=[];g[0]=yc;for(b=1;b<v;b++)g[b]=b<=yc?b-1:b;Ha=Array(v);Eb=Ia=0;ph=Be;Ff&&(kb.max=v);ld&&(nd||Hc)&&(bc=[],Qa=[],Tc=[],Gf=[],Ke=[]);null!=Ca&&(Ca.selectedIndex=0);for(var e=0;e<v;e++){b=g[e];ld&&(nd||Hc)&&(bc[b]=n("canvas"),Qa[b]=n("canvas"));Ha[b]=new Image;Ha[b].gotit=!1;Ha[b].frameNum=b;Ha[b].onerror=function(){Ia++};Ha[b].onload=function(){ld&&
(ja=this.height,oa=this.width,ab=ja,bb=oa,ld=!1,wg?rf?L.setWindowSize(y.offsetWidth,y.offsetHeight):Ad(T,Z):Ad(oa,ja),ch&&("auto"==tc&&(tc=(B+C)/2,Sd=-1),ab/=tc,bb/=tc,0>Sd&&(Sd=oa/2,bh=ja/2),O=Math.round(Sd-oa/2/tc),R=Math.round(bh-ja/2/tc),x=H=tc,1!=tc&&(za=!1,L.toggleZooming())));Kc&&null!=wc[this.frameNum]&&URL.revokeObjectURL(wc[this.frameNum]);if(0<Le&&!od){Hf.height=ja;Hf.width=oa;Yd=Hf.getContext("2d");Yd.clearRect(0,0,T,Z);for(var b=0;b<Ra.length;b++){for(var e=Ra[b].ctx.getImageData(0,0,
Ra[b].width,Ra[b].height).data,m=Yd.getImageData(Ra[b].xmin,Ra[b].ymin,Ra[b].width,Ra[b].height),k=3;k<e.length;k+=4)0!=e[k]&&(m.data[k]=b+1);Yd.putImageData(m,Ra[b].xmin,Ra[b].ymin)}za||(lb=!0);x==Me&&(lb=!0);od=!0}if(uc){uc=!1;K=ob.getContext("2d");K.imageSmoothingEnabled=Jd;K.fillStyle="blue";K.font="bold 20px Arial";f=pc.getContext("2d");f.imageSmoothingEnabled=Jd;Sa=Array(v);pe(v,!0);Ne&&!Ta?ya(xa(yc)):ya(xa(q));if(0<ca)for(D=Array(v),k=0;k<v;k++)for(d=g[k],D[d]=Array(ca),a=0;a<ca;a++)D[d][a]=
new Image,D[d][a].gotit=!1,D[d][a].frameNum=d,D[d][a].overlayNum=a,D[d][a].onerror=function(){Ia++},D[d][a].onload=function(){this.gotit=!0;var a=this.frameNum;Ia++;h();!we||this.height==ja&&this.width==oa?this.overlayNum==Ld-1&&(Sa[this.frameNum]=0):(this.gotit=!1,ia("Bad image size:"+this.src));if(Hc&&this.gotit&&this.overlayNum==pb)bc[a].height=this.height,bc[a].width=this.width,Zd=bc[a].getContext("2d"),Zd.drawImage(this,0,0),Gf[a]=Zd.getImageData(0,0,this.width,this.height).data,Qa[a].height=
this.height,Qa[a].width=this.width,Tc[a]=Qa[a].getContext("2d"),Tc[a].drawImage(this,0,0),Ke[a]=Tc[a].getImageData(0,0,this.width,this.height),D[a][this.overlayNum]=null,D[a][this.overlayNum]=Qa[a],D[a][this.overlayNum].gotit=!0;else if(this.gotit&&E[this.overlayNum].hotspotIndex){var b=n("canvas");b.height=this.height;b.width=this.width;var c=b.getContext("2d");c.drawImage(this,0,0);var d=c.getImageData(0,0,this.width,this.height).data,g=d.length;var e=this.overlayNum;var k;for(k=0;k<g;k+=4)if(0!=
d[k]){0==mb&&(nb=[]);var m=d[k];var l=Math.floor(k/4/b.width);c=Math.floor(k/4%b.width);nb[mb]=new Bb(c,l,"spritefn",m,"pan",null,null,e,a,null);mb++}}else if(this.gotit&&Ag&&(!tf||tf&&Eg[this.overlayNum])){b=n("canvas");b.height=this.height;b.width=this.width;c=b.getContext("2d");c.drawImage(this,0,0);l=c.getImageData(0,0,this.width,this.height);d=l.data;g=d.length;for(k=0;k<g;k+=4)d[k]===Bg&&d[k+1]===Cg&&d[k+2]===Dg&&(d[k+3]=0);c.putImageData(l,0,0);D[a][this.overlayNum]=null;D[a][this.overlayNum]=
b;D[a][this.overlayNum].gotit=!0}this.gotit&&sf[this.overlayNum]?(If.clearRect(0,0,T,Z),If.drawImage(D[a][this.overlayNum],0,0,T,Z)):this.gotit&&yg[this.overlayNum]&&null!=J&&(b=n("canvas"),b.height=ja,b.width=oa,8>J.length&&(J[4]=0,J[5]=0,J[6]=oa,J[7]=ja),c=b.getContext("2d"),c.imageSmoothingEnabled=zg,c.drawImage(this,J[0],J[1],J[2],J[3],J[4],J[5],J[6],J[7]),D[a][this.overlayNum]=null,D[a][this.overlayNum]=b,D[a][this.overlayNum].gotit=!0,null!=qb&&qb[this.overlayNum]&&(D[a][this.overlayNum].origImage=
this));Kc&&null!=xc[a][this.overlayNum]&&URL.revokeObjectURL(xc[a][this.overlayNum])},b=ha[d][a],void 0!=Kd[a+1]&&(b=Kd[a+1],b>=v&&(b=v-1),b=ha[b][a]),void 0==$d||$d[a]||(b+=c),D[d][a].src=b,D[d][a].src=Kc&&(Ae||xc[d][a])?xc[d][a]:b,Eb++;if(null!=Uc)for(cc=[],a=0;a<Uc.length;a++)cc[a]=new Image,cc[a].gotit=!1,cc[a].onerror=function(a){Ia++},cc[a].onload=function(a){a.currentTarget.gotit=!0;Ia++;h()},cc[a].src=Uc[a],Eb++;if(null!=Ja&&0<Ja.length)for(va=[],a=0;a<Ja.length;a++)if(void 0!=Ja[a])for(va[a]=
[],d=0;d<Ja[a].length;d++)for(va[a][d]=[],k=0;k<v;k++)$h(Ja[a][d],"/")?(b=ha[k][a].lastIndexOf("/"),b=ha[k][a].substring(0,b+1)+Ja[a][d]+ha[k][a].substring(b+1),va[a][d][k]=new Image,va[a][d][k].gotit=!1,va[a][d][k].onerror=function(a){Ia++;h()},va[a][d][k].onload=function(a){a.currentTarget.gotit=!0;Ia++;h()},va[a][d][k].src=b,Eb++):0===k?(va[a][d][0]=new Image,va[a][d][0].gotit=!1,va[a][d][0].onerror=function(a){Ia++;h()},va[a][d][0].onload=function(a){a.currentTarget.gotit=!0;Ia++;h()},va[a][d][0].src=
Ja[a][d],Eb++):va[a][d][k]=va[a][d][0]}!we&&0!=this.height&&0!=this.width||this.height==ja&&this.width==oa?(this.gotit=!0,0==Ld&&(Sa[this.frameNum]=0)):(this.gotit=!1,ia("Image has invalid size:"+this.src));nd&&this.gotit&&(k=this.frameNum,bc[k].height=this.height,bc[k].width=this.width,Zd=bc[k].getContext("2d"),Zd.drawImage(this,0,0),Gf[k]=Zd.getImageData(0,0,this.width,this.height).data,Qa[k].height=this.height,Qa[k].width=this.width,Tc[k]=Qa[k].getContext("2d"),Tc[k].drawImage(this,0,0),Ke[k]=
Tc[k].getImageData(0,0,this.width,this.height),Ha[k]=null,Ha[k]=Qa[k],Ha[k].gotit=!0);Ia++;h();Ng||L.resetZoom();Vc=!0;ai||(ai=!0,Da=!1,bi());G(Ta)};var m=ua[b];void 0!=Kd[0]&&(m=Kd[0],m>=v&&(m=v-1),m=ua[m]);xf||(m+=c);Ha[b].src=Kc&&(Ae||wc[b])?wc[b]:m;Eb++}Wc=Fb=!1;Y()}function ea(b,a,d,c,g,k){b.label_on=d;b.label_off=c;ib&&(b.className=k);d=null;c=e[a+"_labels"];null==c&&(c=e[a+"_label"]);null!=c&&(c=c.split(","),b.label_on=c[0].trim(),1<c.length&&(b.label_off=c[1].trim()),2<c.length&&(d="width:"+
c[2].trim()+"px;"));null!=g&&(b.title=g);b.innerHTML=b.label_on;g=a=c=e[a+"_style"];null!=c&&(c=c.split("&"),1<c.length&&(a=c[0],g=c[1]));b.style_on=(null!=d?d:"")+zc+a;b.style_off=(null!=d?d:"")+zc+g;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",b.style_on):(b.style_on=null,b.style_off=null)}function oe(b,a){zc=e.buttons_style;null==zc&&(zc="");var d=null,c=null;d=a?e.controls_tooltip:e.bottom_controls_tooltip;var g=b.split(",");if(null!=d){var k=d.split(",");k.length!=g.length&&(ia("!!! Number of tooltips must equal number of controls!"),
k=d=null)}for(b=0;b<g.length;b++){var m=null!=d?k[b]:null;var l=g[b].trim();c=l.indexOf("/");if(0===c||0===b){0===c&&(l=l.substring(1));t=n("div");t.align=Gd;var f=e.controls_style;null!=f?t.setAttribute("style",f):t.setAttribute("style","position:relative;padding:2px;width:100%;");a?(y.insertBefore(t,Pa),Jf=t):(f=e.bottom_controls_style,null!=f&&t.setAttribute("style",f),y.appendChild(t),Kf=t)}"enhance"==l.trim()&&(Ca=n("select"),c=e.enhance_style,null!=c&&Ca.setAttribute("style",c),null!=m&&(Ca.title=
m),c=n("option"),c.innerHTML="Pick Enhancement",c.value=-1,Ca.add(c),Ca.addEventListener("change",L.doEnhance,!1),nd=!Hc,Ca.disabled=nd?!1:!0,t.appendChild(Ca));"startstop"==l&&(Db=n("button"),ea(Db,"startstop","Start","Stop",m,"startstop start"),Db.addEventListener("click",L.toggleIsLooping,!1),t.appendChild(Db));"looprock"==l&&(ae=n("button"),ea(ae,"looprock","Rock","Loop",m,"looprock rock"),Lf=1,ae.addEventListener("click",L.toggleLoopRock,!1),t.appendChild(ae));"loophalt"==l&&(be=n("button"),
ea(be,"loophalt","Halt","Loop",m,"loophalt halt"),wb=!1,be.addEventListener("click",L.toggleLoopHalt,!1),t.appendChild(be));"extrap"==l&&(dc=n("button"),ea(dc,"extrap","Enable Extrap","Disable Extrap",m,"extrap"),dc.addEventListener("click",L.toggleExtrap,!1),t.appendChild(dc));w(l,"location")&&(pd=n("button"),ea(pd,"location","Show Loc","Hide Loc",m,"location"),0<l.indexOf("/on")?(I(pd,!1,"location off"),qd=!0,Ea.push(y.style.cursor),y.style.cursor=ue):(qd=!1,y.style.cursor=Ea.pop()),pd.addEventListener("click",
function(){(qd=!qd)?(I(pd,!1,"location off"),Ea.push(y.style.cursor),y.style.cursor=ue):(I(pd,!0,"location on"),y.style.cursor=Ea.pop());Y()},!1),t.appendChild(pd));"distance"==l&&(ec=n("button"),ea(ec,"distance","Show dist","Hide dist",m,"distance"),oc=te=!1,ec.addEventListener("click",function(){(oc=!oc)?(I(ec,!1,"distance off"),Ea.push(y.style.cursor),y.style.cursor=jf):(I(ec,!0,"distance on"),y.style.cursor=Ea.pop())},!1),t.appendChild(ec));w(l,"probe")&&(rd=n("button"),ea(rd,"probe","Show probe",
"Hide probe",m,"probe"),0<l.indexOf("/on")?(I(rd,!1,"probe off"),Qb=!0,Ea.push(y.style.cursor),y.style.cursor=ve):(Qb=!1,y.style.cursor=Ea.pop()),rd.addEventListener("click",function(){(Qb=!Qb)?(I(rd,!1,"probe off"),Ea.push(y.style.cursor),y.style.cursor=ve):(I(rd,!0,"probe on"),y.style.cursor=Ea.pop())},!1),t.appendChild(rd));"mark"==l&&(Xc=n("button"),ea(Xc,"mark","Mark","Stop Mark",m,"mark"),ce=!0,Xc.addEventListener("click",function(){xb=!xb;pa=[];xb?(sd=0,I(Xc,!1,"mark off"),null!=Aa&&(Aa.disabled=
!0),Ea.push(y.style.cursor),y.style.cursor=kf):(I(Xc,!0,"mark on"),null!=Aa&&(Aa.disabled=!1),sd=-1,y.style.cursor=Ea.pop());Y()},!1),ci=new gb("black","white",Af,"black",20,5,5),qh=new gb("black","white",Af,"black",20,5,5),t.appendChild(Xc));"refresh"==l&&(Ee=n("button"),ea(Ee,"refresh","Refresh",null,m,"refresh"),Ee.addEventListener("click",L.reloadFOF,!1),t.appendChild(Ee));"restore"==l&&(Mf=n("button"),ea(Mf,"restore","Restore",null,m,"restore"),Mf.addEventListener("click",function(a){for(a=0;a<
E.length;a++)E[a].checked=E[a].restorableState;for(a=0;a<E.length;a++)Ma(a)},!1),t.appendChild(Mf));"setframe"==l&&(kb=n("input"),ib&&(kb.className="setframe"),kb.type="range",kb.min=1,kb.max=100,kb.value=1,Oe="Frame #*",null!=m&&(kb.title=m),f=e.setframe_label,null!=f&&(Oe=f),de=n("span"),de.innerHTML=Oe.replace("*",1),c="display:block;vertical-align:middle;"+e.setframe_style,kb.setAttribute("style",c),c=n("span"),c.setAttribute("style","display:inline-block;vertical-align:top;"),de.setAttribute("style",
"display:block;vertical-align:middle;"+e.setframe_label_style),c.appendChild(de),c.appendChild(kb),t.appendChild(c),kb.addEventListener("input",function(a){G(!1);a=parseInt(kb.value,10)-1;0<=Sa[a]&&(ya(a),de.innerHTML=Oe.replace("*",q+1));X()},!1),Ff=!0);"framelabel"==l&&(Ka=n("button"),ib&&(Ka.className="framelabel"),Ka.innerHTML="",null!=m&&(Ka.title=m),cb=null,f=e.frame_labels,null!=f&&(cb=f.split(","),Ka.innerHTML=cb[0]),c=zc+e.framelabel_style,null!=c&&Ka.setAttribute("style",c),c=e.framelabel_position,
null!=c&&(c=c.split(","),Ka.style.position="absolute",Ka.style.left=y.offsetLeft+parseInt(c[0],10)+"px",Ka.style.top=y.offsetTop+parseInt(c[1],10)+"px"),t.appendChild(Ka));if("autorefresh"==l||"autorefresh/off"==l)null!=Fc&&clearInterval(Fc),Nc=n("button"),ea(Nc,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",m,"autorefresh"),Nc.addEventListener("click",L.toggleAutoRefresh,!1),Id=!1,t.appendChild(Nc),"autorefresh"==l?L.toggleAutoRefresh():I(Nc,!1,"autotoggle off");"backward"==l&&(sb=n("button"),
ea(sb,"backward","<","<",m,"step back"),sb.addEventListener("click",function(){G(!1);Cb(-1);X()},!1),t.appendChild(sb));"forward"==l&&(tb=n("button"),ea(tb,"forward",">",">",m,"step forward"),tb.addEventListener("click",function(){G(!1);Cb(1);X()},!1),t.appendChild(tb));if("step"==l){c=e.step_labels;var h=null!=c?c.split(","):["<",">"];sb=n("button");ib&&(sb.className="step back");sb.innerHTML=h[0];sb.addEventListener("click",function(){G(!1);Cb(-1);X()},!1);c=zc+e.step_style;null!=c&&sb.setAttribute("style",
c);null!=m&&(sb.title=m);t.appendChild(sb);tb=n("button");ib&&(tb.className="step forward");tb.innerHTML=h[1];tb.addEventListener("click",function(){G(!1);Cb(1);X()},!1);null!=c&&tb.setAttribute("style",c);null!=m&&(tb.title=m);t.appendChild(tb)}"first"==l&&(Gb=n("button"),ea(Gb,"first","|<","|<",m,"firstlast first"),Gb.addEventListener("click",function(){G(!1);ya(xa(0));X()},!1),t.appendChild(Gb));"last"==l&&(Hb=n("button"),ea(Hb,"last",">|",">|",m,"firstlast last"),Hb.addEventListener("click",function(){G(!1);
ya(xa(v-1));X()},!1),t.appendChild(Hb));"firstlast"==l&&(c=e.firstlast_labels,h=null!=c?c.split(","):["<<",">>"],Gb=n("button"),ib&&(Gb.className="firstlast"),Gb.innerHTML=h[0],Gb.addEventListener("click",function(){G(!1);ya(xa(0));X()},!1),c=zc+e.firstlast_style,null!=c&&Gb.setAttribute("style",c),null!=m&&(Gb.title=m),t.appendChild(Gb),Hb=n("button"),ib&&(Hb.className="firstlast"),Hb.innerHTML=h[1],Hb.addEventListener("click",function(){G(!1);ya(xa(v-1));X()},!1),null!=c&&Hb.setAttribute("style",
c),null!=m&&(Hb.title=m),t.appendChild(Hb));"setspeed"==l?(Ib=n("input"),ib&&(Ib.className="setspeed"),Ib.type="range",Ib.min=Wb,Ib.max=Mc,Ib.value=Mc-Ba,null!=m&&(Ib.title=m),c="vertical-align:middle;"+e.setspeed_style,Ib.setAttribute("style",c),Ib.addEventListener("input",function(a){Ba=Mc-parseInt(Ib.value,10)+30;void 0!=td&&td(Ba);G(!0);X()},!1),t.appendChild(Ib)):"speed"==l&&(c=e.speed_labels,h=null!=c?c.split(","):["-","+"],Xb=n("button"),ib&&(Xb.className="speed slower"),Xb.innerHTML=h[0],
Xb.addEventListener("click",function(){Ba+=zf;Yb.disabled=!1;Ba>Mc&&(Ba=Mc,Xb.disabled=!0);void 0!=td&&td(Ba)},!1),c=zc+e.speed_style,null!=c&&Xb.setAttribute("style",c),null!=m&&(Xb.title=m),t.appendChild(Xb),Yb=n("button"),ib&&(Yb.className="speed faster"),Yb.innerHTML=h[1],Yb.addEventListener("click",function(){Ba-=zf;Xb.disabled=!1;Ba<Wb&&(Ba=Wb,Yb.disabled=!0);void 0!=td&&td(Ba)},!1),null!=c&&Yb.setAttribute("style",c),null!=m&&(Yb.title=m),t.appendChild(Yb));"zoom"==l&&(Aa=n("button"),ea(Aa,
"zoom","Zoom","Un-zoom",m,"zoom off"),Aa.addEventListener("click",L.toggleZooming,!1),t.appendChild(Aa),za=!1);if("annotate"==l){ee=n("button");ea(ee,"annotate","Annotate","Finished",m,"annotate");la=n("div");la.setAttribute("style","position:absolute;box-sizing:content-box;height:120px;width:180px;top:20px;left:20px;z-index:15;visibility:hidden;background-color:lightgray;border-width:6px;border-style:solid;border-color:magenta;border-radius:25px;padding:10px;font:normal normal normal 16px Arial;color:black;");
la.title="Drag this box around.  Select attributes, then go onto the image and click & drag";Yc=Zc=20;Pe=Jb=!1;rh=3;sh=11;$c=fe=0;r=[];la.style["touch-action"]="none";var p=function(a){Zc=a.clientX-$c;Yc=a.clientY-fe;la.style.top=Yc+"px";la.style.left=Zc+"px"};la.addEventListener("mousedown",function(a){if(0!=a.clientX||0!=a.clientY)Pe=!0,$c=a.clientX-Zc,fe=a.clientY-Yc},!1);la.addEventListener("mouseup",function(a){Pe=!1},!1);la.addEventListener("mouseout",function(a){Pe&&p(a)},!1);la.addEventListener("mousemove",
function(a){Pe&&p(a)},!1);window.PointerEvent?(la.addEventListener("pointerdown",function(a){"mouse"!=a.pointerType&&($c=a.clientX-Zc,fe=a.clientY-Yc)},!1),la.addEventListener("pointermove",function(a){"mouse"!=a.pointerType&&(0==$c&&($c=a.clientX,fe=a.clientY),p(a))},!1)):la.addEventListener("touchmove",function(a){a=a.changedTouches[0];0==$c&&($c=a.clientX,fe=a.clientY);p(a)},!1);ee.addEventListener("click",function(){if(Jb=!Jb){r=[];Zc=y.offsetLeft;Yc=y.offsetTop;var a=e.annotate_position;null!=
a&&(a=a.split(","),Zc+=parseInt(a[0],10),Yc+=parseInt(a[1],10));la.style.top=Yc+"px";la.style.left=Zc+"px";la.style.visibility="visible";I(ee,!1,"annotate off");di=za;za=!1;null!=Aa&&(Aa.disabled=!0)}else la.style.visibility="hidden",I(ee,!0,"annotate on"),za=di,null!=Aa&&(Aa.disabled=!1);Y()},!0);ge=th("Color Black White Red Green Blue Yellow Orange Cyan Magenta".split(" "),"black black white red green blue yellow orange cyan magenta".split(" "),function(a){});Ac=th("Width 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),
[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==he.selectedIndex?sh=Ac.selectedIndex:rh=Ac.selectedIndex});Ac.title="Select width or font size";he=th("Type Arrow Circle Box Polygon Draw Text".split(" "),[-1,0,1,2,3,4,5],function(a){6==he.selectedIndex?(Kb.focus(),Kb.select(),Ac.selectedIndex=sh):Ac.selectedIndex=rh;0==ge.selectedIndex&&(ge.selectedIndex=2)});c=n("button");c.style.width="70px";c.style.margin="5px";c.innerHTML="Erase";c.title="Erase last item";c.addEventListener("click",
function(){0<r.length&&(r.pop(),Y())},!1);Kb=n("input");Kb.type="text";Kb.style.width="150px";Kb.style.margin="5px";Kb.title="Enter your text here, then click where you want it";Kb.value="Text input";h=e.annotate_defaults;null!=h&&(h=h.split(","),he.selectedIndex=parseInt(h[0],10),1<h.length&&(ge.selectedIndex=parseInt(h[1],10)),2<h.length&&(Ac.selectedIndex=parseInt(h[2],10)),3<h.length&&(Kb.value=h[3].trim()));h=n("div");h.innerHTML="Annotation Tools";var jb=n("div");jb.appendChild(he);jb.appendChild(ge);
var u=n("div");u.appendChild(Ac);u.appendChild(c);c=n("div");c.appendChild(Kb);la.appendChild(h);la.appendChild(jb);la.appendChild(u);la.appendChild(c);t.appendChild(ee);y.appendChild(la)}"saveall"==l&&(Nf=n("button"),ea(Nf,"saveall","SaveAll","SaveAll",m,"saveall"),uh=e.saveall_prompt,fc=e.saveall_filename,c=e.saveall_list,vh=null==c?["0"]:c.split(","),Nf.addEventListener("click",function(){for(var a=0;a<vh.length;a++)for(var b=parseInt(vh[a],10),c=0;c<ua.length;c++){0===c&&null!=uh&&(fc=window.prompt(uh,
fc),null!=fc&&1>fc.length&&(fc=null));var d=null==fc?"":-1!=fc.indexOf("#")?fc.replace("#",c.toString()):fc+c;var g=document.createElement("a");g.href=0==b?ua[c]:ha[c][b-1];g.download=d;d=new MouseEvent("click");g.dispatchEvent(d)}},!1),t.appendChild(Nf));if("capture"==l){Of=n("button");ea(Of,"capture","Capture","Capture",m,"capture");var B=e.capture_prompt;Pf=e.capture_filename;null==Pf&&(Pf="haimage.png");Of.addEventListener("click",function(){var a=Pf;if(null!=B&&(a=window.prompt(B,a),null==a))return;
var b=n("canvas");b.height=ob.height;b.width=ob.width;var c=b.getContext("2d");ce=!1;Y();c.drawImage(ob,0,0);c.drawImage(pc,0,0);ce=!0;b.toBlob(function(b){var c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;d.download=a;c=new MouseEvent("click");d.dispatchEvent(c);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);t.appendChild(Of)}"show"==l&&(Qf=n("button"),ea(Qf,"show","Show","Show",m,"show"),Rf=e.show_prompt,ei=e.show_image_file,null==Rf&&(Rf="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),
Qf.addEventListener("click",function(){if(ei)window.open(ua[q]);else{var a=ob.toDataURL("image/png;base64;");var b=window.open();b.document.write(Rf+"<img src="+a+"></img>")}},!1),t.appendChild(Qf));"toggle"==l&&(Sa=[],c=e.toggle_size,null!=c?(c=c.split(","),ud=parseInt(c[0],10),Qe=parseInt(c[1],10),Re=parseInt(c[2],10)):(Qe=ud=10,Re=3),wh="red",xh="blue",yh="orange",zh=!1,w(e.toggle_layout_width,"t")&&(zh=!0),c=e.toggle_colors,null!=c&&(c=c.split(","),xh=c[0].trim(),wh=c[1].trim(),yh=c[2].trim()),
yb=n("div"),yb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),yb.style.backgroundColor=t.style.backgroundColor,yb.align=Gd,Ah=new PEvs(yb,null,null,null,null,L.togclick,null),ad=n("canvas"),ad.height=2*Qe,Sf=ad.getContext("2d"),yb.appendChild(ad),a?y.insertBefore(yb,Pa):y.appendChild(yb),c=e.toggle_onoff,Se=null,null!=c&&(Se=c.split(",")),
Tf=!0,null!=m&&(yb.title=m));if("overlay"==l||"menu"==l){E=[];h=e.overlay_tooltip;c=null;null!=h&&(c=h.split(","));h=e.overlay_radio;jb=null;null!=h&&(jb=h.split(","));var A=e.overlay_labels_color;u=null;null!=A&&(u=A.split(","));A=!1;"menu"==l&&(A=!0);$d=[];var z=e.overlay_caching;l=null;null==z&&(z=e.overlay_static);null!=z&&(l=z.split(","));var F=!0;null!=e.overlay_nonewdiv&&(F=!1);for(z=0;z<Tb.length;z++){var M=Tb[z].trim();if(0==z||0==M.indexOf("/"))0==M.indexOf("/")&&(M=M.substr(1)),A?(vd=n("div"),
vd.setAttribute("style","text-align:left;display:block;visibility:hidden;position:absolute;border-style:solid;border-width:2px;background:#ffffff;z-index:999;"+e.overlay_labels_style),Uf++):F?(Lb=n("div"),Uf++,Lb.align="center",a?y.insertBefore(Lb,Pa):y.appendChild(Lb)):(Lb=n("span"),t.appendChild(Lb)),f=e.overlay_labels_style,A||null==f||Lb.setAttribute("style",f);var C=!1;f=M.length;0<M.indexOf("/on")&&M.indexOf("/on")==f-3&&(C=!0,M=M.substr(0,f-3));var x=!1;0<M.indexOf("/always")&&M.indexOf("/always")==
f-7&&(x=C=!0);var H=!1;0<M.indexOf("/hidden")&&(H=!0);var K=!1;0<M.indexOf("/hotspots")&&(K=!0,M=M.substr(0,M.indexOf("/")));null!=l?w(l[z],"y")||w(l[z],"t")?$d[z]=!0:$d[z]=!1:$d[z]=!0;E[z]=n("input");E[z].type="checkbox";E[z].value=M;E[z].id=M;E[z].showMe=!(x&H)&!K;var D="vertical-align:middle;";f=e.checkbox_style;null!=f&&(D+=f);E[z].setAttribute("style",D);E[z].checked=C;E[z].restorableState=C;E[z].name=0;E[z].hotspotIndex=K;null!=Ca&&z==pb&&E[z].checked&&(Ca.disabled=!1);null!=rc&&!rc[z]&&C&&
(ed=!1);E[z].addEventListener("click",L.overClick,!1);null!=h&&(f=jb[z].indexOf("/"),-1!=f&&(E[z].name=jb[z].substr(f+1).trim()),w(jb[z],"t")&&(E[z].type="radio",-1==f&&(E[z].name="all")));E[z].isGhost=!0;x||H||(null!=c&&(E[z].title=c[z]),x=n("label"),x.htmlFor=M,null!=c&&(x.title=c[z]),x.innerHTML=M,x.name=E[z].name,M="vertical-align:middle;",null!=u&&(M=M+"color:"+u[z]+";"),x.setAttribute("style",M),M=n("span"),f="10",null!=xe&&(f=10+xe[z]),M.appendChild(E[z]),M.appendChild(x),A?(M.setAttribute("style",
"display:block;margin-right:5px;"),vd.appendChild(M)):(M.setAttribute("style","margin-left:"+f+"px;"),Lb.appendChild(M)),E[z].isGhost=!1)}if(A){var J=n("button");ea(J,"menu","Show Overlay Menu","Hide Menu",m,"menu off");J.addEventListener("click",function(a){"hidden"===vd.style.visibility?(vd.style.visibility="visible",I(J,!1,"menu on")):(vd.style.visibility="hidden",I(J,!0,"menu off"))},!1);t.appendChild(J);y.insertBefore(vd,Pa)}if(null==Ub)for(Ub=Array(Tb.length),z=0;z<Tb.length;z++)Ub[z]=0;else for(z=
0;z<Tb.length;z++)Ma(z)}}Ta=!0;Ne=null;f=e.start_looping;null!=f&&(c=f.split(","),w(c[0],"f")&&(Ta=!1),1<c.length&&(yc=parseInt(c[1],10)-1,isNaN(yc)&&(yc=0),q=yc),2<c.length&&(w(c[2],"t")&&(Ne=!0),w(c[2],"f")&&(Ne=!1)));G(Ta)}function Ma(b){var a;if(0>Ub[b]){var d=!1;for(a=0;a<Tb.length;a++)Ub[a]!=-Ub[b]||d||(d=E[a].checked);E[b].checked=d}}function Nb(b){0==mb&&(nb=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var a=b[4].trim(),d=b[4].indexOf("/"),c=b[4].indexOf("?"),g=-1,k=-1;-1!=d&&(g=parseInt(b[4].substring(d+
1),10)-1,a=a.substring(0,d));-1!=c&&(k=parseInt(b[4].substring(c+1),10)-1,c<d||-1==d)&&(a=a.substring(0,c));nb[mb]=new Bb(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),a.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),g,k,8==b.length?b[7].trim():null);mb+=1}function Cc(b){0==Le&&(Ra=[],qa=null);var a=b.substr(b.indexOf("=")+1).trim().split("(");b=a[0].split(",");var d=b[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));Ra[Le]=new Na(d,b[1].trim(),b[2].trim(),b[3].trim(),
a[1].trim());Le+=1}function cd(b){0==vb&&(Ga=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");Ga[vb]=new mc(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");vb+=1}function Na(b,a,d,c,g){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=a;this.value=d;this.tip=c;this.poly=g;b=g.split(",");this.xy=[];this.ymin=
this.xmin=9999;for(a=this.ymax=this.xmax=0;a<b.length;a++)this.xy[a]=parseInt(b[a].trim(),10),0==a%2?(this.xy[a]<this.xmin&&(this.xmin=this.xy[a]),this.xy[a]>this.xmax&&(this.xmax=this.xy[a])):(this.xy[a]<this.ymin&&(this.ymin=this.xy[a]),this.xy[a]>this.ymax&&(this.ymax=this.xy[a]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=n("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=
this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(a=2;a<this.xy.length;a+=2)this.ctx.lineTo(this.xy[a]-this.xmin,this.xy[a+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function mc(b,a,d,c,g){this.overlay=b;this.color=a;this.action=d;this.value=c;this.tip=g}function Bb(b,a,d,c,g,k,e,f,h,p){this.x0=b;this.y0=a;this.icon=null;this.isIcon=!1;if("icon"==d)this.icon=new Image,this.icon.hotspot=this,Vf=!0,this.icon.onload=
function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.zoomme=this.fromfile=this.anim=!1,this.icon.gotit=!1,this.icon.src=c.trim();else if("sprite"==d||"spritefn"===d){this.x0=b;this.y0=a;this.inx=parseInt(c,10)-1;ie=!1;vg?null!=ka&&
(-1!=Rc?this.inx>=Rc&&this.inx<=Rc+ka.length&&(ie=!0):"spritefn"===d&&(ie=!0)):ie=!0;if(ie){-1!=Rc&&(this.inx-=Rc);if(this.inx>=ka.length)return null;this.x1=ka[this.inx].width+b;this.y1=ka[this.inx].height+a;this.width=ka[this.inx].width;this.height=ka[this.inx].height;this.w2=this.width/2;this.h2=this.height/2;this.origY=this.origX=0;this.icon=ka[this.inx].cloneNode();this.anim=ka[this.inx].anim;this.fromfile=ka[this.inx].fromfile;this.zoomme=ka[this.inx].zoomme;this.anim&&(this.icon.setAttribute("style",
"position:absolute;top:0px;left:0px;visibility:hidden;"),vc.appendChild(this.icon))}else this.x1=Rb[this.inx]+b,this.y1=Sb[this.inx]+a,this.width=Rb[this.inx],this.height=Sb[this.inx],this.w2=Rb[this.inx]/2,this.h2=Sb[this.inx]/2,this.origX=of[this.inx],this.origY=pf[this.inx],this.icon=nf,this.zoomme=this.fromfile=this.anim=!1;Vf=this.isIcon=!0;this.icon.gotit=!0}else this.width=parseInt(d,10),this.height=parseInt(c,10),this.x1=this.width+b,this.y1=this.height+a,this.w2=this.width/2,this.h2=this.height/
2;this.pan=g;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=k;this.value=e;this.overlay=f;this.frame=h;this.tip=p}function Xa(){if(wd&&!kd){U=-1;for(var b=0;b<na.length;b++)x>=na[b]&&(U=b)}}function Ob(){null!=$b?db=$b.toLatLon(ra,sa):null!=Df?(db[0]=Df+(Yh-Df)*sa/ja,db[1]=lh+(Zh-lh)*ra/oa):(db[0]=Math.round(ra),db[1]=Math.round(sa))}function Pb(b,a){"popup"==b.action?(null!=Wf&&Wf.close(),Wf=window.open("","HAniSPopup","scrollbars=yes,width="+Zg+",height="+Yg),Wf.document.write(Xg+b.value+
"</div>")):"link"==b.action?(b=b.value,Ob(),b=b.replace("%LATITUDE%",db[0].toFixed(4)),b=b.replace("%LONGITUDE%",db[1].toFixed(4)),b=b.replace("%FRAMENUMBER%",q+1),window.open(b,"_blank","")):"fof"==b.action&&(fa=Mg,L.resetZoom(),L.newFOF(b.value,!0),df(a))}function Cd(){var b=Tg?Qd/x:0;O+b<Qd&&(O=Qd-b);b=Vg?Rd/x:0;O+bb-b>oa-Rd&&(O=oa-bb+b-Rd);b=Rg?Pd/H:0;R+b<Pd&&(R=Pd-b);b=Pg?Od/H:0;R+ab-b>ja-Od&&(R=ja-ab-Od+b);R=Math.round(R);O=Math.round(O)}function Dd(b){var a=!1;b?kd?(U--,0>U?a=!0:(x=na[U],H=
na[U])):(x-=.1*jd/B,H-=.1*jd/C):kd?(U++,U>=na.length?(U--,yf&&(a=!0)):(x=na[U],H=na[U])):(!yf||x!==Lc&&H!==Lc||(a=!0),x+=.1*jd/B,H+=.1*jd/C,x>Lc&&(x=Lc),H>Lc&&(H=Lc));a||x<=Me||H<=Te?(x=Me,H=Te,U=-1,ra=A,sa=F,R=O=0,ab=ja,bb=oa,Qd=Rd=Pd=Od=0,od&&(lb=!0)):(Od=Og,Pd=Qg,Rd=Ug,Qd=Sg,O=ra-A/x,R=sa-F/H,ab=Math.floor(ja/H),bb=Math.floor(oa/x),Cd(),od&&(lb=!1));Xa()}function Dc(){Ue=0;Mb=Array(2);zb=Array(2);xd=Array(2);Ua=0;hd=null;ya(xa(0))}function G(b){Da=!b;L.toggleIsLooping()}function Ed(b,a,d,c,g,k){Wd.clearRect(0,
0,T,Z);Wd.imageSmoothingEnabled=Jd;K.imageSmoothingEnabled=Jd;Wd.drawImage(b,a,d,c,g,0,0,T,Z);Bh=Wd.getImageData(0,0,T,Z);bd=Bh.data;Xf=Ya[k];Yf=Za[k];Zf=$a[k];$f=Ud[k];fi=4*T*Z;for(gc=0;gc<fi;gc+=4)eb=bd[gc],eb===bd[gc+1]&&eb===bd[gc+2]&&(bd[gc]=Xf[eb],bd[gc+1]=Yf[eb],bd[gc+2]=Zf[eb],bd[gc+3]=$f[eb]);Wd.putImageData(Bh,0,0);K.drawImage(Ge,0,0,T,Z)}function I(b,a,d){null!=b&&(a?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&b.setAttribute("style",
b.style_off),b.innerHTML=b.label_off),ib&&(b.className=d))}function hb(b,a){if(!(b>=v)&&(-2==Sa[b]&&(a=-2),Sa[b]=a,Ff&&1==a&&(kb.value=b+1,de.innerHTML=Oe.replace("*",b+1)),Tf)){b=Ch+b*(ud+Re);var d=yh;0==a?d=xh:-1==a?d=wh:-2==a&&(d=xg);Sf.fillStyle=d;Sf.fillRect(b,Qe/2,ud,Qe)}}function pe(b,a){Tf&&(ad.width=zh?parseInt(y.style.width,10):T,Sf.clearRect(0,0,ad.width,ad.height),Ch=ad.width/2-b*(ud+Re)/2);for(var d=0;d<b;d++)a?-1!=Ld?hb(d,-2):null!=Se&&"n"==Se[d].toLowerCase().trim()?hb(d,-1):hb(d,0):
hb(d,Sa[d])}function ya(b){hb(q,0);q=b;hb(q,1);null!=Ka&&null!=cb&&null!=cb[q]&&(Ka.innerHTML=cb[q]);void 0!=Ve&&Ve(q)}function xa(b){b>=v&&(b=v-1);if(0<=Sa[b])return b;var a=-1,d=b;0==d&&(a=1);for(var c=0;c<v-1;c++)if(d+=a,0<=Sa[d])return d;return b}function Cb(b){hb(q,0);var a=b;do 0<a?(a=xa(v-1),q+=1,q>a&&(je&&Da?(q=a,b=-b,wb&&G(!1)):wb?(q=a,G(!1)):q=xa(0))):(a=xa(0),--q,q<a&&(je&&Da?(q=a,b=-b,wb&&G(!1)):wb?(q=a,G(!1)):q=xa(v-1))),a=b;while(0>Sa[q]);wb=We;void 0!=Ve&&Ve(q);Lf=a;hb(q,1);null!=Ka&&
null!=cb&&null!=cb[q]&&(Ka.innerHTML=cb[q])}function gb(b,a,d,c,g,k,e){this.bg=b;null!=b&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=a;null!=a&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=c;null!=c&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=g;this.sxoff=k;this.syoff=e}function Oa(b,a,d,c,g){f.globalAlpha=1;f.font=b.font;var k=b.fontHeight;d=d-
k-6;var e=f.measureText(c).width;1==g&&(a-=e);0==g&&(a-=e/2);5>a&&(a=5);5>d&&(d=5);d+k+3>Z&&(d=Z-k-6);a+3+e>T&&(a=T-e-6);f.save();f.beginPath();f.fillStyle=b.bg;null!=b.scolor&&(f.shadowColor=b.scolor,f.shadowBlur=b.sblur,f.shadowOffsetX=b.sxoff,f.shadowOffsetY=b.syoff);Xe=a-3;ag=d;Dh=e+6;bg=k+6;f.fillRect(Xe,ag,Dh,bg);f.closePath();f.restore();f.textBaseline="bottom";f.fillStyle=b.fg;f.fillText(c,a,d+k+3)}function Y(){f.clearRect(0,0,T,Z);cg=!1;if(fb){f.beginPath();f.lineWidth=2;f.strokeStyle="white";
var b=Ua;1<b&&(b=2);for(var a=0;a<b;a++)1<Ua&&(f.moveTo(Mb[0]/B,zb[0]/C),f.lineTo(Mb[1]/B,zb[1]/C)),f.moveTo(Mb[a]/B-15,zb[a]/C),f.lineTo(Mb[a]/B+15,zb[a]/C),f.moveTo(Mb[a]/B,zb[a]/C-15),f.lineTo(Mb[a]/B,zb[a]/C+15);f.closePath();f.stroke();if(3==Ua){var d=V,c=N;f.moveTo(d,c);f.fillStyle=sc;f.fillRect(d-2,c-2,5,5);b=yd;a=Math.round(d+Ye/B*ke*(yd-xd[1]));for(var g=Math.round(c+le/C*ke*(yd-xd[1])),e=0;300>e;e++){f.beginPath();f.lineWidth=1;f.strokeStyle=sc;f.moveTo(d,c);f.lineTo(a,g);f.stroke();f.beginPath();
f.lineWidth=3;f.rect(a-2,g-2,5,5);f.stroke();if(3>a||a+3>T||3>g||g+3>Z)break;c=ac+b;c=100*Math.floor(c/60)+c%60;c%=2400;Hg?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=0;Math.abs(dg)<gd+5&&(c=45*.0174533);var m=g;0>Eh*dg&&0==c&&(m=g+gd);f.font=Nd;d=d+" "+Gg;var l=f.measureText(d).width;f.fillStyle=Md;0===c?(f.fillRect(a+2,m-gd-2+c,l+4,gd+
3),f.fillStyle=sc,f.textBaseline="bottom",f.fillText(d,a+5,m)):(f.save(),f.translate(a+5,g),f.rotate(c),f.fillRect(2,-2,l+4,gd+3),f.fillStyle=sc,f.textBaseline="bottom",f.fillText(d,5,gd),f.restore());d=a;c=g;a=Math.round(d+ke*Eh);g=Math.round(c+ke*dg);b+=W}}null!=hd&&Oa(uf,gi,hi,hd,0);ce&&(Oa(Th,9999,eh,dh[Ue],0),Fh=Xe,Gh=ag,Hh=ag+bg)}if(xb){ce&&(0==sd?Oa(qh,9999,10,Ce[0],0):(Oa(ci,10,10,Ce[1],0),ii=Xe+Dh,Oa(qh,9999,10,Ce[2],0)),ji=Xe,ki=bg);f.beginPath();f.lineWidth=2;f.strokeStyle=fh;for(b=0;b<
pa.length;b+=2)0==b?f.moveTo(pa[b]/B,pa[b+1]/C):f.lineTo(pa[b]/B,pa[b+1]/C);De&4<pa.length&&f.lineTo(pa[0]/B,pa[1]/C);f.stroke();for(b=0;b<pa.length;b+=2)f.beginPath(),f.rect(pa[b]/B-2,pa[b+1]/C-2,5,5),f.stroke()}if(Jb)for(b=0;b<r.length;b++){a=r[b].type;f.beginPath();f.strokeStyle=r[b].color;f.lineWidth=r[b].width;if("0"==a)a=Math.atan2(r[b].xe-r[b].x,r[b].ye-r[b].y),g=r[b].x+r[b].width*Math.sin(a),e=r[b].y+r[b].width*Math.cos(a),f.beginPath(),f.moveTo(g,e),f.lineTo(r[b].xe,r[b].ye),d=12+r[b].width/
5,f.moveTo(g+d*Math.sin(a-.523599),e+d*Math.cos(a-.523599)),f.lineTo(g,e),f.lineTo(g+d*Math.sin(a+.523599),e+d*Math.cos(a+.523599));else if("1"==a)f.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==a)f.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);else if("3"==a){f.moveTo(r[b].xp[0],r[b].yp[0]);for(g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],r[b].yp[g]);f.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==a)for(f.moveTo(r[b].xp[0],r[b].yp[0]),g=1;g<r[b].xp.length;g++)f.lineTo(r[b].xp[g],
r[b].yp[g]);else"5"==a&&(f.fillStyle=r[b].color,f.font=r[b].width+"pt arial",a=f.measureText(r[b].text).width,f.fillText(r[b].text,r[b].x-a/2,r[b].y+r[b].width/2));f.stroke()}Wc&&(b=Ec*(Ze-me)/x,a=se*($e-ne)/H,b=" "+Math.sqrt(b*b+a*a).toFixed(qg)+" "+pg+" ",Oa(Rh,me/B,ne/C,b,-1),f.beginPath(),f.strokeStyle=rg,f.lineWidth=3,f.moveTo(Ze/B,$e/C),f.lineTo(me/B,ne/C),f.stroke(),f.closePath());Fb&&Oa(Lg,Ih,Jh,Kh,-1);if(Qb||qd)if(V=ma.getX(),A=V*B,N=ma.getY(),F=N*C,0<=A&&0<=F){ra=O+A/x;sa=R+F/H;if(qd){Ob();
li=mg+db[0].toFixed(hf)+"  "+ng+db[1].toFixed(hf);b=N;if(Wc||Fb)b=N+og.fontHeight+6;Oa(og,V+10,b,li,-1)}if(Qb&&Oc&&Vc)if(ra=Math.round(ra),sa=Math.round(sa),lf)Va.clearRect(0,0,1,1),Va.drawImage(Ha[q],ra,sa,1,1,0,0,1,1),S=Va.getImageData(0,0,1,1).data,P=0,Fd(!1);else for(b=0;b<ca;b++)if(a=ca-b-1,D[q][a].gotit&&E[a].checked&&(a==pb||null!=qc[a]&&0<=qc[a])){Va.clearRect(0,0,1,1);a==pb?Va.drawImage(bc[q],ra,sa,1,1,0,0,1,1):Va.drawImage(D[q][a],ra,sa,1,1,0,0,1,1);S=Va.getImageData(0,0,1,1).data;P=qc[a];
null!=P&&Fd(a==pb||jh);break}}!lb||fb||oc||Qb||null==qa||(f.drawImage(qa.can,0,0,qa.width,qa.height,qa.xmin/B,qa.ymin/C,qa.width/B,qa.height/C),Oa(Lg,(qa.xmin+qa.xmax)/2/B,(qa.ymin+qa.ymax)/2/C,qa.tip,0),cg=!0)}function Fd(b){af=999;hc=sg;var a=ub[P].length-1;if(0==S[3])hc=Fe[P];else{if(tg)ic=S[0];else if(b)eg=0,ic=S[0],af=0;else for(var d=0;d<a;d++)jc[0]=S[0]-Ya[P][d],0>jc[0]*(Ya[P][d+1]-S[0]-1)||(jc[1]=S[1]-Za[P][d],0>jc[1]*(Za[P][d+1]-S[1]-1)||(jc[2]=S[2]-$a[P][d],0>jc[2]*($a[P][d+1]-S[2]-1)||
(zd=Cf[P][d],fg=jc[zd]/Sc[P][d][zd],Lh=Math.abs(jc[Mh[zd]]-fg*Sc[P][d][Mh[zd]])+Math.abs(jc[Nh[zd]]-fg*Sc[P][d][Nh[zd]]),Lh<af&&(ic=d,af=Lh,eg=fg))));if(999>af)hc=Qc[P][ic],-1!=Zb[P][ic]&&(Oh=ub[P][ic],0!=eg&&(Oh+=eg*(ub[P][ic+1]-ub[P][ic])),hc=hc+" "+Oh.toFixed(Zb[P][ic])+" "+Pc[P][ic]);else if(b||0<Hd){var c=-1;if(b)c=S[0];else for(d=0;d<a;d++)if(Math.abs(S[0]-Ya[P][d])<Hd&&Math.abs(S[1]-Za[P][d])<Hd&&Math.abs(S[2]-$a[P][d])<Hd){c=d;break}-1!=c&&(hc=Qc[P][c],-1!=Zb[P][c]&&(hc=hc+" "+ub[P][c].toFixed(Zb[P][c])+
" "+Pc[P][c]))}}"hide"!=hc&&Oa(Sh,V-10,N,hc,1)}function X(){if(Vc)try{K.clearRect(0,0,T,Z);K.globalAlpha=1;if(!Wg)if(wd&&null!=cc&&0<=U&&cc[U].gotit)K.drawImage(cc[U],O*na[U],R*na[U],bb*na[U],ab*na[U],0,0,T,Z);else if(Ha[q].gotit&&(null!=qf?Ed(Ha[q],O,R,bb,ab,qf):K.drawImage(Ha[q],O,R,bb,ab,0,0,T,Z)),null!=Fa&&(K.globalAlpha=1,Ha[q].gotit))for(var b=0;b<Fa.length;b+=4)K.drawImage(Ha[q],Fa[b],Fa[b+1],Fa[b+2],Fa[b+3],Fa[b]/B,Fa[b+1]/C,Fa[b+2]/B,Fa[b+3]/C);if(0<ca){for(b=0;b<ca;b++){var a=null!=Ic?Ic[b]:
b;!sf[a]&&E[a].checked&&E[a].showMe&&(null!=ye&&(K.globalAlpha=ye[a]),wd&&0<=U&&null!=va&&void 0!=va[a]&&va[a][U][q].gotit?K.drawImage(va[a][U][q],O*na[U],R*na[U],bb*na[U],ab*na[U],0,0,T,Z):D[q][a].gotit&&(null==Jc||1===Jc[a]?null!=Gc&&0<=Gc[a]?Ed(D[q][a],O,R,bb,ab,Gc[a]):K.drawImage(D[q][a],O,R,bb,ab,0,0,T,Z):0===Jc[a]&&K.drawImage(D[q][a],0,0,oa,ja,0,0,T,Z)))}if(null!=qb)for(K.globalAlpha=1,b=0;b<ca;b++)if(a=null!=Ic?Ic[b]:b,D[q][a].gotit&&(Fg[a]||E[a].checked)&&qb[a])for(var d=0;d<ba[a].length;d++)K.drawImage(null!=
D[q][a].origImage?D[q][a].origImage:D[q][a],ba[a][d][0],ba[a][d][1],ba[a][d][2],ba[a][d][3],ba[a][d][4]/B,ba[a][d][5]/C,ba[a][d][2]/B,ba[a][d][3]/C);Qb&&Y()}ph&&h();if(Vf)for(K.globalAlpha=1,a=0;a<mb;a++)if(null!=nb[a]){var c=nb[a];null!=c.icon&&(c.icon.style.visibility="hidden");if((-1==c.frame||c.frame==q)&&null!=c.icon&&c.icon.gotit&&(-1==c.overlay||-1!=c.overlay&&E[c.overlay].checked)){if(c.isPan){c.zoomme&&(c.icon.style.width=Math.round(c.width*x)+"px",c.icon.style.height=Math.round(c.height*
H)+"px",c.w2=Math.round(c.width*x/2),c.h2=Math.round(c.height*H/2));var g=Math.round(((c.x0-O)*x-c.w2)/B);var e=Math.round(((c.y0-R)*H-c.h2)/C);if(c.anim){if(0>=g+c.icon.width||g>=oa||0>=e+c.icon.height||e>=ja)continue;c.icon.style.top=e+"px";c.icon.style.left=g+"px"}else K.drawImage(c.icon,c.origX,c.origY,c.width,c.height,g,e,c.width/B,c.height/C)}else K.drawImage(c.icon,c.origX,c.origY,c.width,c.height,c.x0/B,c.y0/C,c.width/B,c.height/C);c.icon.style.visibility="visible"}}}catch(m){ia("Error:"+
m)}}function ta(b,a,d){!Be||d>=a||(K.save(),K.fillStyle="blue",K.strokeStyle="white",K.lineWidth=3,K.strokeRect(He,Ie,200,18),K.fillRect(He,Ie,d/a*200,18),a=K.measureText(b).width,K.fillStyle="orange",K.font="14px arial",K.fillText(b,He+100-a/2,Ie+14),K.restore())}function h(){Be&&Eb>Ia?ta("Loading Images",Eb,Ia):(ph=!1,gf&&(nc.style.visibility="hidden"));Ia>=Eb&&!Da&&ya(xa(q));void 0!=Je&&Ia>=Eb&&Je(!0)}function ia(b){if(qe&&ff&&!ff.closed)try{ff.document.write(b+"<br>")}catch(a){}}function bi(){Da&&
Cb(Lf);mi=q==xa(v-1)?ug+Ba:Ba;X();setTimeout(function(){si(bi)},mi)}function bf(b){for(;-180>b;)b+=360;for(;180<b;)b-=360;return b}function qi(){var b,a,d,c,g,e,f,l,h=Math.PI/180;this.init=function(c){for(var d=[],k=1;k<c.length;k++)d[k]=parseFloat(c[k]);a=d[1];b=d[4]/d[5];g=d[6];e=d[7];c=this.toXY(d[2],d[3]);g=c[0];e=c[1]};this.toXY=function(k,f){d=b*bf(f-a)*h-g;c=-b*k*h-e;return[d,c]};this.toLatLon=function(c,d){f=-(d+e)/b/h;l=bf((c+g)/b/h+a);return[f,l]}}function pi(){var b,a,d,c,g,e,f,l,h,p,n,
r,v,u,q,z,A,M,y,x,t,C,B,E,F,w,G,H,I,J,K,D=Math.PI/180;this.init=function(c){for(var d=[],g=1;g<c.length;g++)d[g]=parseFloat(c[g]);b=d[1];a=d[2];x=0==d[8]?!1:!0;t=d[6];C=t*t;B=C*C;E=B*C;F=B*B;f=d[5]/d[7];K=d[7];x?(l=Math.cos(D*b),h=Math.sin(D*b)):(l=Math.cos(-b*D),h=Math.sin(-b*D));A=l/Math.sqrt(1-C*h*h);y=(1-t*h)/(1+t*h);z=x?Math.tan(Math.PI/4-b*D/2)/Math.pow(y,t/2):Math.tan(Math.PI/4- -b*D/2)/Math.pow(y,t/2);u=d[9];q=d[10];c=this.toXY(d[3],d[4]);u=c[0];q=c[1]};this.toXY=function(k,h){x?(g=D*k,e=
D*(h-a)):(g=D*-k,e=D*(a-h));y=(1-t*Math.sin(g))/(1+t*Math.sin(g));M=Math.tan(Math.PI/4-g/2)/Math.pow(y,t/2);w=90!=b&&-90!=b?f*A*M/z:2*f*K*M/Math.sqrt(Math.pow(1+t,1+t)*Math.pow(1-t,1-t));d=w*Math.sin(e);c=w*Math.cos(e);x||(d=-d,c=-c);p=d-u;n=c-q;return[p,n]};this.toLatLon=function(e,k){d=e+u;c=k+q;w=Math.sqrt(d*d+c*c);M=90==b||-90==b?w*Math.sqrt(Math.pow(1+t,1+t)*Math.pow(1-t,1-t))/(2*f*K):w*z/(f*A);G=Math.PI/2-2*Math.atan(M);H=Math.sin(2*G);I=Math.sin(4*G);J=Math.sin(6*G);g=G+H*C/2+5*H*B/24+H*E/
12+13*H*F/360+7*I*B/48+29*I*E/240+811*I*F/11520+7*J*E/120+81*J*F/1120+4279*Math.sin(8*G)*F/161280;x?(r=g/D,v=Math.atan2(d,c)/D+a):(r=-g/D,v=-Math.atan2(-d,-c)/D+a);return[r,bf(v)]}}function ri(){var b,a,d,c,g,e,f,h,p,n,r,t,v,u,q,z,y,x,A,C,B,F,E,w,D,G,H,I,J,K,L,P,Q,O,R,N=Math.PI/180;this.init=function(c){for(var g=[],e=1;e<c.length;e++)g[e]=parseFloat(c[e]);b=g[1];a=g[2];d=g[3];w=g[7];D=w*w;G=D*D;H=G*D;I=G*G;h=g[6]/g[8];p=Math.cos(N*b);n=Math.cos(N*a);t=Math.sin(b*N);r=Math.sin(a*N);B=p/Math.sqrt(1-
D*t*t);F=n/Math.sqrt(1-D*r*r);A=Math.sqrt((1-t)/(1+t)*Math.pow((1+w*t)/(1-w*t),w));C=Math.sqrt((1-r)/(1+r)*Math.pow((1+w*r)/(1-w*r),w));L=(Math.log(B)-Math.log(F))/(Math.log(A)-Math.log(C));P=B/(L*Math.pow(A,L));O=h*P*Math.pow(A,L);y=g[9];x=g[10];c=this.toXY(g[4],g[5]);y=c[0];x=c[1]};this.toXY=function(a,b){e=N*a;f=N*bf(b-d);R=Math.sin(e);E=Math.sqrt((1-R)/(1+R)*Math.pow((1+w*R)/(1-w*R),w));K=h*P*Math.pow(E,L);Q=L*f;c=K*Math.sin(Q);g=O+K*Math.cos(Q);v=c-y;u=g-x;return[v,u]};this.toLatLon=function(a,
b){c=a+y;g=b+x;K=Math.abs(L)/L*Math.sqrt(c*c+(O-g)*(O-g));E=Math.pow(K/(h*P),1/L);J=Math.PI/2-2*Math.atan(E);Q=0>L?Math.atan(-c/(g-O)):Math.atan(c/(O-g));f=Q/L;e=J+(D/2+5/24*G+H/12+13/360*I)*Math.sin(2*J)+(7/48*G+29/240*H+811/11520*I)*Math.sin(6*J)+(7/120*H+81/1120*I)*Math.sin(6*J)+4279/161280*I*Math.sin(8*J);q=e/N;z=bf(d-f/N);return[q,z]}}var L=this,wg,Z,T,ja,oa,B,C,gh,hh,Gb,Hb,nc,gf,ma,qe,Wf,ff,zc,gg,rf=!1,y,t,Jf,Kf,Pa,vc,md,ob,K,Va,pc,f,Vd,If,Kc,vf,Ae,oh,wf,wc,v,ua,$g,vd,ca,sf,Tb,Ic,ha,xc,Ub,id,
fa,Mg,Ha,D,E,ye,$d,Fb,Kh,Ih,Jh,fd,Kd,yg,J,zg,hg,Ph,V,N,A,F,ra,sa,bb,ab,O,R,ce,ib,yc,ai,Da,Ta,Ne,q,Ve,Lf,je,uc,ld=!0,we,ig,re,e,Ba,Wb,Mc,td,Je,zf,ug,mi,Jd,Ca,nd,Hc,pb,Qa,bc,Tc,Zd,Gf,Ke,qf,Ge,Wd,Bh,bd,eb,Xf,Yf,Zf,$f,fi,gc,Gc,Sa,ud,Qe,Re,zh,yb,Ch,Ah,wh,xh,yh,Ld,xg,nb,mb,Vf,xf,Bf,ka,Rc,ie,mh,vb,Ga,S,jg,Ra,Le,lb,od,Hf,Yd,qa,cg,rc,ed,na,U,cc,Uc,va,Ja,wd,cb,Ka,Bc,Tf,Se,ad,Sf,Vc,dd,Db,tb,sb,Ib,Yb,Xb,xe,Xc,xb,sd,Ce,Af,De,fh,pa,ci,qh,ji,ii,ki,dc,fb,Ua,Mb,zb,xd,Fh,dh,Gh,Hh,eh,Th,rb,ke,Ye,le,Qh,Td,Ef,Eh,dg,yd,
W,Ue,ac,ze,Gg,sc,Md,Nd,gd,Hg,Ig,ei,Qf,Rf,Of,Pf,ee,r,Nf,uh,fc,vh,la,Jb,$c,fe,Zc,Yc,Pe,di,he,ge,Ac,Kb,rh,sh,Aa,Ng,jd,x,H,Me,Te,ch,tc,Sd,bh,ah,za,Lc,kd,cf,yf,Ag=!1,Bg,Cg,Dg,tf,Eg,wb,We,ae,be,kb,Oe,de,Ff,ec,oc,Ze,$e,qg,te,Xe,ag,Dh,bg,nh=!0,Xd,lg,me,ne,Rh,rg,kf,Ea,jf,ue,Wc,Ec,se,pg,Lg,pd,qd,hf,mg,ng,og,$b,db,li,Df,lh,Yh,Zh,Fa,Lb,Uf,Jc,qb,ba,Fg,Mf,Ee,Nc,Xg,Zg,Yg,qc,Qb,rd,ve,Oc,Pc,Qc,Zb,zd,af,Sh,sg,Hd,tg,lf,uf,Jg,Kg,hd,gi,hi,ic,eg,fg,Mh,Nh,jc,P,Lh,hc,Oh,ub,u,Sc,jh,Ya,Za,$a,Ud,Cf,Fe,ni,Id,mf,Fc,Be,nf,of,
pf,Rb,Sb,vg,ph,He,Ie,Ia,Eb,Od,Wg,Og,Pd,Qg,Qd,Sg,Pg,Rg,Vg,Tg,Rd,Ug,Gd,Vb,ti="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),si=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},n=function(b){return document.createElement(b)},w=function(b,a){if(null!=b)return 0==b.trim().toLowerCase().indexOf(a)},$h=function(b,a){if(null!=b)return b=b.trim(),b.lastIndexOf(a)===b.length-1},
Xh=function(b){void 0==gg&&(gg=n("textarea"));gg.innerHTML=b;return gg.value},th=function(b,a,d){var c=n("select");c.style.width="70px";c.style.margin="5px";for(var g=0;g<b.length;g++){var e=n("option");e.innerHTML=b[g];e.value=a[g];c.add(e)}c.addEventListener("change",d,!1);return c},Wh=function(b){b=b.split(",");ha=Array(v);for(var a=0;a<b.length;a++){var d=b[a].split("&");ca=b.length;for(var c=0;c<v;c++)0===a&&(ha[c]=Array(ca)),ha[c][a]=d[1==d.length?0:c].trim(),null!=Vb?ha[c][a]=(Vb+ha[c][a]).trim():
null!=fa&&(ha[c][a]=(fa+ha[c][a]).trim())}dd=!1},Uh=function(b){b=b.split(",");v=b.length;ua=Array(v);for(var a=0;a<v;a++)ua[a]=null!=fa?fa+b[a].trim():b[a].trim();dd=!1;v>ca&&(ca=0)},Vh=function(b,a,d){var c=b;null!=fa&&(c=fa+b);ua=Array(v);for(var g=0;g<v;g++){b=g*d+a;if(0<=c.indexOf("*"))ua[g]=c.replace("*",b);else if(0<=c.indexOf("?")){for(var f=c;0<=f.lastIndexOf("?");){var h=f.lastIndexOf("?");f=f.substring(0,h)+b%10+f.substring(h+1);b=Math.floor(b/10)}ua[g]=f}else ua[g]=c+g;ia("image filename = "+
ua[g])}b=e.reverse_order;null!=b&&w(b,"t")&&ua.reverse();dd=!1;v>ca&&(ca=0)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(b,a,d){d=window.atob(this.toDataURL(a,d).split(",")[1]);for(var c=d.length,g=new Uint8Array(c),e=0;e<c;e++)g[e]=d.charCodeAt(e);b(new Blob([g],{type:a||"image/png"}))}});this.setup=function(b,a,d,c){void 0==a&&(a="MORdivcan");Xd=d;void 0!=Xd&&1>Xd.trim().length&&(Xd=null);lg=void 0!=c?c.split("\n"):null;y=document.getElementById(a);
Gd="center";y.align=Gd;Pa=n("div");Pa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");ob=n("canvas");ob.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");K=ob.getContext("2d");pc=n("canvas");pc.setAttribute("style","position:absolute;top:0;left:0;z-index:6;");f=pc.getContext("2d");f.imageSmoothingEnabled=!1;Vd=n("canvas");Vd.setAttribute("style",
"position:absolute;top:0;left:0;z-index:10;");If=Vd.getContext("2d");If.imageSmoothingEnabled=!1;vc=n("div");vc.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;border-width:0px;padding:0px;margin:0px;");md=n("div");md.setAttribute("style","position:absolute;top:0;left:0;z-index:10;overflow:hidden;border-width:0px;padding:0px;margin:0px;");md.appendChild(Vd);Ge=n("canvas");Pa.appendChild(md);Pa.appendChild(ob);Pa.appendChild(pc);Pa.appendChild(vc);y.appendChild(Pa);ma=
new PEvs(Pa,L.down,L.up,L.move,L.drag,null,L.canTip);y.setAttribute("tabindex",0);y.addEventListener("keyup",function(a){Jb||re||(ig=!1,a.preventDefault(),a.stopPropagation())},!1);y.addEventListener("keypress",function(a){Jb||re||(a.preventDefault(),a.stopPropagation())},!1);y.addEventListener("keydown",function(a){Jb||re||(a.preventDefault(),a.stopPropagation(),ig=a.ctrlKey?!0:!1,37==a.keyCode?(G(!1),Cb(-1),X()):39==a.keyCode?(G(!1),Cb(1),X()):32==a.keyCode?L.toggleIsLooping():82==a.keyCode&&a.altKey&&
L.resetZoom())},!1);md.addEventListener("mouseenter",function(a){y.focus()},!1);y.style.outlineWidth="0px";y.style.outline="none";y.focus();yc=q=0;je=!1;Lf=1;We=wb=!1;Ta=Da=!0;mb=ca=v=0;we=!0;Ic=null;uc=!0;Ba=500;Wb=100;Mc=2E3;zf=30;ug=0;mf=6E4;Fc=null;Kc=Id=!1;Ae=!0;wc=[];na=Mg=id=Vb=fa=null;wd=!1;U=-1;kd=!1;Te=Me=H=x=1;cf=!1;R=O=ab=bb=sa=ra=F=A=N=V=0;ch=!1;ld=nh=!0;Tf=gf=rf=!1;Ld=-1;Sa=[];vb=0;Vf=!1;ka=null;Rc=-1;Bf=0;ie=!1;Ka=null;Ie=He=Ia=Eb=0;jh=!1;P=0;Fb=wf=xf=Vc=!1;Ze=$e=me=ne=0;Wc=oc=!1;Ea=
[];Ea.push("default");Ea.push("default");jf="default";qd=!1;ue="default";$b=null;db=[0,0];lb=Ff=te=!1;ed=!0;qa=rc=null;xb=cg=!1;De=!0;kf="default";ce=!0;pa=[];Qb=lf=!1;ve="default";Oc=!1;Mh=[1,0,0];Nh=[2,2,1];jc=[];qc=[];Hc=nd=fb=!1;ze=Ue=0;Lb=Kf=Jf=t=yb=null;Uf=0;Jb=re=ig=!1;a=n("canvas");a.height=1;a.width=1;Va=a.getContext("2d");Va.imageSmoothingEnabled=!1;Hf=n("canvas");qe=!1;"string"===typeof b?0>b.indexOf("\n")?kg(b):p(b.split("\n")):p(b)};this.newBasenames=function(b,a,d,c){Vc=!1;Ta=Da;G(!1);
v=c;Vh(b,a,d);uc=!0;La()};this.newFilenames=function(b){Vc=!1;Ta=Da;G(!1);Uh(b);uc=!0;La()};this.newOverlayFilenames=function(b){Vc=!1;Ta=Da;G(!1);Wh(b);uc=!0;La()};this.newProbeTable=function(b){Oc=!1;Q(b.trim())};this.reloadFOF=function(){ia("reload FoF = "+Fc);df("r");dd?oi(ni,!1):(Ta=null==Ne?!0:Da,uc=!0,La())};this.getFOF=function(){var b=e.file_of_filenames.trim();L.newFOF(null!=id?id+b:b,!0)};this.newFOF=function(b,a){L.resetZoom();oi(b,a)};var oi=function(b,a){var d,c,e,f,h=new XMLHttpRequest,
l,p,r,t,n,u,q,w=null,z=!1;mh=vb;Vc=!1;Ta=Da;G(!1);a&&ya(yc);vb=v=0;ua=[];J=Ra=null;Ph=[];for(hg=null;vc.hasChildNodes();)vc.removeChild(vc.lastChild);Le=0;wd=lb=od=!1;va=Uc=cc=null;Ja=[];Bc=-1;ha=[];var x=!1;if(null==rb||null!=Td)rb=[];ia("new FOF="+b);fb&&(null!=dc&&(I(dc,!0,"extrap on"),y.style.cursor="default",G(Ta),Ua=-1),fb=!1,Y());xb&&(null!=Xc&&(I(Xc,!0,"mark on"),y.style.cursor="default",G(Ta),sd=-1),xb=!1,Y());h.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)if(!(2>
a[d].length)&&(l=a[d].trim(),ia("FOF: "+l),0!=l.indexOf("#")))if(0==l.indexOf("frame_labels"))n=l.split("="),cb=n[1].split(",");else if(0==l.indexOf("redirect"))for(n=l.split("="),q=n[1].split(","),hg=q[0].trim(),c=1;c<q.length;c++){var b=parseInt(q[c],10)-1;Ph[b]=!0}else if(0==l.indexOf("slice")){n=l.split("=");q=n[1].split(",");J=[];for(c=0;c<q.length;c++)J[c]=parseInt(q[c],10);J[2]=J[2]-J[0]+1;J[3]=J[3]-J[1]+1;4<J.length&&(J[6]=J[6]-J[4]+1,J[7]=J[7]-J[5]+1)}else if(0==l.indexOf("fof_extension"))n=
l.split("="),w=n[1].trim();else if(0==l.indexOf("probe_table"))n=l.split("="),Oc=!1,Q(n[1].trim());else if(0==l.indexOf("image_base"))n=l.split("="),fa=n[1].trim();else if(0==l.indexOf("overlay_base"))n=l.split("="),Vb=n[1].trim();else if(0==l.indexOf("high_res_basemap")){n=l.split("=");q=n[1].split(",");Uc=[];for(c=0;c<q.length;c++)Uc[c]=q[c].trim(),null!=fa&&(Uc[c]=fa+Uc[c]);wd=!0}else if(0==l.indexOf("high_res_overlay"))for(n=l.split("="),u=n[1].split("&"),e=0;e<u.length;e++){q=u[e].split(",");
Bc=parseInt(q[0].trim(),10)-1;Ja[Bc]=[];for(c=1;c<q.length;c++)Ja[Bc][c-1]=q[c].trim(),$h(Ja[Bc][c-1],"/")||(null!=Vb?Ja[Bc][c-1]=Vb+Ja[Bc][c-1]:null!=fa&&(Ja[Bc][c-1]=fa+Ja[Bc][c-1]));wd=!0}else if(0==l.indexOf("high_res_zoom")){n=l.split("=");q=n[1].split(",");na=[];for(c=0;c<q.length;c++)na[c]=parseFloat(q[c].trim());Xa()}else if(0==l.indexOf("hoverzone"))Cc(l);else if(0==l.indexOf("hotzone"))cd(l);else if(0==l.indexOf("hotspot"))z||(nb=null,mb=0,z=!0),Nb(l);else if(0==l.indexOf("toggle_onoff"))n=
l.split("="),Se=n[1].split(",");else if(0==l.indexOf("coordinates"))n=l.split("="),Ab(n[1]);else if(0==l.indexOf("map_scale"))n=l.split("="),q=n[1].split(","),Ec=parseFloat(q[0]),se=1<q.length?parseFloat(q[1]):Ec;else if(0==l.indexOf("times")){n=l.split("=");q=n[1].split(",");for(d=0;d<q.length;d++)rb[d]=parseInt(q[d].trim(),10);x=!0}else{null!=Td&&(b=l.match(Td),null!=b&&2==b.length?(rb.push(parseInt(b[1],10)),ia("+ + + Extrap time = "+b[1]),x=!0):ia("+ + + Cannot parse times using "+Td+" from line: "+
l));e=l.indexOf(" ");0>e&&(e=l.length);ua[v]=l.substring(0,e).trim();null!=fa&&(ua[v]=fa+ua[v]);l=l.substring(e+1);b=l.indexOf('"');0<=b&&(null==cb&&(cb=[]),e=l.substring(b+1),b=e.indexOf('"'),0<=b&&(cb[v]=e.substring(0,b),0==v&&(Ka.innerHTML=cb[0])));ha[v]=[];b=l.indexOf("overlay");if(0<=b)for(p=l.substring(b),b=p.indexOf("="),0>b&&ia("Cannot find a = sign in "+p),r=p.substring(b+1),p=r.trim(),r=p.split(","),ca=r.length,ia("numOverlays set to "+ca),f=0;f<r.length;f++)ha[v][f]=r[f].trim(),null!=hg&&
Ph[f]?ha[v][f]=(hg+ha[v][f]).trim():null!=Vb?ha[v][f]=(Vb+ha[v][f]).trim():null!=fa&&(ha[v][f]=(fa+ha[v][f]).trim());v+=1}x&&wa(rb);null!=w?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)2>a[d].length||(t=a[d].trim(),ia("ext_FOF: "+t),0!=t.indexOf("#")&&(0==t.indexOf("hotzone")?cd(t):0==t.indexOf("hotspot")&&Nb(t)));Wa()},a.onerror=function(){Wa()},a.open("get",w+"?"+Math.round(1E5*Math.random()),!0),a.send()):Wa()};ni=b;h.open("get",b+"?"+Math.round(1E5*
Math.random()),!0);h.send()};this.setWindowSize=function(b,a){if(null!=y){y.style.height=a+"px";y.style.width=b+"px";y.style.padding="0px";a=a-(null!=Jf?Jf.offsetHeight:0)-(null!=Kf?Kf.offsetHeight:0)-(null!=yb?yb.offsetHeight:0)-Uf*(null!=Lb?Lb.offsetHeight:0);a>ja&&(a=ja);var d=a*oa/ja;d>b&&(d=b,a=b*ja/oa);a=Math.floor(a);d=Math.floor(d);ld||(Ad(d,a),Y())}};this.drag=function(b){xb||(V=ma.getX(),N=ma.getY(),Jb?(b=r.length-1,r[b].xe=V,r[b].ye=N,r[b].xp.push(V),r[b].yp.push(N),r[b].size=Math.round(Math.sqrt(Math.pow(V-
r[b].x,2)+Math.pow(N-r[b].y,2)))):(A=V*B,F=N*C,Wc=Fb=!1,oc&&(!te||te&&b.shiftKey)?(me=A,ne=F,Wc=!0):(za&&H!=Te?(O=ra-A/x,R=sa-F/H,Cd(),ra=Math.round(O+A/x),sa=Math.round(R+F/H)):xb||fb||!lb||(qa=null,ed&&0<=A&&0<=F&&(S=Yd.getImageData(A,F,1,1).data,0!=S[3]&&(qa=Ra[S[3]-1]))),cf=!0,X())),Y())};this.resetZoom=function(){x=Me;H=Te;U=-1;null!=Aa&&(I(Aa,!0,"zoom on"),za=!1);ra=A;sa=F;R=O=0;ab=ja;bb=oa;Xa();X();od&&(lb=!0)};this.canTip=function(){var b;Fb=!1;V=ma.getX();A=V*B;N=ma.getY();F=N*C;if(!((xb||
fb)&&F<Hh&&F>Gh&&A>Fh)){ra=Math.round(O+A/x);sa=Math.round(R+F/H);if(0!=vb)for(b=0;b<vb;b++)if(Ga[b].overlay>=ca)ia(" Error...hotzone overlay # "+Ga[b].overlay+" > number of overlays = "+ca);else if(E[Ga[b].overlay].checked&&(Va.clearRect(0,0,1,1),Va.drawImage(D[q][Ga[b].overlay],ra,sa,1,1,0,0,1,1),S=Va.getImageData(0,0,1,1).data,jg=(S[0]<<16)+(S[1]<<8)+S[2],jg==Ga[b].color)){Fb=!0;Ih=V;Jh=N;Kh=Ga[b].tip;break}if(0!=mb)for(b=mb-1;0<=b;b--)if(null!=nb[b]){var a=nb[b];if(-1==a.frame||a.frame==q)if(-1==
a.overlay||E[a.overlay].checked){var d=!1;if(a.isPan)if(a.isIcon){var c=(a.x0-O)*x-a.w2;var e=(a.y0-R)*H-a.h2;A>c&&A<c+a.width&&F>e&&F<e+a.height&&(d=!0)}else c=(a.x0-O)*x,e=(a.y0-R)*H,A>c&&A<c+a.width*x&&F>e&&F<e+a.height*H&&(d=!0);else A>a.x0&&A<a.x1&&F>a.y0&&F<a.y1&&(d=!0);if(d&&null!=a.tip){Fb=!0;Ih=V;Jh=N;Kh=nb[b].tip;break}}}Y()}};this.move=function(){if(!fb&&lb&&(qa=null,ed)){var b=ma.getX()*B,a=ma.getY()*C;0<=b&&0<=a&&(S=Yd.getImageData(b,a,1,1).data,0!=S[3]&&(qa=Ra[S[3]-1]))}fb&&2<=Ua&&(V=
ma.getX(),A=V*B,N=ma.getY(),F=N*C);Y()};this.down=function(){Fb&&(Fb=!1,Y());V=ma.getX();A=V*B;N=ma.getY();F=N*C;Ze=A;$e=F;me=Ze;ne=$e;ra=Math.round(O+A/x);sa=Math.round(R+F/H);cf=!1;if(Jb){var b={};b.x=V;b.y=N;b.xe=V;b.ye=N;b.xp=[V];b.yp=[N];b.type=he.value;b.color=ge.value;b.width=Ac.value;b.text=Kb.value;b.size=0;r.push(b)}};this.up=function(b){Fb=!1;if(!Jb){if(fb||xb){V=ma.getX();A=V*B;N=ma.getY();F=N*C;if(xb){sd=1;if(0<sd&&F/C<ki){if(A/B>ji){pa.pop();pa.pop();0==pa.length&&(sd=0);Y();return}if(A/
B<ii){Y();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var a=[],d=0;d<pa.length;d+=2)ra=O+pa[d]/x,sa=R+pa[d+1]/H,Ob(),b.document.write(db[0].toFixed(4)+","+db[1].toFixed(4)+"<br>"),0==d&&(a[0]=db[0],a[1]=db[1]);De&&b.document.write(a[0].toFixed(4)+","+a[1].toFixed(4)+"<br>");return}}pa.push(A);pa.push(F);Y();return}if(3>Ua)if(Mb[Ua]=A,zb[Ua]=F,xd[Ua]=Ef[q],0==Ua)Ua=1,ya(xa(v-1)),Ue=1,hd=null;else{Qh=xd[1]-xd[0];Ye=(Mb[1]-Mb[0])/Qh;le=(zb[1]-zb[0])/Qh;if(null!=uf&&
null!=Ec){d=Ye*Ec;var c=le*se;a=Math.round(60*Math.sqrt(d*d+c*c));d=Math.atan2(d,-c)/.0174533;0>d&&(d+=360);hd=Jg+ti[Math.round(d/22.5)]+" at "+a+" "+Kg;gi=Mb[0];hi=0<le?zb[0]-15:zb[0]+30}a=parseInt(Nd,10);W=Math.round(Math.abs(4*(a+4)/Ye));yd=Math.round(Math.abs(2*(a+4)/le));yd<W&&(W=yd);120<W?W=120*Math.floor(W/120)+60:90<W?W=120:60<W?W=90:30<W?W=60:15<W?W=30:10<W?W=15:5<W?W=10:2<W?W=5:0==W&&(W=1);yd=xd[1]/W*W+W;ke=1;Ig&&(ke=-1);Eh=Ye*W;dg=le*W;ya(xa(v-1));Ua=3;Ue=2}else if(F/C<Hh&&F/C>Gh&&A/B>
Fh&&3==Ua){Dc();Y();return}Y()}if(Wc)Wc=!1,Y();else if(null!=ec&&za&&(oc=!1,I(ec,!0,"distance on")),cf)cf=!1;else if(b.altKey)L.resetZoom();else if(lb&&null!=qa&&cg)Pb(qa,"z");else{V=ma.getX();A=V*B;N=ma.getY();F=N*C;if(0!=vb)for(a=0;a<vb;a++)if(Ga[a].overlay>=ca)ia(" Error...hotzone overlay # "+Ga[a].overlay+" > number of overlays = "+ca);else if(E[Ga[a].overlay].checked&&(Va.clearRect(0,0,1,1),Va.drawImage(D[q][Ga[a].overlay],Math.floor(ra),Math.floor(sa),1,1,0,0,1,1),S=Va.getImageData(0,0,1,1).data,
jg=(S[0]<<16)+(S[1]<<8)+S[2],jg==Ga[a].color)){Pb(Ga[a],"z");return}if(0!=mb)for(a=mb-1;0<=a;a--)if(null!=nb[a]){var e=nb[a];if(!(-1!=e.frame&&e.frame!=q||e.fromfile||-1!=e.overlay&&!E[e.overlay].checked)){var f=!1;e.isPan?e.isIcon?(d=(e.x0-O)*x-e.w2,c=(e.y0-R)*H-e.h2,A>d&&A<d+e.width&&F>c&&F<c+e.height&&(f=!0)):(d=(e.x0-O)*x,c=(e.y0-R)*H,A>d&&A<d+e.width*x&&F>c&&F<c+e.height*H&&(f=!0)):A>e.x0&&A<e.x1&&F>e.y0&&F<e.y1&&(f=!0);if(f){Pb(nb[a],"s");return}}}za&&(lb=!1,Dd(b.ctrlKey||ig||b.which&&3==b.which||
b.button&&2==b.button));X();Y()}}};this.wheel=function(b){$g?Cb(b):za&&(V=ma.getX(),A=V*B,N=ma.getY(),F=N*C,ra=Math.round(O+A/x),sa=Math.round(R+F/H),Dd(-1==b))};this.toggleAutoRefresh=function(){Id?(I(Nc,!1,"autorefresh off"),null!=Fc&&clearInterval(Fc),Id=!1):(I(Nc,!0,"autorefresh on"),Fc=setInterval("HAniS.reloadFOF();",mf),Id=!0)};this.toggleLoopRock=function(){je?(I(ae,!0,"looprock rock"),je=!1):(I(ae,!1,"looprock loop"),je=!0)};this.toggleLoopHalt=function(){wb?(I(be,!0,"loophalt halt"),We=
wb=!1):(I(be,!1,"loophalt loop"),We=wb=!0)};this.toggleExtrap=function(){fb?(null!=dc&&(I(dc,!0,"extrap on"),y.style.cursor=Ea.pop(),null!=Db&&(Db.disabled=!1),G(Ta),za=ah,Ua=-1),fb=!1,Y()):(null!=dc&&(fb=!0,hd=null,Ea.push(y.style.cursor),y.style.cursor="crosshair",I(dc,!1,"extrap off"),Ta=Da,null!=Db&&(Db.disabled=!0),Da=!1,ah=za,za=!1,L.resetZoom(),Dc(),Y()),X())};this.doEnhance=function(b){if(nd||Hc){var a=Qa[0].height,d=Qa[0].width;b=parseInt(Ca.value,10);0<=b?(Xf=Ya[b],Yf=Za[b],Zf=$a[b],$f=
Ud[b],qc[pb]=b):qc[pb]=null;var c=a*d*4;for(d=0;d<bc.length;d++)if(Qa[d].gotit){Qa[d].gotit=!1;var e=Ke[d].data;var f=Gf[d];if(0>b)for(a=0;a<c;a+=4)e[a]=f[a],e[a+1]=f[a+1],e[a+2]=f[a+2],e[a+3]=f[a+3];else for(a=0;a<c;a+=4)eb=f[a],eb===f[a+1]&&eb===f[a+2]&&(e[a]=Xf[eb],e[a+1]=Yf[eb],e[a+2]=Zf[eb],e[a+3]=$f[eb]);Tc[d].putImageData(Ke[d],0,0);Qa[d].gotit=!0}}};this.overClick=function(b){var a;if(b.target.checked)for(a=0;a<E.length;a++)b.target!=E[a]&&0!=b.target.name&&b.target.name==E[a].name&&(E[a].checked=
!1);ed=!0;for(a=0;a<Ub.length;a++)b.target!=E[a]&&Ma(a),null!=rc&&!rc[a]&&E[a].checked&&(ed=!1),null!=Ca&&a===pb&&(Ca.disabled=!E[a].checked);X()};this.toggleIsLooping=function(){Da?(Da=!1,I(Db,!0,"startstop start")):(Da=!0,I(Db,!1,"startstop stop"),We=wb,wb=!1)};this.toggleZooming=function(){za?(L.resetZoom(),I(Aa,!0,"zoom on")):(I(Aa,!1,"zoom off"),za=!0,null!=ec&&(oc=!1,I(ec,!0,"distance on")),od&&(lb=!0),fb&&L.toggleExtrap())};this.togclick=function(b){var a=Ah.getX();Ah.getY();for(var d=Ch,c=
0;c<Sa.length;c++){if(a>d&&a<d+ud){if(b.shiftKey){0<=Sa[c]&&(G(!1),ya(c));break}b=0;0<=Sa[c]&&(b=-1);hb(c,b);break}d=d+ud+Re}};this.doneLoading=function(b){Je=b};this.dwellChanged=function(b){td=b};this.getDwell=function(){return Ba};this.frameChanged=function(b){Ve=b};this.getFrame=function(){return q};this.showFrame=function(b){ya(xa(b))}};
